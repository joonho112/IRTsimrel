<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Designing IRT Simulation Studies with Reliability Control • IRTsimrel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Designing IRT Simulation Studies with Reliability Control">
<meta name="description" content="A comprehensive guide to designing factorial IRT simulation studies with reliability as a controlled design factor using IRTsimrel.
">
<meta property="og:description" content="A comprehensive guide to designing factorial IRT simulation studies with reliability as a controlled design factor using IRTsimrel.
">
<meta property="og:image" content="https://joonho112.github.io/IRTsimrel/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IRTsimrel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applied Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/latent-distributions.html">Latent Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/item-parameters.html">Item Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-design.html">Simulation Design</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methodological Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-reliability.html">Reliability Theory</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-eqc.html">Algorithm 1: EQC</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-sac.html">Algorithm 2: SAC</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/IRTsimrel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Designing IRT Simulation Studies with Reliability Control</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/IRTsimrel/blob/main/vignettes/simulation-design.Rmd" class="external-link"><code>vignettes/simulation-design.Rmd</code></a></small>
      <div class="d-none name"><code>simulation-design.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>Reading time</strong>: approximately 25–30 minutes.</p>
<p>This vignette shows how to use IRTsimrel to design rigorous,
reproducible IRT simulation studies with reliability as an explicit
design factor. By the end of this vignette you will be able to:</p>
<ol style="list-style-type: decimal">
<li>Articulate why marginal reliability must be controlled in simulation
designs.</li>
<li>Set up a complete factorial design that crosses reliability with
other factors.</li>
<li>Screen all cells for feasibility before committing to
calibration.</li>
<li>Visualize reliability curves across design conditions.</li>
<li>Execute batch calibration and batch data generation across all
cells.</li>
<li>Verify that achieved reliability matches the target in every
cell.</li>
<li>Apply recommended practices for seed management, reporting, and
parallelization.</li>
</ol>
<p><strong>Prerequisites</strong>: familiarity with
<code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code> and the basics of IRT simulation. See
<code><a href="../articles/introduction.html">vignette("introduction")</a></code> for background.</p>
</div>
<div class="section level2">
<h2 id="why-reliability-should-be-a-design-factor">Why Reliability Should Be a Design Factor<a class="anchor" aria-label="anchor" href="#why-reliability-should-be-a-design-factor"></a>
</h2>
<div class="section level3">
<h3 id="the-icc-analogy">The ICC analogy<a class="anchor" aria-label="anchor" href="#the-icc-analogy"></a>
</h3>
<p>In multilevel modeling (MLM), no competent simulation study would
omit the intraclass correlation (ICC) from its factorial design. The ICC
determines the signal-to-noise ratio at the cluster level, and every
methodological conclusion is conditioned on that ratio. Studying a new
estimator only at ICC = 0.10 tells us nothing about how it performs at
ICC = 0.30.</p>
<p><strong>Marginal reliability plays exactly the same role in
IRT.</strong> It captures the proportion of latent variance that is
“signal” versus “noise,” and it governs the precision of every
person-parameter estimate. Yet in the vast majority of published IRT
simulation studies, reliability is neither controlled nor even
reported.</p>
<p>The analogy is precise:</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th align="left">MLM simulation</th>
<th align="left">IRT simulation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ICC is a primary design factor</td>
<td align="left">Reliability should be a design factor</td>
</tr>
<tr class="even">
<td align="left">ICC controls cluster-level signal</td>
<td align="left">Reliability controls person-level signal</td>
</tr>
<tr class="odd">
<td align="left">Conclusions depend on ICC level</td>
<td align="left">Conclusions depend on reliability level</td>
</tr>
<tr class="even">
<td align="left">Always reported in Methods section</td>
<td align="left">Rarely reported in Methods section</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="what-happens-without-reliability-control">What happens without reliability control<a class="anchor" aria-label="anchor" href="#what-happens-without-reliability-control"></a>
</h3>
<p>When reliability is not controlled, several problems arise:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Confounded comparisons</strong>: two models may appear to
differ not because of their structural properties but because they
operate at different reliability levels. The “winning” model may simply
have been handed better data.</p></li>
<li><p><strong>Limited generalizability</strong>: results obtained at an
unknown reliability (implicitly determined by item parameter choices) do
not generalize to other reliability regimes.</p></li>
<li><p><strong>Irreproducibility</strong>: without knowing the implied
reliability, another researcher cannot replicate the exact simulation
conditions.</p></li>
<li><p><strong>Ecological invalidity</strong>: real-world assessments
span a wide range of reliabilities (0.50 to 0.95). A simulation that
only explores one unknown reliability point misses most of this
range.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="a-cautionary-tale">A cautionary tale<a class="anchor" aria-label="anchor" href="#a-cautionary-tale"></a>
</h3>
<p>Consider a researcher who wants to compare the Rasch model and the
2PL model in terms of item-difficulty recovery. A naive design might fix
20 items, normal abilities, and 500 persons, then generate one Rasch
data set and one 2PL data set. The researcher finds that RMSE is
substantially larger under the 2PL model and concludes the Rasch model
recovers difficulty better.</p>
<p>The problem: the two data sets may have very different reliabilities.
If the 2PL data happen to have lower reliability (because of how
discriminations were drawn), then higher RMSE is an artifact of the
noisier data, not a property of the generating model. The conclusion is
confounded.</p>
<p>With IRTsimrel, the researcher can <strong>hold reliability
constant</strong> across both models. Any remaining difference in RMSE
is then attributable to model structure, not data quality.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calibrate Rasch and 2PL to the SAME reliability</span></span>
<span><span class="va">eqc_rasch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">20</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">eqc_2pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">20</span>, model <span class="op">=</span> <span class="st">"2pl"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Rasch achieved rho: %.4f  (c* = %.4f)\n"</span>,</span>
<span>            <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">achieved_rho</span>, <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rasch achieved rho: 0.8000  (c* = 1.0183)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"2PL   achieved rho: %.4f  (c* = %.4f)\n"</span>,</span>
<span>            <span class="va">eqc_2pl</span><span class="op">$</span><span class="va">achieved_rho</span>, <span class="va">eqc_2pl</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2PL   achieved rho: 0.8000  (c* = 0.9026)</span></span></code></pre></div>
<p>Both conditions now operate at the same marginal reliability. Any
downstream difference in RMSE reflects the structural difference between
Rasch and 2PL, not an accidental reliability imbalance.</p>
</div>
<div class="section level3">
<h3 id="reliability-as-an-experimental-control">Reliability as an experimental control<a class="anchor" aria-label="anchor" href="#reliability-as-an-experimental-control"></a>
</h3>
<p>Controlling reliability in IRT simulation is analogous to controlling
temperature in a chemistry experiment. You would never compare two
reactions at different temperatures and attribute the difference solely
to the reagents. Similarly, comparing two IRT models at different
reliabilities conflates model structure with data quality.</p>
<p>IRTsimrel enables this control by solving the <strong>inverse design
problem</strong>: given a target reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ρ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>,
find the global discrimination scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
such that the population reliability equals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ρ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>.
This is achieved through the <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code> function,
which uses deterministic root-finding (Brent’s method) on the monotone
reliability curve.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-factorial-design-framework">The Factorial Design Framework<a class="anchor" aria-label="anchor" href="#the-factorial-design-framework"></a>
</h2>
<p>A well-designed simulation study crosses multiple factors to map out
the operating characteristics of the method under study. A natural
four-factor design for IRT research is:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="34%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th align="left">Factor</th>
<th align="left">Levels</th>
<th align="left">Rationale</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Reliability</td>
<td align="left">0.60, 0.70, 0.80</td>
<td align="left">Low, moderate, high data quality</td>
</tr>
<tr class="even">
<td align="left">Test length</td>
<td align="left">15, 30</td>
<td align="left">Short vs. long forms</td>
</tr>
<tr class="odd">
<td align="left">Latent shape</td>
<td align="left">normal, skew_pos</td>
<td align="left">Standard vs. violated normality</td>
</tr>
<tr class="even">
<td align="left">Model</td>
<td align="left">rasch, 2pl</td>
<td align="left">Equal vs. varying discriminations</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="building-the-design-matrix">Building the design matrix<a class="anchor" aria-label="anchor" href="#building-the-design-matrix"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  reliability  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">0.70</span>, <span class="fl">0.80</span><span class="op">)</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"skew_pos"</span><span class="op">)</span>,</span>
<span>  model        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rasch"</span>, <span class="st">"2pl"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Total cells: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total cells: 24</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">design</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt;   reliability n_items latent_shape model</span></span>
<span><span class="co">#&gt; 1         0.6      15       normal rasch</span></span>
<span><span class="co">#&gt; 2         0.7      15       normal rasch</span></span>
<span><span class="co">#&gt; 3         0.8      15       normal rasch</span></span>
<span><span class="co">#&gt; 4         0.6      30       normal rasch</span></span>
<span><span class="co">#&gt; 5         0.7      30       normal rasch</span></span>
<span><span class="co">#&gt; 6         0.8      30       normal rasch</span></span>
<span><span class="co">#&gt; 7         0.6      15     skew_pos rasch</span></span>
<span><span class="co">#&gt; 8         0.7      15     skew_pos rasch</span></span></code></pre></div>
<p>We have 24 design cells. Before calibrating any of them, we should
verify that every cell is <em>feasible</em>—that the target reliability
can actually be achieved with the given item and latent
configuration.</p>
</div>
<div class="section level3">
<h3 id="choosing-factor-levels">Choosing factor levels<a class="anchor" aria-label="anchor" href="#choosing-factor-levels"></a>
</h3>
<p>When selecting factor levels, consider these guidelines:</p>
<ul>
<li><p><strong>Reliability</strong>: include at least three levels
spanning the range relevant to your research context. Educational
testing typically ranges from 0.60 (formative assessments) to 0.90
(high-stakes tests).</p></li>
<li><p><strong>Test length</strong>: include at least two lengths that
bracket the typical range for your application domain. Short forms
(10–15 items) and standard forms (25–40 items) are common.</p></li>
<li><p><strong>Latent distributions</strong>: always include
<code>"normal"</code> as a baseline. Add one or two non-normal shapes to
test robustness. Good choices include <code>"skew_pos"</code> (selective
admissions) and <code>"bimodal"</code> (heterogeneous
populations).</p></li>
<li><p><strong>Model</strong>: include both <code>"rasch"</code> and
<code>"2pl"</code> if your study involves model comparison or robustness
analysis.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="feasibility-screening">Feasibility Screening<a class="anchor" aria-label="anchor" href="#feasibility-screening"></a>
</h2>
<p>The <code><a href="../reference/check_feasibility.html">check_feasibility()</a></code> function computes the achievable
reliability range for a given test design. We loop over every cell and
record whether the target reliability falls within the range for the
“info” metric (the default and recommended metric for EQC).</p>
<p>Feasibility screening should always precede calibration. It is fast
(a fraction of a second per cell) and prevents wasted effort on
infeasible conditions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Screen all cells</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">rho_max</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">rho_min</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">feas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_feasibility.html">check_feasibility</a></span><span class="op">(</span></span>
<span>    n_items      <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">n_items</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">model</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">latent_shape</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    c_bounds     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>    verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">design</span><span class="op">$</span><span class="va">rho_min</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">design</span><span class="op">$</span><span class="va">rho_max</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">design</span><span class="op">$</span><span class="va">feasible</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">$</span><span class="va">reliability</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span></span>
<span>                         <span class="va">design</span><span class="op">$</span><span class="va">reliability</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Display summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Feasible cells  : %d / %d\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Feasible cells  : 24 / 24</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Infeasible cells: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Infeasible cells: 0</span></span>
<span></span>
<span><span class="co"># Show the infeasible cells if any</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="op">!</span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nInfeasible cells:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">[</span><span class="op">!</span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a compact summary by n_items x model</span></span>
<span><span class="va">feas_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rho_min</span>, <span class="va">rho_max</span><span class="op">)</span> <span class="op">~</span> <span class="va">n_items</span> <span class="op">+</span> <span class="va">model</span>,</span>
<span>  data <span class="op">=</span> <span class="va">design</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">feas_summary</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg_rho_min"</span>, <span class="st">"avg_rho_max"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">feas_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;   n_items model avg_rho_min avg_rho_max</span></span>
<span><span class="co">#&gt; 1      15   2pl       0.042       0.978</span></span>
<span><span class="co">#&gt; 2      30   2pl       0.082       0.990</span></span>
<span><span class="co">#&gt; 3      15 rasch       0.036       0.977</span></span>
<span><span class="co">#&gt; 4      30 rasch       0.070       0.989</span></span></code></pre></div>
<div class="section level3">
<h3 id="interpreting-feasibility-results">Interpreting feasibility results<a class="anchor" aria-label="anchor" href="#interpreting-feasibility-results"></a>
</h3>
<p>The output shows the range
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>ρ</mi><mo>min</mo></msub><mo>,</mo><msub><mi>ρ</mi><mo>max</mo></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\rho_{\min}, \rho_{\max}]</annotation></semantics></math>
achievable for each cell. Key patterns to look for:</p>
<ul>
<li><p><strong>Short tests</strong> (e.g., 15 items) have a
<strong>lower</strong> maximum achievable reliability than long tests,
because fewer items provide less total information.</p></li>
<li><p><strong>Rasch vs. 2PL</strong>: The 2PL model may have a slightly
different achievable range because varying discriminations change the
effective information.</p></li>
<li><p><strong>Non-normal latent distributions</strong>: skewed or
heavy-tailed distributions may shift the achievable range because test
information depends on the ability distribution.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="when-cells-are-infeasible">When cells are infeasible<a class="anchor" aria-label="anchor" href="#when-cells-are-infeasible"></a>
</h3>
<p>If any cell is infeasible, you have several options:</p>
<ul>
<li>Increase <code>c_bounds[2]</code> (allow stronger discrimination
scaling).</li>
<li>Increase <code>n_items</code> for that cell.</li>
<li>Drop the reliability level from the design.</li>
<li>Accept the achievable maximum and note the deviation.</li>
</ul>
<p>For the remaining sections we proceed with all
<strong>feasible</strong> cells only.</p>
</div>
</div>
<div class="section level2">
<h2 id="reliability-curves-across-conditions">Reliability Curves Across Conditions<a class="anchor" aria-label="anchor" href="#reliability-curves-across-conditions"></a>
</h2>
<p>Reliability curves show how
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho(c)</annotation></semantics></math>
varies with the scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.
They help you understand the shape and range of achievable reliability
for each design condition.</p>
<p>The <code><a href="../reference/rho_curve.html">rho_curve()</a></code> function computes reliability at a grid
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
values using Monte Carlo integration with the same quadrature approach
used by <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code>. This visualization serves three
purposes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Confirms monotonicity</strong>: the info metric
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde{\rho}(c)</annotation></semantics></math>
should be strictly increasing in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.</li>
<li>
<strong>Shows the achievable range</strong>: the vertical extent of
the curve.</li>
<li>
<strong>Identifies where calibration occurs</strong>: the horizontal
position where the curve crosses the target reliability.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select four representative conditions</span></span>
<span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_items <span class="op">=</span> <span class="fl">15</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,  latent_shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>       label <span class="op">=</span> <span class="st">"15 items, Rasch, Normal"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_items <span class="op">=</span> <span class="fl">30</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,  latent_shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>       label <span class="op">=</span> <span class="st">"30 items, Rasch, Normal"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_items <span class="op">=</span> <span class="fl">15</span>, model <span class="op">=</span> <span class="st">"2pl"</span>,    latent_shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>       label <span class="op">=</span> <span class="st">"15 items, 2PL, Normal"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_items <span class="op">=</span> <span class="fl">30</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,  latent_shape <span class="op">=</span> <span class="st">"skew_pos"</span>,</span>
<span>       label <span class="op">=</span> <span class="st">"30 items, Rasch, Skew+"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">c_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span></span>
<span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cond</span> <span class="kw">in</span> <span class="va">conditions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">curve_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rho_curve.html">rho_curve</a></span><span class="op">(</span></span>
<span>    c_values     <span class="op">=</span> <span class="va">c_grid</span>,</span>
<span>    n_items      <span class="op">=</span> <span class="va">cond</span><span class="op">$</span><span class="va">n_items</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">cond</span><span class="op">$</span><span class="va">model</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">cond</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    metric       <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>    plot         <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">curve_data</span><span class="op">$</span><span class="va">c</span>, <span class="va">curve_data</span><span class="op">$</span><span class="va">rho_tilde</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"steelblue"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="st">"Scaling factor c"</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">tilde</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       main <span class="op">=</span> <span class="va">cond</span><span class="op">$</span><span class="va">label</span>, cex.main <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.70</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.80</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-design_files/figure-html/rho-curves-1.png" class="r-plt" alt="Reliability curves for four design conditions. Dashed red lines mark target reliabilities of 0.70 and 0.80. Differences in curve shape reflect how test length and latent distribution affect the reliability-discrimination relationship." width="85%"><p class="caption">
Reliability curves for four design conditions. Dashed red lines mark
target reliabilities of 0.70 and 0.80. Differences in curve shape
reflect how test length and latent distribution affect the
reliability-discrimination relationship.
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
<p>Key observations from the reliability curves:</p>
<ul>
<li><p><strong>Longer tests</strong> reach the same reliability with a
smaller scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>.
For example, 30 items might achieve
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>=</mo><mn>0.80</mn></mrow><annotation encoding="application/x-tex">\tilde{\rho} = 0.80</annotation></semantics></math>
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>≈</mo><mn>1.2</mn></mrow><annotation encoding="application/x-tex">c \approx 1.2</annotation></semantics></math>,
whereas 15 items might require
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>≈</mo><mn>2.0</mn></mrow><annotation encoding="application/x-tex">c \approx 2.0</annotation></semantics></math>.</p></li>
<li><p>The <strong>2PL model</strong> reaches high reliability faster
because varying discriminations contribute additional information per
item on average.</p></li>
<li><p><strong>Skewed latent distributions</strong> shift the curve
slightly, because test information concentrates where items are most
informative. If the latent distribution places more mass in regions of
lower information, the reliability curve is lower.</p></li>
<li><p>All curves are <strong>monotonically increasing</strong> in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
confirming that the info metric is well-suited for root-finding via
<code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot()</a></code>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="batch-calibration">Batch Calibration<a class="anchor" aria-label="anchor" href="#batch-calibration"></a>
</h2>
<p>With the design validated, we calibrate every feasible cell. The code
below stores results in a list indexed by cell number.</p>
<p>The key principle: <strong>calibrate once, generate many
times.</strong> The calibrated parameters (item difficulties, scaled
discriminations, and the quadrature sample) are fixed for a given cell.
Multiple replications vary only the person sample.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep only feasible cells</span></span>
<span><span class="va">design_feasible</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">[</span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Storage</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">design_feasible</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho   <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">reliability</span>,</span>
<span>    n_items      <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">n_items</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">model</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>    verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">results_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">res</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Attach achieved reliability to the design frame</span></span>
<span><span class="va">design_feasible</span><span class="op">$</span><span class="va">achieved_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">achieved_rho</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">design_feasible</span><span class="op">$</span><span class="va">c_star</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span></span>
<span>  <span class="va">results_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">c_star</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">design_feasible</span><span class="op">$</span><span class="va">abs_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span></span>
<span>  <span class="va">design_feasible</span><span class="op">$</span><span class="va">achieved_rho</span> <span class="op">-</span> <span class="va">design_feasible</span><span class="op">$</span><span class="va">reliability</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Mean absolute error: %.6f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">abs_error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean absolute error: 0.000002</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Max  absolute error: %.6f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">abs_error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max  absolute error: 0.000012</span></span></code></pre></div>
<p>The calibration errors are typically on the order of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup><annotation encoding="application/x-tex">10^{-5}</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup><annotation encoding="application/x-tex">10^{-4}</annotation></semantics></math>,
confirming that EQC achieves the target with excellent precision.</p>
<div class="section level3">
<h3 id="examining-the-calibrated-scaling-factors">Examining the calibrated scaling factors<a class="anchor" aria-label="anchor" href="#examining-the-calibrated-scaling-factors"></a>
</h3>
<p>The calibrated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
values reveal how much discrimination scaling is needed to reach each
target reliability:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show c* by condition</span></span>
<span><span class="va">cstar_table</span> <span class="op">&lt;-</span> <span class="va">design_feasible</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"n_items"</span>, <span class="st">"latent_shape"</span>,</span>
<span>                                    <span class="st">"reliability"</span>, <span class="st">"c_star"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">cstar_table</span><span class="op">$</span><span class="va">c_star</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cstar_table</span><span class="op">$</span><span class="va">c_star</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cstar_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;    model n_items latent_shape reliability c_star</span></span>
<span><span class="co">#&gt; 1  rasch      15       normal         0.6 0.6789</span></span>
<span><span class="co">#&gt; 2  rasch      15       normal         0.7 0.8793</span></span>
<span><span class="co">#&gt; 3  rasch      15       normal         0.8 1.2343</span></span>
<span><span class="co">#&gt; 4  rasch      30       normal         0.6 0.4632</span></span>
<span><span class="co">#&gt; 5  rasch      30       normal         0.7 0.5900</span></span>
<span><span class="co">#&gt; 6  rasch      30       normal         0.8 0.8042</span></span>
<span><span class="co">#&gt; 7  rasch      15     skew_pos         0.6 0.7078</span></span>
<span><span class="co">#&gt; 8  rasch      15     skew_pos         0.7 0.9342</span></span>
<span><span class="co">#&gt; 9  rasch      15     skew_pos         0.8 1.3542</span></span>
<span><span class="co">#&gt; 10 rasch      30     skew_pos         0.6 0.4654</span></span>
<span><span class="co">#&gt; 11 rasch      30     skew_pos         0.7 0.5933</span></span>
<span><span class="co">#&gt; 12 rasch      30     skew_pos         0.8 0.8090</span></span>
<span><span class="co">#&gt; 13   2pl      15       normal         0.6 0.5791</span></span>
<span><span class="co">#&gt; 14   2pl      15       normal         0.7 0.7555</span></span>
<span><span class="co">#&gt; 15   2pl      15       normal         0.8 1.0716</span></span>
<span><span class="co">#&gt; 16   2pl      30       normal         0.6 0.4237</span></span>
<span><span class="co">#&gt; 17   2pl      30       normal         0.7 0.5417</span></span>
<span><span class="co">#&gt; 18   2pl      30       normal         0.8 0.7425</span></span>
<span><span class="co">#&gt; 19   2pl      15     skew_pos         0.6 0.7357</span></span>
<span><span class="co">#&gt; 20   2pl      15     skew_pos         0.7 0.9678</span></span>
<span><span class="co">#&gt; 21   2pl      15     skew_pos         0.8 1.3950</span></span>
<span><span class="co">#&gt; 22   2pl      30     skew_pos         0.6 0.4347</span></span>
<span><span class="co">#&gt; 23   2pl      30     skew_pos         0.7 0.5550</span></span>
<span><span class="co">#&gt; 24   2pl      30     skew_pos         0.8 0.7580</span></span></code></pre></div>
<p>Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mo>*</mo></msup><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c^* &gt; 1</annotation></semantics></math>
means the baseline discriminations were scaled up (items made more
discriminating), while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mo>*</mo></msup><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">c^* &lt; 1</annotation></semantics></math>
means they were scaled down. Higher target reliability generally
requires a larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>,
and longer tests require a smaller
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
for the same target.</p>
</div>
</div>
<div class="section level2">
<h2 id="batch-data-generation">Batch Data Generation<a class="anchor" aria-label="anchor" href="#batch-data-generation"></a>
</h2>
<p>After calibration, we generate response data for each cell. In a real
study you would embed this in a replication loop; here we generate a
single data set per cell for illustration.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">design_feasible</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">sim_data_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>    result       <span class="op">=</span> <span class="va">results_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    n_persons    <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">100</span> <span class="op">+</span> <span class="va">i</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Quick check: dimensions of first and last</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Cell 1  : %d persons x %d items\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim_data_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell 1  : 300 persons x 15 items</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Cell %d : %d persons x %d items\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim_data_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cell 24 : 300 persons x 30 items</span></span></code></pre></div>
<div class="section level3">
<h3 id="replication-loop-pattern">Replication loop pattern<a class="anchor" aria-label="anchor" href="#replication-loop-pattern"></a>
</h3>
<p>In a real simulation study, the data generation step is embedded in a
replication loop. The following pattern demonstrates the structure:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">500</span>  <span class="co"># Number of replications</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">design_feasible</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>      result       <span class="op">=</span> <span class="va">results_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      n_persons    <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>      latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>      seed         <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">i</span> <span class="op">+</span> <span class="va">r</span>  <span class="co"># Unique seed per cell x replication</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># --- Your analysis code here ---</span></span>
<span>    <span class="co"># For example:</span></span>
<span>    <span class="co"># p_items &lt;- colMeans(sim$response_matrix)</span></span>
<span>    <span class="co"># beta_hat &lt;- -log(pmax(p_items, 0.001) / pmax(1 - p_items, 0.001))</span></span>
<span>    <span class="co"># beta_hat &lt;- beta_hat - mean(beta_hat)</span></span>
<span>    <span class="co"># rmse &lt;- sqrt(mean((beta_hat - sim$beta)^2))</span></span>
<span>    <span class="co"># Store rmse in output data frame</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="verification">Verification<a class="anchor" aria-label="anchor" href="#verification"></a>
</h2>
<p>The critical step: verify that the finite-sample data actually
exhibit reliability close to the target. Without external TAM validation
(which requires the TAM package), we use the population-level achieved
reliability from the calibration object. The achieved reliability from
EQC is the population value conditioned on the quadrature sample.</p>
<div class="section level3">
<h3 id="verification-table">Verification table<a class="anchor" aria-label="anchor" href="#verification-table"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build verification table</span></span>
<span><span class="va">verify_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  cell         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  model        <span class="op">=</span> <span class="va">design_feasible</span><span class="op">$</span><span class="va">model</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="va">design_feasible</span><span class="op">$</span><span class="va">n_items</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="va">design_feasible</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="va">design_feasible</span><span class="op">$</span><span class="va">reliability</span>,</span>
<span>  achieved_rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">achieved_rho</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  c_star       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">c_star</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  abs_error    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">abs_error</span>, scientific <span class="op">=</span> <span class="cn">TRUE</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">verify_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;    cell model n_items latent_shape target_rho achieved_rho c_star abs_error</span></span>
<span><span class="co">#&gt; 1     1 rasch      15       normal        0.6     0.600000 0.6789   1.5e-07</span></span>
<span><span class="co">#&gt; 2     2 rasch      15       normal        0.7     0.700000 0.8793   1.4e-07</span></span>
<span><span class="co">#&gt; 3     3 rasch      15       normal        0.8     0.800001 1.2343   1.4e-06</span></span>
<span><span class="co">#&gt; 4     4 rasch      30       normal        0.6     0.600012 0.4632   1.2e-05</span></span>
<span><span class="co">#&gt; 5     5 rasch      30       normal        0.7     0.700000 0.5900   2.7e-08</span></span>
<span><span class="co">#&gt; 6     6 rasch      30       normal        0.8     0.800000 0.8042   1.4e-07</span></span>
<span><span class="co">#&gt; 7     7 rasch      15     skew_pos        0.6     0.599999 0.7078   7.4e-07</span></span>
<span><span class="co">#&gt; 8     8 rasch      15     skew_pos        0.7     0.700000 0.9342   2.8e-07</span></span>
<span><span class="co">#&gt; 9     9 rasch      15     skew_pos        0.8     0.800000 1.3542   1.2e-09</span></span>
<span><span class="co">#&gt; 10   10 rasch      30     skew_pos        0.6     0.600012 0.4654   1.2e-05</span></span>
<span><span class="co">#&gt; 11   11 rasch      30     skew_pos        0.7     0.700000 0.5933   1.9e-08</span></span>
<span><span class="co">#&gt; 12   12 rasch      30     skew_pos        0.8     0.800000 0.8090   2.5e-07</span></span>
<span><span class="co">#&gt; 13   13   2pl      15       normal        0.6     0.600004 0.5791   4.2e-06</span></span>
<span><span class="co">#&gt; 14   14   2pl      15       normal        0.7     0.699999 0.7555   5.2e-07</span></span>
<span><span class="co">#&gt; 15   15   2pl      15       normal        0.8     0.800000 1.0716   4.1e-07</span></span>
<span><span class="co">#&gt; 16   16   2pl      30       normal        0.6     0.600002 0.4237   1.6e-06</span></span>
<span><span class="co">#&gt; 17   17   2pl      30       normal        0.7     0.699999 0.5417   1.0e-06</span></span>
<span><span class="co">#&gt; 18   18   2pl      30       normal        0.8     0.800002 0.7425   1.6e-06</span></span>
<span><span class="co">#&gt; 19   19   2pl      15     skew_pos        0.6     0.599998 0.7357   2.1e-06</span></span>
<span><span class="co">#&gt; 20   20   2pl      15     skew_pos        0.7     0.700000 0.9678   1.6e-07</span></span>
<span><span class="co">#&gt; 21   21   2pl      15     skew_pos        0.8     0.800002 1.3950   1.7e-06</span></span>
<span><span class="co">#&gt; 22   22   2pl      30     skew_pos        0.6     0.600003 0.4347   2.6e-06</span></span>
<span><span class="co">#&gt; 23   23   2pl      30     skew_pos        0.7     0.700000 0.5550   1.0e-07</span></span>
<span><span class="co">#&gt; 24   24   2pl      30     skew_pos        0.8     0.800000 0.7580   1.3e-07</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="verification-plot">Verification plot<a class="anchor" aria-label="anchor" href="#verification-plot"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Color by model</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">model</span> <span class="op">==</span> <span class="st">"rasch"</span>, <span class="st">"steelblue"</span>, <span class="st">"coral"</span><span class="op">)</span></span>
<span><span class="va">pchs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">n_items</span> <span class="op">==</span> <span class="fl">15</span>, <span class="fl">19</span>, <span class="fl">17</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">reliability</span>, <span class="va">design_feasible</span><span class="op">$</span><span class="va">achieved_rho</span>,</span>
<span>     pch <span class="op">=</span> <span class="va">pchs</span>, col <span class="op">=</span> <span class="va">cols</span>, cex <span class="op">=</span> <span class="fl">1.3</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Target Reliability"</span>, ylab <span class="op">=</span> <span class="st">"Achieved Reliability"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Calibration Verification: Target vs. Achieved"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.55</span>, <span class="fl">0.85</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.55</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate with max error</span></span>
<span><span class="va">max_err</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">$</span><span class="va">abs_error</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Max |error| = %.2e"</span>, <span class="va">max_err</span><span class="op">)</span>,</span>
<span>                  <span class="st">"Rasch"</span>, <span class="st">"2PL"</span>, <span class="st">"15 items"</span>, <span class="st">"30 items"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"steelblue"</span>, <span class="st">"coral"</span>, <span class="st">"black"</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">19</span>, <span class="fl">17</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="simulation-design_files/figure-html/verification-plot-1.png" class="r-plt" alt="Verification plot: achieved versus target reliability across all feasible cells. Points near the diagonal indicate precise calibration." width="85%"><p class="caption">
Verification plot: achieved versus target reliability across all
feasible cells. Points near the diagonal indicate precise calibration.
</p>
</div>
<p>All points lie essentially on the diagonal, confirming that the
calibration is precise to within the Monte Carlo tolerance of the
quadrature sample.</p>
</div>
<div class="section level3">
<h3 id="external-validation-with-tam">External validation with TAM<a class="anchor" aria-label="anchor" href="#external-validation-with-tam"></a>
</h3>
<p>For rigorous validation, you can additionally compute reliability
using the TAM package. This requires TAM to be installed:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># External validation (requires TAM package)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.edmeasurementsurveys.com/TAM/Tutorials/" class="external-link">TAM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tam_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_reliability_tam.html">compute_reliability_tam</a></span><span class="op">(</span></span>
<span>    resp  <span class="op">=</span> <span class="va">sim_data_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">response_matrix</span>,</span>
<span>    model <span class="op">=</span> <span class="va">design_feasible</span><span class="op">$</span><span class="va">model</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Cell %2d: target = %.3f, WLE = %.3f, EAP = %.3f\n"</span>,</span>
<span>              <span class="va">i</span>, <span class="va">design_feasible</span><span class="op">$</span><span class="va">reliability</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>              <span class="va">tam_rel</span><span class="op">$</span><span class="va">rel_wle</span>, <span class="va">tam_rel</span><span class="op">$</span><span class="va">rel_eap</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>See <code><a href="../articles/validation.html">vignette("validation")</a></code> for guidance on interpreting
WLE vs. EAP reliability from TAM.</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-considerations">Practical Considerations<a class="anchor" aria-label="anchor" href="#practical-considerations"></a>
</h2>
<div class="section level3">
<h3 id="seed-management-for-reproducibility">Seed management for reproducibility<a class="anchor" aria-label="anchor" href="#seed-management-for-reproducibility"></a>
</h3>
<p>A reproducible simulation study requires two levels of seed
management:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Calibration seed</strong>: controls the quadrature sample
and item parameters. Use a fixed seed (e.g., <code>seed = 42</code>)
that is the same across all cells. This does <em>not</em> mean the cells
get the same items; the seed interacts with cell-specific parameters
(model, latent shape, etc.).</p></li>
<li><p><strong>Replication seeds</strong>: for each replication
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">r = 1, \ldots, R</annotation></semantics></math>,
pass <code>seed = r</code> (or another deterministic mapping) to
<code><a href="../reference/simulate_response_data.html">simulate_response_data()</a></code>. This ensures that each
replication is independently reproducible.</p></li>
</ol>
<p>The recommended pattern encodes both cell index and replication index
in the seed:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Recommended seed pattern</span></span>
<span><span class="va">CALIB_SEED</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cell</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_cells</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span><span class="va">...</span>, seed <span class="op">=</span> <span class="va">CALIB_SEED</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span><span class="va">res</span>, n_persons <span class="op">=</span> <span class="va">N</span>,</span>
<span>                                   seed <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">cell</span> <span class="op">+</span> <span class="va">r</span><span class="op">)</span></span>
<span>    <span class="co"># ... analysis ...</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Important: IRTsimrel saves and restores the <code>.Random.seed</code>
state inside <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code> and
<code><a href="../reference/simulate_response_data.html">simulate_response_data()</a></code> when a seed is specified. This
means that setting a seed inside these functions does not affect the
global RNG state.</p>
</div>
<div class="section level3">
<h3 id="result-organization">Result organization<a class="anchor" aria-label="anchor" href="#result-organization"></a>
</h3>
<p>Store simulation output in structured data frames. Pre-allocating the
data frame is more efficient than growing it with <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>
inside the loop, but for clarity we show both patterns:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pre-allocate storage (efficient)</span></span>
<span><span class="va">n_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span> <span class="op">*</span> <span class="va">R</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  cell         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  rep          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  model        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  rmse_beta    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  bias_beta    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_total</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="computational-scaling">Computational scaling<a class="anchor" aria-label="anchor" href="#computational-scaling"></a>
</h3>
<p>Calibration cost is dominated by the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>×</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">M \times I</annotation></semantics></math>
matrix computation inside <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code>. As a rough
guide:</p>
<table class="table">
<thead><tr class="header">
<th align="left">M</th>
<th align="left">n_items</th>
<th align="left">Approx. time per cell</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">5,000</td>
<td align="left">20</td>
<td align="left">&lt; 0.5 s</td>
</tr>
<tr class="even">
<td align="left">10,000</td>
<td align="left">30</td>
<td align="left">~1 s</td>
</tr>
<tr class="odd">
<td align="left">50,000</td>
<td align="left">50</td>
<td align="left">~5 s</td>
</tr>
</tbody>
</table>
<p>Data generation via <code><a href="../reference/simulate_response_data.html">simulate_response_data()</a></code> is fast
(&lt; 0.1 s for N = 1,000, I = 30).</p>
<p>For a typical study with 24 cells,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M = 10{,}000</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">R = 500</annotation></semantics></math>
replications of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">N = 1{,}000</annotation></semantics></math>:</p>
<ul>
<li>Calibration: ~24 seconds total (one-time cost).</li>
<li>Data generation: ~24 x 500 x 0.05 = ~600 seconds (~10 minutes).</li>
<li>Analysis time depends on your estimator.</li>
</ul>
</div>
<div class="section level3">
<h3 id="parallelization">Parallelization<a class="anchor" aria-label="anchor" href="#parallelization"></a>
</h3>
<p>For large designs, cells can be calibrated in parallel because they
are independent. The following pattern uses the
<code>future.apply</code> package:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org" class="external-link">future.apply</a></span><span class="op">)</span></span>
<span><span class="fu">plan</span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu">future_lapply</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design_feasible</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">design_feasible</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho   <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">reliability</span>,</span>
<span>    n_items      <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">n_items</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">model</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M            <span class="op">=</span> <span class="fl">10000L</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">42</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span>, future.seed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Replication loops can also be parallelized. Ensure that each parallel
worker uses a unique seed:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parallelize replications within a cell</span></span>
<span><span class="va">rep_results</span> <span class="op">&lt;-</span> <span class="fu">future_lapply</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>    result    <span class="op">=</span> <span class="va">calib_result</span>,</span>
<span>    n_persons <span class="op">=</span> <span class="va">N</span>,</span>
<span>    seed      <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">cell_idx</span> <span class="op">+</span> <span class="va">r</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># ... analysis ...</span></span>
<span>  <span class="co"># return(list(rmse = rmse, bias = bias))</span></span>
<span><span class="op">}</span>, future.seed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reporting-standards">Reporting Standards<a class="anchor" aria-label="anchor" href="#reporting-standards"></a>
</h2>
<div class="section level3">
<h3 id="what-to-report-in-a-simulation-methods-section">What to report in a simulation Methods section<a class="anchor" aria-label="anchor" href="#what-to-report-in-a-simulation-methods-section"></a>
</h3>
<p>A simulation study using IRTsimrel should report, at minimum:</p>
<table class="table">
<colgroup>
<col width="39%">
<col width="60%">
</colgroup>
<thead><tr class="header">
<th align="left">Element</th>
<th align="left">Example value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Package and version</td>
<td align="left">IRTsimrel v0.2.0</td>
</tr>
<tr class="even">
<td align="left">Calibration algorithm</td>
<td align="left">EQC</td>
</tr>
<tr class="odd">
<td align="left">Reliability metric</td>
<td align="left">Average-information
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><annotation encoding="application/x-tex">\tilde{\rho}</annotation></semantics></math>)</td>
</tr>
<tr class="even">
<td align="left">Target reliabilities</td>
<td align="left">0.60, 0.70, 0.80</td>
</tr>
<tr class="odd">
<td align="left">Test lengths</td>
<td align="left">15, 30 items</td>
</tr>
<tr class="even">
<td align="left">IRT model</td>
<td align="left">Rasch, 2PL</td>
</tr>
<tr class="odd">
<td align="left">Latent distribution</td>
<td align="left">Normal, positively skewed</td>
</tr>
<tr class="even">
<td align="left">Item source</td>
<td align="left">Parametric (Normal difficulties)</td>
</tr>
<tr class="odd">
<td align="left">Quadrature size (M)</td>
<td align="left">10,000</td>
</tr>
<tr class="even">
<td align="left">Replications per cell</td>
<td align="left">500</td>
</tr>
<tr class="odd">
<td align="left">Persons per replication</td>
<td align="left">1,000</td>
</tr>
<tr class="even">
<td align="left">Seed management</td>
<td align="left">Calibration seed = 42; replication seeds 1:500</td>
</tr>
<tr class="odd">
<td align="left">Feasibility screening</td>
<td align="left">All cells screened; N infeasible = 0</td>
</tr>
<tr class="even">
<td align="left">Verification</td>
<td align="left">Max</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="reporting-checklist">Reporting checklist<a class="anchor" aria-label="anchor" href="#reporting-checklist"></a>
</h3>
<ol style="list-style-type: decimal">
<li>State the target reliability levels and the metric used (info
vs. msem).</li>
<li>Report the calibration algorithm and its key parameters (M,
c_bounds, tol).</li>
<li>Document feasibility screening results.</li>
<li>Report the maximum absolute calibration error across all cells.</li>
<li>Describe the item parameter source and generation method.</li>
<li>State the latent distribution(s) and any shape parameters.</li>
<li>Report the number of replications and persons per replication.</li>
<li>Describe seed management for reproducibility.</li>
<li>Cite Lee (2025) and the IRTsimrel package.</li>
</ol>
</div>
<div class="section level3">
<h3 id="results-table-template">Results table template<a class="anchor" aria-label="anchor" href="#results-table-template"></a>
</h3>
<p>The following table format is recommended for presenting results
across a factorial design with reliability as a factor:</p>
<table class="table">
<colgroup>
<col width="8%">
<col width="6%">
<col width="10%">
<col width="12%">
<col width="8%">
<col width="20%">
<col width="19%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left">Model</th>
<th align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math></th>
<th align="left">Latent</th>
<th align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>ρ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math></th>
<th align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math></th>
<th align="left">RMSE(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)</th>
<th align="left">Bias(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)</th>
<th align="left">Coverage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Rasch</td>
<td align="left">20</td>
<td align="left">Normal</td>
<td align="left">0.60</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr class="even">
<td align="left">Rasch</td>
<td align="left">20</td>
<td align="left">Normal</td>
<td align="left">0.70</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr class="odd">
<td align="left">Rasch</td>
<td align="left">20</td>
<td align="left">Normal</td>
<td align="left">0.80</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr class="even">
<td align="left">2PL</td>
<td align="left">20</td>
<td align="left">Normal</td>
<td align="left">0.60</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">—</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="methods-paragraph-template">Methods paragraph template<a class="anchor" aria-label="anchor" href="#methods-paragraph-template"></a>
</h3>
<p>Below is a complete, self-contained methods paragraph that can be
adapted for your manuscript. Replace bracketed placeholders with your
study’s values.</p>
<blockquote>
<p>We employed a [3] (target reliability: [0.60, 0.70, 0.80])
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
[2] (test length: [15, 30] items)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
[2] (latent distribution: [normal, positively skewed])
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
[2] (model: [Rasch, 2PL]) fully crossed factorial design, yielding [24]
conditions. Item response data were generated using the IRTsimrel R
package (Lee, 2025). For each condition, the Empirical Quadrature
Calibration (EQC) algorithm was used to find a global discrimination
scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
such that the population average-information reliability matched the
target. Quadrature integration used
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M = 10{,}000</annotation></semantics></math>
Monte Carlo samples from the latent and item parameter distributions.
All conditions were screened for feasibility prior to calibration; [0]
conditions were infeasible and excluded. Item difficulties were drawn
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0, 1)</annotation></semantics></math>;
for the 2PL model, baseline discriminations were drawn from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">LogNormal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{LogNormal}(0, 0.3)</annotation></semantics></math>
with a Gaussian copula to induce the empirically observed negative
difficulty-discrimination correlation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>S</mi></msub><mo>=</mo><mo>−</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\rho_S = -0.3</annotation></semantics></math>).
For each of [500] replications per condition,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>,</mo><mn>000</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">N = [1{,}000]</annotation></semantics></math>
simulees were drawn from the specified latent distribution and binary
responses were generated according to the IRT model. The maximum
absolute calibration error across all conditions was [&lt; 0.001]. All
seeds were recorded for reproducibility.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="common-pitfalls-and-solutions">Common Pitfalls and Solutions<a class="anchor" aria-label="anchor" href="#common-pitfalls-and-solutions"></a>
</h2>
<div class="section level3">
<h3 id="pitfall-1-ignoring-feasibility">Pitfall 1: Ignoring feasibility<a class="anchor" aria-label="anchor" href="#pitfall-1-ignoring-feasibility"></a>
</h3>
<p><strong>Problem</strong>: you set <code>target_rho = 0.90</code> with
10 items under the Rasch model, but EQC returns <code>c_star</code> at
the upper bound with a warning.</p>
<p><strong>Solution</strong>: always run
<code><a href="../reference/check_feasibility.html">check_feasibility()</a></code> before calibration. If the target is
infeasible, increase <code>n_items</code>, widen <code>c_bounds</code>,
or reduce the target.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick feasibility check before calibration</span></span>
<span><span class="va">feas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_feasibility.html">check_feasibility</a></span><span class="op">(</span></span>
<span>  n_items <span class="op">=</span> <span class="fl">10</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  c_bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">10</span><span class="op">)</span>, M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"10-item Rasch: achievable rho_tilde range = [%.3f, %.3f]\n"</span>,</span>
<span>            <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 10-item Rasch: achievable rho_tilde range = [0.025, 0.973]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Can achieve 0.90? %s\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fl">0.90</span> <span class="op">&lt;=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Can achieve 0.90? Yes</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pitfall-2-metric-confusion">Pitfall 2: Metric confusion<a class="anchor" aria-label="anchor" href="#pitfall-2-metric-confusion"></a>
</h3>
<p><strong>Problem</strong>: you calibrate with
<code>reliability_metric = "info"</code> and validate with the
MSEM-based metric, finding a discrepancy.</p>
<p><strong>Solution</strong>: by Jensen’s inequality,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>≥</mo><mover><mi>w</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{\rho} \geq \bar{w}</annotation></semantics></math>.
Always compare like with like. The recommended workflow uses
<code>"info"</code> throughout. If you need to report both metrics,
compute them using <code><a href="../reference/compute_rho_both.html">compute_rho_both()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute both metrics from a single calibration</span></span>
<span><span class="va">both</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_rho_both.html">compute_rho_both</a></span><span class="op">(</span></span>
<span>  c         <span class="op">=</span> <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">c_star</span>,</span>
<span>  theta_vec <span class="op">=</span> <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">theta_quad</span>,</span>
<span>  beta_vec  <span class="op">=</span> <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">beta_vec</span>,</span>
<span>  lambda_base <span class="op">=</span> <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">lambda_base</span>,</span>
<span>  theta_var <span class="op">=</span> <span class="va">eqc_rasch</span><span class="op">$</span><span class="va">theta_var</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"rho_tilde (info): %.4f\n"</span>, <span class="va">both</span><span class="op">$</span><span class="va">rho_tilde</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; rho_tilde (info): 0.8000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"rho_bar   (msem): %.4f\n"</span>, <span class="va">both</span><span class="op">$</span><span class="va">rho_bar</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; rho_bar   (msem): 0.7893</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Gap (Jensen):     %.4f\n"</span>, <span class="va">both</span><span class="op">$</span><span class="va">rho_tilde</span> <span class="op">-</span> <span class="va">both</span><span class="op">$</span><span class="va">rho_bar</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Gap (Jensen):     0.0107</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pitfall-3-insufficient-quadrature-size-m">Pitfall 3: Insufficient quadrature size (M)<a class="anchor" aria-label="anchor" href="#pitfall-3-insufficient-quadrature-size-m"></a>
</h3>
<p><strong>Problem</strong>: Monte Carlo noise causes calibration
results to vary across runs even with the same seed.</p>
<p><strong>Solution</strong>: use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>≥</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M \geq 10{,}000</annotation></semantics></math>
for routine work and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>≥</mo><mn>50</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M \geq 50{,}000</annotation></semantics></math>
for high-precision studies. With a fixed seed, results are deterministic
for a given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="pitfall-4-c_bounds-too-narrow">Pitfall 4: c_bounds too narrow<a class="anchor" aria-label="anchor" href="#pitfall-4-c_bounds-too-narrow"></a>
</h3>
<p><strong>Problem</strong>: the root is outside the default
<code>c_bounds = c(0.3, 3)</code>, causing EQC to return a boundary
solution.</p>
<p><strong>Solution</strong>: for very high targets (&gt; 0.85), try
<code>c_bounds = c(0.1, 10)</code>. For very low targets (&lt; 0.50),
try <code>c_bounds = c(0.01, 3)</code>. You can always check the
achievable range using the <code>misc$rho_bounds</code> field of the
calibration result.</p>
</div>
<div class="section level3">
<h3 id="pitfall-5-latent-shape-effects-on-reliability">Pitfall 5: Latent shape effects on reliability<a class="anchor" aria-label="anchor" href="#pitfall-5-latent-shape-effects-on-reliability"></a>
</h3>
<p><strong>Problem</strong>: calibrating under <code>"normal"</code> but
generating data under <code>"bimodal"</code> gives achieved reliability
different from the target.</p>
<p><strong>Solution</strong>: the calibration and data generation must
use the <strong>same</strong> latent distribution. If you intentionally
mismatch them (e.g., to study robustness as in Case Study 2 of
<code><a href="../articles/case-studies.html">vignette("case-studies")</a></code>), document and report the actual
reliability under the mismatched distribution.</p>
</div>
<div class="section level3">
<h3 id="pitfall-6-finite-sample-deviation">Pitfall 6: Finite-sample deviation<a class="anchor" aria-label="anchor" href="#pitfall-6-finite-sample-deviation"></a>
</h3>
<p><strong>Problem</strong>: with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N = 100</annotation></semantics></math>
persons, the sample reliability (e.g., from TAM) deviates substantially
from the population target.</p>
<p><strong>Solution</strong>: finite-sample deviation is expected and
follows a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msqrt><mi>N</mi></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(1/\sqrt{N})</annotation></semantics></math>
decay. Use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>≥</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">N \geq 500</annotation></semantics></math>
to keep sampling variability manageable. Report both the
population-level target and the empirical reliability estimate.</p>
</div>
</div>
<div class="section level2">
<h2 id="publication-ready-methods-text">Publication-Ready Methods Text<a class="anchor" aria-label="anchor" href="#publication-ready-methods-text"></a>
</h2>
<p>Below is a second example methods paragraph, this time for a simpler
two-factor design. Adapt the template by filling in your study’s
values.</p>
<blockquote>
<p>Item response data were generated using the IRTsimrel R package
(v0.2.0; Lee, 2025). A 3 (target reliability: 0.60, 0.70, 0.80) x 2
(model: Rasch, 2PL) factorial design was employed with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">I = 20</annotation></semantics></math>
items and a standard normal latent distribution. For each of the six
conditions, the Empirical Quadrature Calibration (EQC) algorithm was
used with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M = 10{,}000</annotation></semantics></math>
quadrature points to find the global discrimination scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
matching the target average-information reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>*</mo></msup><annotation encoding="application/x-tex">\tilde{\rho}^*</annotation></semantics></math>.
Item difficulties were drawn from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0, 1)</annotation></semantics></math>;
for the 2PL model, baseline discriminations from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">LogNormal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{LogNormal}(0, 0.3)</annotation></semantics></math>.
All conditions were verified feasible prior to calibration. For each of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">R = 500</annotation></semantics></math>
replications per condition,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">N = 1{,}000</annotation></semantics></math>
persons were drawn from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0, 1)</annotation></semantics></math>
and binary responses generated according to the IRT model. Maximum
calibration error was
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><msup><mn>10</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">&lt; 10^{-4}</annotation></semantics></math>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="summary-and-cross-references">Summary and Cross-References<a class="anchor" aria-label="anchor" href="#summary-and-cross-references"></a>
</h2>
<p>This vignette presented a complete workflow for designing IRT
simulation studies with reliability as a controlled design factor:</p>
<ol style="list-style-type: decimal">
<li>Build a factorial design with <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>.</li>
<li>Screen all cells for feasibility with
<code><a href="../reference/check_feasibility.html">check_feasibility()</a></code>.</li>
<li>Visualize reliability curves with <code><a href="../reference/rho_curve.html">rho_curve()</a></code>.</li>
<li>Batch-calibrate with <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code>.</li>
<li>Generate data with <code><a href="../reference/simulate_response_data.html">simulate_response_data()</a></code>.</li>
<li>Verify calibration accuracy.</li>
<li>Report following the guidelines above.</li>
</ol>
<p>The key takeaway: <strong>reliability is not just an outcome to be
measured after the fact; it is a design parameter to be specified,
controlled, and reported from the outset.</strong> IRTsimrel makes this
easy and precise.</p>
<p>For related topics, see:</p>
<ul>
<li>
<code><a href="../articles/introduction.html">vignette("introduction")</a></code> – package overview and quick
start.</li>
<li>
<code><a href="../articles/algorithm-eqc.html">vignette("algorithm-eqc")</a></code> – deep dive into Algorithm 1
(EQC).</li>
<li>
<code><a href="../articles/algorithm-sac.html">vignette("algorithm-sac")</a></code> – Algorithm 2 (SAC) for
independent validation.</li>
<li>
<code><a href="../articles/item-parameters.html">vignette("item-parameters")</a></code> – generating realistic item
parameters.</li>
<li>
<code><a href="../articles/latent-distributions.html">vignette("latent-distributions")</a></code> – working with
non-normal latent distributions.</li>
<li>
<code><a href="../articles/validation.html">vignette("validation")</a></code> – validation procedures and TAM
integration.</li>
<li>
<code><a href="../articles/case-studies.html">vignette("case-studies")</a></code> – publication-ready simulation
templates.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J. (2025). Reliability-targeted simulation of item response
data: Solving the inverse design problem. <em>arXiv preprint
arXiv:2512.16012</em>.</p>
<p>Robbins, H., &amp; Monro, S. (1951). A stochastic approximation
method. <em>The Annals of Mathematical Statistics, 22</em>(3),
400–407.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
