<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Working with Latent Distributions ‚Ä¢ IRTsimrel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with Latent Distributions">
<meta name="description" content="A comprehensive guide to generating latent ability distributions using sim_latentG(), covering all 12 built-in shapes, custom mixtures, covariate effects, and the connection to reliability-targeted simulation.
">
<meta property="og:description" content="A comprehensive guide to generating latent ability distributions using sim_latentG(), covering all 12 built-in shapes, custom mixtures, covariate effects, and the connection to reliability-targeted simulation.
">
<meta property="og:image" content="https://joonho112.github.io/IRTsimrel/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IRTsimrel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applied Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/latent-distributions.html">Latent Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/item-parameters.html">Item Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-design.html">Simulation Design</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methodological Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-reliability.html">Reliability Theory</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-eqc.html">Algorithm 1: EQC</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-sac.html">Algorithm 2: SAC</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/IRTsimrel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Working with Latent Distributions</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/IRTsimrel/blob/main/vignettes/latent-distributions.Rmd" class="external-link"><code>vignettes/latent-distributions.Rmd</code></a></small>
      <div class="d-none name"><code>latent-distributions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">1. Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> function generates latent abilities
(person parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ∏</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>)
for IRT simulation studies. It implements the population model:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mi>p</mi></msub><mo>‚àº</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">\theta_p \sim G</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
is a flexible distribution family that can take many different shapes
while maintaining rigorous standardization properties.</p>
<p><strong>Estimated reading time</strong>: 20‚Äì25 minutes.</p>
<p><strong>This vignette covers</strong>:</p>
<ol style="list-style-type: decimal">
<li>The pre-standardization principle</li>
<li>Available distribution shapes (12 built-in + custom)</li>
<li>Customizing shape parameters</li>
<li>Creating custom mixture distributions</li>
<li>Adding covariate effects</li>
<li>Visualization tools</li>
<li>How latent shape affects achievable reliability</li>
</ol>
<p>For the complete applied workflow that uses
<code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> as part of reliability-targeted simulation,
see <code><a href="../articles/applied-guide.html">vignette("applied-guide")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="the-pre-standardization-principle">2. The Pre-Standardization Principle<a class="anchor" aria-label="anchor" href="#the-pre-standardization-principle"></a>
</h2>
<p>A key design feature of <code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> is
<strong>pre-standardization</strong>: every built-in distribution shape
is mathematically constructed to have <strong>mean 0 and variance
1</strong> before any scaling is applied.</p>
<p>This ensures that:</p>
<ul>
<li>Changing the shape does <strong>not</strong> inadvertently change
the scale</li>
<li>The <code>sigma</code> parameter directly controls the standard
deviation</li>
<li>Comparisons across shapes are meaningful</li>
</ul>
<p>The generated abilities follow:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mi>p</mi></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msubsup><mi>X</mi><mi>p</mi><mi>‚ä§</mi></msubsup><mi>Œ≤</mi><mo>+</mo><mi>œÉ</mi><mo>‚ãÖ</mo><msub><mi>z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\theta_p = \mu + X_p^\top \beta + \sigma \cdot z_p</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>p</mi></msub><mo>‚àº</mo><msub><mi>G</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">z_p \sim G_0</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[z] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Var}[z] = 1</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="why-this-matters">2.1 Why This Matters<a class="anchor" aria-label="anchor" href="#why-this-matters"></a>
</h3>
<p>In traditional simulation approaches, changing the latent
distribution often changes both the shape <em>and</em> the scale
simultaneously. For example, switching from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(0, 1)</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Gamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Gamma}(4, 1)</annotation></semantics></math>
changes not just the shape but also the variance.</p>
<p>With pre-standardization, you can study the effect of distributional
shape on IRT estimation while holding variance constant ‚Äì a cleaner
experimental design.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-usage">3. Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate 1000 standard normal abilities</span></span>
<span><span class="va">sim_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, shape <span class="op">=</span> <span class="st">"normal"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_normal</span><span class="op">)</span></span>
<span><span class="co">#&gt; Latent Ability Distribution (G-family)</span></span>
<span><span class="co">#&gt; =======================================</span></span>
<span><span class="co">#&gt;   Shape     : normal</span></span>
<span><span class="co">#&gt;   n         : 1000</span></span>
<span><span class="co">#&gt;   Target mu : 0.000</span></span>
<span><span class="co">#&gt;   Target sigma: 1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Moments:</span></span>
<span><span class="co">#&gt;   Mean      : -0.0258</span></span>
<span><span class="co">#&gt;   SD        : 1.0025</span></span>
<span><span class="co">#&gt;   Skewness  : -0.0038</span></span>
<span><span class="co">#&gt;   Kurtosis  : 0.1286 (excess)</span></span></code></pre></div>
<p>The output shows:</p>
<ul>
<li>
<strong>Target mu/sigma</strong>: The requested location and
scale</li>
<li>
<strong>Sample Moments</strong>: Empirical mean, SD, skewness, and
excess kurtosis</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Verify standardization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sample mean: %.4f (target: 0)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_normal</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample mean: -0.0258 (target: 0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sample SD:   %.4f (target: 1)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sim_normal</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample SD:   1.0025 (target: 1)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="available-distribution-shapes">4. Available Distribution Shapes<a class="anchor" aria-label="anchor" href="#available-distribution-shapes"></a>
</h2>
<p><code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> provides 12 built-in shapes, each
pre-standardized to mean 0 and variance 1.</p>
<div class="section level3">
<h3 id="standard-normal">4.1 Standard Normal<a class="anchor" aria-label="anchor" href="#standard-normal"></a>
</h3>
<p>The baseline case:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z \sim N(0, 1)</annotation></semantics></math></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"normal"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_normal</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/normal-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bimodal-distribution">4.2 Bimodal Distribution<a class="anchor" aria-label="anchor" href="#bimodal-distribution"></a>
</h3>
<p>A symmetric two-component Gaussian mixture, useful for representing
populations with two distinct subgroups (e.g., native vs.¬†non-native
speakers).</p>
<p><strong>Mathematical construction:</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>s</mi><mo>‚ãÖ</mo><mi>Œ¥</mi><mo>+</mo><mi>œµ</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>s</mi><mo>‚àº</mo><mtext mathvariant="normal">Rademacher</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo>¬±</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>œµ</mi><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>‚àí</mo><msup><mi>Œ¥</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z = s \cdot \delta + \epsilon, \quad s \sim \text{Rademacher}(\pm 1), \quad \epsilon \sim N(0, 1 - \delta^2)</annotation></semantics></math></p>
<p>The component variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><msup><mi>Œ¥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">1 - \delta^2</annotation></semantics></math>
ensures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>Œ¥</mi><mn>2</mn></msup><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msup><mi>Œ¥</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Var}[z] = \delta^2 + (1 - \delta^2) = 1</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_bimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"bimodal"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_bimodal</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/bimodal-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Customizing mode separation:</strong></p>
<p>The <code>delta</code> parameter controls how far apart the modes are
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>Œ¥</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; \delta &lt; 1</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wider separation</span></span>
<span><span class="va">sim_bimodal_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  shape_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_bimodal_wide</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/bimodal-delta-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="trimodal-distribution">4.3 Trimodal Distribution<a class="anchor" aria-label="anchor" href="#trimodal-distribution"></a>
</h3>
<p>A symmetric three-component mixture with a central peak and two side
peaks.</p>
<p><strong>Mathematical construction:</strong></p>
<p>Components at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mo>‚àí</mo><mi>m</mi><mo>,</mo><mn>0</mn><mo>,</mo><mo>+</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{-m, 0, +m\}</annotation></semantics></math>
with weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>w</mi><mi>L</mi></msub><mo>,</mo><msub><mi>w</mi><mn>0</mn></msub><mo>,</mo><msub><mi>w</mi><mi>R</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(w_L, w_0, w_R)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>L</mi></msub><mo>=</mo><msub><mi>w</mi><mi>R</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">w_L = w_R = (1 - w_0)/2</annotation></semantics></math>.</p>
<p>Component variance:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>c</mi><mn>2</mn></msubsup><mo>=</mo><mn>1</mn><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>w</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>m</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sigma_c^2 = 1 - (1 - w_0) m^2</annotation></semantics></math></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_trimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"trimodal"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_trimodal</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/trimodal-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Customizing:</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Stronger central peak</span></span>
<span><span class="va">sim_trimodal_central</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"trimodal"</span>,</span>
<span>  shape_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    w0 <span class="op">=</span> <span class="fl">0.5</span>,   <span class="co"># Weight of central component (default: 1/3)</span></span>
<span>    m <span class="op">=</span> <span class="fl">1.3</span>     <span class="co"># Location of side components (default: 1.2)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_trimodal_central</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/trimodal-custom-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="multimodal-four-components">4.4 Multimodal (Four Components)<a class="anchor" aria-label="anchor" href="#multimodal-four-components"></a>
</h3>
<p>A symmetric four-component mixture with modes at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mo>‚àí</mo><msub><mi>m</mi><mn>2</mn></msub><mo>,</mo><mo>‚àí</mo><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><mo>+</mo><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><mo>+</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{-m_2, -m_1, +m_1, +m_2\}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"multimodal"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_multi</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/multimodal-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="skewed-distributions">4.5 Skewed Distributions<a class="anchor" aria-label="anchor" href="#skewed-distributions"></a>
</h3>
<p><strong>Right-skewed (skew_pos)</strong>: Based on standardized Gamma
distribution:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><mi>Œì</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mi>k</mi></mrow><msqrt><mi>k</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">z = \frac{\Gamma(k, 1) - k}{\sqrt{k}}</annotation></semantics></math></p>
<p>This has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[z] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Var}[z] = 1</annotation></semantics></math>
for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k &gt; 0</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_skew_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"skew_pos"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_skew_pos</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/skew-pos-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Left-skewed (skew_neg)</strong>: Simply the negation of the
right-skewed distribution.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_skew_neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"skew_neg"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_skew_neg</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/skew-neg-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Controlling skewness magnitude:</strong></p>
<p>The <code>k</code> parameter (Gamma shape) controls skewness ‚Äì
smaller values mean more skewed:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># More extreme skewness (k = 2)</span></span>
<span><span class="va">sim_very_skew</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"skew_pos"</span>,</span>
<span>  shape_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Default k=4 skewness: %.3f\n"</span>, <span class="va">sim_skew_pos</span><span class="op">$</span><span class="va">sample_moments</span><span class="op">$</span><span class="va">skewness</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Default k=4 skewness: 0.812</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"k=2 skewness:         %.3f\n"</span>, <span class="va">sim_very_skew</span><span class="op">$</span><span class="va">sample_moments</span><span class="op">$</span><span class="va">skewness</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; k=2 skewness:         1.244</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="heavy-tailed-distribution">4.6 Heavy-Tailed Distribution<a class="anchor" aria-label="anchor" href="#heavy-tailed-distribution"></a>
</h3>
<p>Based on standardized Student-t:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><msub><mi>t</mi><mi>ŒΩ</mi></msub><msqrt><mrow><mi>ŒΩ</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>‚àí</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">z = \frac{t_\nu}{\sqrt{\nu / (\nu - 2)}}</annotation></semantics></math></p>
<p>This has
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\text{Var}[z] = 1</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ŒΩ</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\nu &gt; 2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_heavy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"heavy_tail"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_heavy</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/heavy-tail-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Controlling tail heaviness:</strong></p>
<p>The <code>df</code> parameter (degrees of freedom) controls tail
weight ‚Äì smaller values mean heavier tails:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Very heavy tails (df = 3)</span></span>
<span><span class="va">sim_very_heavy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"heavy_tail"</span>,</span>
<span>  shape_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Default df=5 kurtosis: %.3f\n"</span>, <span class="va">sim_heavy</span><span class="op">$</span><span class="va">sample_moments</span><span class="op">$</span><span class="va">kurtosis</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Default df=5 kurtosis: 2.924</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"df=3 kurtosis:         %.3f\n"</span>, <span class="va">sim_very_heavy</span><span class="op">$</span><span class="va">sample_moments</span><span class="op">$</span><span class="va">kurtosis</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; df=3 kurtosis:         7.956</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="light-tailed-platykurtic-distribution">4.7 Light-Tailed (Platykurtic) Distribution<a class="anchor" aria-label="anchor" href="#light-tailed-platykurtic-distribution"></a>
</h3>
<p>A mixture distribution approximating a platykurtic shape (negative
excess kurtosis).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_light</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"light_tail"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_light</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/light-tail-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="uniform-distribution">4.8 Uniform Distribution<a class="anchor" aria-label="anchor" href="#uniform-distribution"></a>
</h3>
<p>Uniform on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mo>‚àí</mo><msqrt><mn>3</mn></msqrt><mo>,</mo><mo>+</mo><msqrt><mn>3</mn></msqrt><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[-\sqrt{3}, +\sqrt{3}]</annotation></semantics></math>,
which has mean 0 and variance 1.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_uniform</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"uniform"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_uniform</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/uniform-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="floor-and-ceiling-effects">4.9 Floor and Ceiling Effects<a class="anchor" aria-label="anchor" href="#floor-and-ceiling-effects"></a>
</h3>
<p>These represent situations where there is a concentration of
examinees at one end of the ability distribution.</p>
<p><strong>Floor effect</strong>: Heavy component near the lower bound
(e.g., many low-ability students in a difficult test)</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_floor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"floor"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_floor</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/floor-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p><strong>Ceiling effect</strong>: Heavy component near the upper bound
(e.g., many high-ability students in an easy test)</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_ceiling</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, shape <span class="op">=</span> <span class="st">"ceiling"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_ceiling</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/ceiling-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="comparing-multiple-shapes">5. Comparing Multiple Shapes<a class="anchor" aria-label="anchor" href="#comparing-multiple-shapes"></a>
</h2>
<p>The <code><a href="../reference/compare_shapes.html">compare_shapes()</a></code> function provides a convenient way
to visualize multiple distributions side-by-side:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/compare_shapes.html">compare_shapes</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>  shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"bimodal"</span>, <span class="st">"trimodal"</span>,</span>
<span>             <span class="st">"skew_pos"</span>, <span class="st">"heavy_tail"</span>, <span class="st">"uniform"</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/compare-shapes-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="custom-mixture-distributions">6. Custom Mixture Distributions<a class="anchor" aria-label="anchor" href="#custom-mixture-distributions"></a>
</h2>
<p>For maximum flexibility, use <code>shape = "custom"</code> with
<code>mixture_spec</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a custom 3-component mixture</span></span>
<span><span class="va">sim_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>  mixture_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,   <span class="co"># Must sum to 1</span></span>
<span>    means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,        <span class="co"># Component means</span></span>
<span>    sds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span><span class="op">)</span>        <span class="co"># Component SDs</span></span>
<span>  <span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim_custom</span>, show_normal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/custom-mixture-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p>By default, custom mixtures are automatically post-standardized to
have mean 0 and variance 1. To disable this:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Keep raw mixture parameters</span></span>
<span><span class="va">sim_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>  mixture_spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    sds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  standardize_custom <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adjusting-location-and-scale">7. Adjusting Location and Scale<a class="anchor" aria-label="anchor" href="#adjusting-location-and-scale"></a>
</h2>
<p>The <code>mu</code> and <code>sigma</code> parameters allow you to
shift and scale the distribution:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate abilities with mean 100 and SD 15 (like IQ scores)</span></span>
<span><span class="va">sim_iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sim_iq</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary: Latent Ability Distribution</span></span>
<span><span class="co">#&gt; ====================================</span></span>
<span><span class="co">#&gt;   Shape      : normal</span></span>
<span><span class="co">#&gt;   n          : 1000</span></span>
<span><span class="co">#&gt;   Target     : mu = 100.00, sigma = 15.00</span></span>
<span><span class="co">#&gt;   Covariates : No</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Statistics:</span></span>
<span><span class="co">#&gt;   Mean       : 99.6126</span></span>
<span><span class="co">#&gt;   SD         : 15.0378</span></span>
<span><span class="co">#&gt;   Median     : 99.8030</span></span>
<span><span class="co">#&gt;   Skewness   : -0.0038</span></span>
<span><span class="co">#&gt;   Kurtosis   : 0.1286 (excess)</span></span>
<span><span class="co">#&gt;   Range      : [49.4239, 152.4296]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quantiles:</span></span>
<span><span class="co">#&gt;     2.5%       5%      25%      50%      75%      95%    97.5% </span></span>
<span><span class="co">#&gt;  69.8816  75.3193  89.8681  99.8030 109.9601 123.0023 128.1655</span></span></code></pre></div>
<p>This works with any shape:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bimodal with different scale</span></span>
<span><span class="va">sim_bimodal_scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">1.5</span>,  <span class="co"># Larger spread</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sample SD: %.3f (target: 1.5)\n"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sim_bimodal_scaled</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample SD: 1.481 (target: 1.5)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-covariate-effects">8. Adding Covariate Effects<a class="anchor" aria-label="anchor" href="#adding-covariate-effects"></a>
</h2>
<p>You can incorporate person-level covariates that affect ability:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create covariate data</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>           <span class="co"># Binary group indicator</span></span>
<span><span class="va">ses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>                       <span class="co"># Continuous SES measure</span></span>
<span></span>
<span><span class="co"># Generate abilities with covariate effects</span></span>
<span><span class="va">sim_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="va">n</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  xcov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">group</span>, ses <span class="op">=</span> <span class="va">ses</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,  <span class="co"># Group effect = 0.5, SES effect = 0.3</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify covariate effects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean ability by group:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean ability by group:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Group 0: %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_cov</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Group 0: -0.084</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Group 1: %.3f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_cov</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Group 1: 0.519</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Difference: %.3f (expected: 0.5)\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_cov</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sim_cov</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="va">group</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Difference: 0.602 (expected: 0.5)</span></span></code></pre></div>
<p>The full model is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mi>p</mi></msub><mo>=</mo><mi>Œº</mi><mo>+</mo><msubsup><mi>X</mi><mi>p</mi><mi>‚ä§</mi></msubsup><mi>Œ≤</mi><mo>+</mo><mi>œÉ</mi><mo>‚ãÖ</mo><msub><mi>z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\theta_p = \mu + X_p^\top \beta + \sigma \cdot z_p</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>p</mi></msub><annotation encoding="application/x-tex">X_p</annotation></semantics></math>
is the covariate vector for person
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="working-with-the-output-object">9. Working with the Output Object<a class="anchor" aria-label="anchor" href="#working-with-the-output-object"></a>
</h2>
<p>The <code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> function returns a
<code>latent_G</code> object containing:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, shape <span class="op">=</span> <span class="st">"bimodal"</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Available components</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "theta"          "mu"             "sigma"          "eta_cov"       </span></span>
<span><span class="co">#&gt; [5] "shape"          "shape_params"   "n"              "sample_moments"</span></span>
<span><span class="co">#&gt; [9] "z"</span></span>
<span></span>
<span><span class="co"># The theta vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.5611365  0.4327842 -0.5953282 -1.4776179  1.6598142  0.3882399</span></span>
<span></span>
<span><span class="co"># The standardized z values (before scaling)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.5611365  0.4327842 -0.5953282 -1.4776179  1.6598142  0.3882399</span></span>
<span></span>
<span><span class="co"># Sample moments</span></span>
<span><span class="va">sim</span><span class="op">$</span><span class="va">sample_moments</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 0.005452304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 0.9591602</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $skewness</span></span>
<span><span class="co">#&gt; [1] -0.1115873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kurtosis</span></span>
<span><span class="co">#&gt; [1] -1.109185</span></span></code></pre></div>
<div class="section level3">
<h3 id="extracting-theta-for-other-uses">9.1 Extracting Theta for Other Uses<a class="anchor" aria-label="anchor" href="#extracting-theta-for-other-uses"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get theta as a numeric vector</span></span>
<span><span class="va">theta_vec</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">theta</span></span>
<span></span>
<span><span class="co"># Use in your own analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">theta_vec</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.005452304</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="connection-to-irt-framework">10. Connection to IRT Framework<a class="anchor" aria-label="anchor" href="#connection-to-irt-framework"></a>
</h2>
<p>In the Rasch/2PL model, the latent distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
affects key quantities:</p>
<div class="section level3">
<h3 id="marginal-reliability">10.1 Marginal Reliability<a class="anchor" aria-label="anchor" href="#marginal-reliability"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>w</mi><mo accent="true">‚Äæ</mo></mover><mo>=</mo><mfrac><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mrow><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mo>+</mo><mtext mathvariant="normal">MSEM</mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">\bar{w} = \frac{\sigma^2_\theta}{\sigma^2_\theta + \text{MSEM}}</annotation></semantics></math></p>
<p>where MSEM is the mean squared error of measurement.</p>
</div>
<div class="section level3">
<h3 id="expected-test-information">10.2 Expected Test Information<a class="anchor" aria-label="anchor" href="#expected-test-information"></a>
</h3>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ùí•</mi><mo accent="true">‚Äæ</mo></mover><mo>=</mo><msub><mi>ùîº</mi><mi>G</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>ùí•</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\bar{\mathcal{J}} = \mathbb{E}_G[\mathcal{J}(\theta)]</annotation></semantics></math></p>
<p>Different latent shapes produce different expected information
profiles, even with identical item parameters.</p>
</div>
<div class="section level3">
<h3 id="identifiability">10.3 Identifiability<a class="anchor" aria-label="anchor" href="#identifiability"></a>
</h3>
<p>For model identification in the Rasch model, we typically fix
either:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[\theta] = 0</annotation></semantics></math>
(location constraint), or</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚àë</mo><mi>i</mi></msub><msub><mi>Œ≤</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sum_i \beta_i = 0</annotation></semantics></math>
(item constraint)</li>
</ul>
<p>The <code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> function generates abilities with mean
0 by default, supporting the first identification approach.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-latent-shape-affects-achievable-reliability">11. How Latent Shape Affects Achievable Reliability<a class="anchor" aria-label="anchor" href="#how-latent-shape-affects-achievable-reliability"></a>
</h2>
<p>Different latent shapes lead to different achievable reliability
ranges for the same test design. This section uses
<code><a href="../reference/check_feasibility.html">check_feasibility()</a></code> and <code><a href="../reference/rho_curve.html">rho_curve()</a></code> to explore
this connection.</p>
<div class="section level3">
<h3 id="feasibility-across-shapes">11.1 Feasibility Across Shapes<a class="anchor" aria-label="anchor" href="#feasibility-across-shapes"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shapes_feas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"bimodal"</span>, <span class="st">"skew_pos"</span>, <span class="st">"heavy_tail"</span>, <span class="st">"uniform"</span><span class="op">)</span></span>
<span><span class="va">feas_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, rho_tilde_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>, rho_tilde_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rho_bar_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>, rho_bar_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sh</span> <span class="kw">in</span> <span class="va">shapes_feas</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">feas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_feasibility.html">check_feasibility</a></span><span class="op">(</span></span>
<span>    n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, latent_shape <span class="op">=</span> <span class="va">sh</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">feas_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">feas_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">sh</span>,</span>
<span>    rho_tilde_min <span class="op">=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    rho_tilde_max <span class="op">=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    rho_bar_min <span class="op">=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_msem</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    rho_bar_max <span class="op">=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_msem</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">feas_results</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Shape"</span>, <span class="st">"rho_tilde min"</span>, <span class="st">"rho_tilde max"</span>,</span>
<span>                <span class="st">"rho_bar min"</span>, <span class="st">"rho_bar max"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Achievable reliability ranges across latent shapes (25-item Rasch)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Achievable reliability ranges across latent shapes (25-item
Rasch)</caption>
<thead><tr class="header">
<th align="left">Shape</th>
<th align="right">rho_tilde min</th>
<th align="right">rho_tilde max</th>
<th align="right">rho_bar min</th>
<th align="right">rho_bar max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">normal</td>
<td align="right">0.0591</td>
<td align="right">0.9872</td>
<td align="right">0.0002</td>
<td align="right">0.9146</td>
</tr>
<tr class="even">
<td align="left">bimodal</td>
<td align="right">0.0583</td>
<td align="right">0.9834</td>
<td align="right">0.0583</td>
<td align="right">0.9722</td>
</tr>
<tr class="odd">
<td align="left">skew_pos</td>
<td align="right">0.0589</td>
<td align="right">0.9864</td>
<td align="right">0.0000</td>
<td align="right">0.8804</td>
</tr>
<tr class="even">
<td align="left">heavy_tail</td>
<td align="right">0.0581</td>
<td align="right">0.9857</td>
<td align="right">0.0000</td>
<td align="right">0.8706</td>
</tr>
<tr class="odd">
<td align="left">uniform</td>
<td align="right">0.0595</td>
<td align="right">0.9856</td>
<td align="right">0.0595</td>
<td align="right">0.9576</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="reliability-curves-across-shapes">11.2 Reliability Curves Across Shapes<a class="anchor" aria-label="anchor" href="#reliability-curves-across-shapes"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shapes_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"bimodal"</span>, <span class="st">"skew_pos"</span>, <span class="st">"heavy_tail"</span><span class="op">)</span></span>
<span><span class="va">curve_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#2166AC"</span>, <span class="st">"#B2182B"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#984EA3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate curves</span></span>
<span><span class="va">all_curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">shapes_curve</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">all_curves</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rho_curve.html">rho_curve</a></span><span class="op">(</span></span>
<span>    n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>, latent_shape <span class="op">=</span> <span class="va">shapes_curve</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Scaling factor c"</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu">tilde</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span><span class="op">(</span><span class="va">c</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Reliability Curves by Latent Shape (25-item Rasch, info metric)"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">shapes_curve</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">all_curves</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">c</span>, <span class="va">all_curves</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">rho_tilde</span>,</span>
<span>        col <span class="op">=</span> <span class="va">curve_colors</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.80</span>, col <span class="op">=</span> <span class="st">"gray40"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">0.82</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">rho</span> <span class="op">*</span> <span class="st">" = 0.80"</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, col <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="va">shapes_curve</span>,</span>
<span>       col <span class="op">=</span> <span class="va">curve_colors</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"#CCCCCC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="latent-distributions_files/figure-html/shape-curves-1.png" class="r-plt" alt="" width="85%" style="display: block; margin: auto;"></p>
<p>The figure shows that all shapes can reach high reliability, but some
require larger scaling factors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
to compensate for the reduced average information when ability mass is
spread away from the item difficulty region.</p>
</div>
<div class="section level3">
<h3 id="calibrating-across-shapes">11.3 Calibrating Across Shapes<a class="anchor" aria-label="anchor" href="#calibrating-across-shapes"></a>
</h3>
<p>Use <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code> with different
<code>latent_shape</code> arguments to see how the calibrated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
differs:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shapes_cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"bimodal"</span>, <span class="st">"skew_pos"</span>, <span class="st">"heavy_tail"</span>, <span class="st">"uniform"</span><span class="op">)</span></span>
<span><span class="va">cal_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, c_star <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  achieved_rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sh</span> <span class="kw">in</span> <span class="va">shapes_cal</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">sh</span>, item_source <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">cal_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">cal_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="va">sh</span>, c_star <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">c_star</span>,</span>
<span>    achieved_rho <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">achieved_rho</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">cal_results</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Shape"</span>, <span class="st">"c*"</span>, <span class="st">"Achieved rho"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Calibrated c* by latent shape (target rho = 0.80, 25-item Rasch)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Calibrated c* by latent shape (target rho = 0.80, 25-item
Rasch)</caption>
<thead><tr class="header">
<th align="left">Shape</th>
<th align="right">c*</th>
<th align="right">Achieved rho</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">normal</td>
<td align="right">0.8995</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">bimodal</td>
<td align="right">0.9577</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">skew_pos</td>
<td align="right">0.9132</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">heavy_tail</td>
<td align="right">0.9365</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">uniform</td>
<td align="right">0.9012</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="using-sim_latentg-with-eqc_calibrate">12. Using <code>sim_latentG()</code> with
<code>eqc_calibrate()</code><a class="anchor" aria-label="anchor" href="#using-sim_latentg-with-eqc_calibrate"></a>
</h2>
<p>When using <code><a href="../reference/sim_latentG.html">sim_latentG()</a></code> as part of reliability-targeted
simulation, specify the same parameters in
<code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code>:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calibrate for a bimodal population</span></span>
<span><span class="va">eqc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  latent_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate response data with the same distribution</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>  result <span class="op">=</span> <span class="va">eqc_result</span>,</span>
<span>  n_persons <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"bimodal"</span>,</span>
<span>  latent_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated c* = %.4f, achieved rho = %.4f\n"</span>,</span>
<span>            <span class="va">eqc_result</span><span class="op">$</span><span class="va">c_star</span>, <span class="va">eqc_result</span><span class="op">$</span><span class="va">achieved_rho</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calibrated c* = 0.9577, achieved rho = 0.8000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Response data: %d persons x %d items\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Response data: 1000 persons x 25 items</span></span></code></pre></div>
<p>For the complete 6-step applied workflow, see
<code><a href="../articles/applied-guide.html">vignette("applied-guide")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="summary-of-shape-parameters">13. Summary of Shape Parameters<a class="anchor" aria-label="anchor" href="#summary-of-shape-parameters"></a>
</h2>
<table class="table">
<colgroup>
<col width="14%">
<col width="23%">
<col width="19%">
<col width="14%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left">Shape</th>
<th align="left">Parameter</th>
<th align="left">Default</th>
<th align="left">Range</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>bimodal</code></td>
<td align="left"><code>delta</code></td>
<td align="left">0.8</td>
<td align="left">(0, 1)</td>
<td align="left">Mode separation</td>
</tr>
<tr class="even">
<td align="left"><code>trimodal</code></td>
<td align="left"><code>w0</code></td>
<td align="left">1/3</td>
<td align="left">(0, 1)</td>
<td align="left">Weight of central component</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><code>m</code></td>
<td align="left">1.2</td>
<td align="left">&gt; 0</td>
<td align="left">Location of side modes</td>
</tr>
<tr class="even">
<td align="left"><code>multimodal</code></td>
<td align="left"><code>m1</code></td>
<td align="left">0.5</td>
<td align="left">&gt; 0</td>
<td align="left">Inner mode locations</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><code>m2</code></td>
<td align="left">1.3</td>
<td align="left">&gt; 0</td>
<td align="left">Outer mode locations</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><code>w_inner</code></td>
<td align="left">0.30</td>
<td align="left">(0, 0.5)</td>
<td align="left">Weight of inner components</td>
</tr>
<tr class="odd">
<td align="left"><code>skew_pos/neg</code></td>
<td align="left"><code>k</code></td>
<td align="left">4</td>
<td align="left">&gt; 0</td>
<td align="left">Gamma shape (smaller = more skewed)</td>
</tr>
<tr class="even">
<td align="left"><code>heavy_tail</code></td>
<td align="left"><code>df</code></td>
<td align="left">5</td>
<td align="left">&gt; 2</td>
<td align="left">Degrees of freedom (smaller = heavier)</td>
</tr>
<tr class="odd">
<td align="left"><code>floor</code></td>
<td align="left"><code>w_floor</code></td>
<td align="left">0.3</td>
<td align="left">(0, 1)</td>
<td align="left">Weight at floor</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><code>m_floor</code></td>
<td align="left">-1.5</td>
<td align="left">&lt; 0</td>
<td align="left">Floor location</td>
</tr>
<tr class="odd">
<td align="left"><code>ceiling</code></td>
<td align="left"><code>w_ceil</code></td>
<td align="left">0.3</td>
<td align="left">(0, 1)</td>
<td align="left">Weight at ceiling</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"><code>m_ceil</code></td>
<td align="left">1.5</td>
<td align="left">&gt; 0</td>
<td align="left">Ceiling location</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="practical-recommendations">14. Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="choosing-a-shape">14.1 Choosing a Shape<a class="anchor" aria-label="anchor" href="#choosing-a-shape"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Research Question</th>
<th align="left">Recommended Shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Standard simulation</td>
<td align="left"><code>normal</code></td>
</tr>
<tr class="even">
<td align="left">Heterogeneous population</td>
<td align="left"><code>bimodal</code></td>
</tr>
<tr class="odd">
<td align="left">Mixed ability levels</td>
<td align="left">
<code>trimodal</code> or <code>multimodal</code>
</td>
</tr>
<tr class="even">
<td align="left">Selective samples</td>
<td align="left">
<code>skew_pos</code> or <code>skew_neg</code>
</td>
</tr>
<tr class="odd">
<td align="left">Robust estimation</td>
<td align="left"><code>heavy_tail</code></td>
</tr>
<tr class="even">
<td align="left">Easy/difficult tests</td>
<td align="left">
<code>ceiling</code> / <code>floor</code>
</td>
</tr>
<tr class="odd">
<td align="left">Sensitivity analysis</td>
<td align="left">Compare multiple shapes</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="sample-size-considerations">14.2 Sample Size Considerations<a class="anchor" aria-label="anchor" href="#sample-size-considerations"></a>
</h3>
<p>For stable Monte Carlo estimates:</p>
<ul>
<li>
<strong>M = 10,000</strong> or more for <code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code>
quadrature</li>
<li>
<strong>n = 500‚Äì2,000</strong> per replication for simulation
studies</li>
<li>Increase
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
for heavy-tailed or highly multimodal shapes</li>
</ul>
</div>
<div class="section level3">
<h3 id="reproducibility">14.3 Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"></a>
</h3>
<p>Always set a seed for reproducible results:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, shape <span class="op">=</span> <span class="st">"normal"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, shape <span class="op">=</span> <span class="st">"normal"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">$</span><span class="va">theta</span>, <span class="va">sim2</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span>  <span class="co"># TRUE</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">15. References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J. (2025). Reliability-targeted simulation of item response
data: Solving the inverse design problem. <em>arXiv preprint</em>,
arXiv:2512.16012.</p>
<p>Baker, F. B., &amp; Kim, S.-H. (2004). <em>Item Response Theory:
Parameter Estimation Techniques</em> (2nd ed.). Marcel Dekker.</p>
<p>Paganin, S., et al.¬†(2023). Computational strategies and estimation
performance with Bayesian semiparametric item response theory models.
<em>Journal of Educational and Behavioral Statistics, 48</em>(2),
147‚Äì188.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
