<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Case Studies: Publication-Ready Simulation Templates • IRTsimrel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Case Studies: Publication-Ready Simulation Templates">
<meta name="description" content="Three self-contained case studies demonstrating reliability-targeted IRT simulation for model comparison, robustness analysis, and sample size planning.
">
<meta property="og:description" content="Three self-contained case studies demonstrating reliability-targeted IRT simulation for model comparison, robustness analysis, and sample size planning.
">
<meta property="og:image" content="https://joonho112.github.io/IRTsimrel/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IRTsimrel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applied Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/latent-distributions.html">Latent Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/item-parameters.html">Item Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-design.html">Simulation Design</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methodological Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-reliability.html">Reliability Theory</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-eqc.html">Algorithm 1: EQC</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-sac.html">Algorithm 2: SAC</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/IRTsimrel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Case Studies: Publication-Ready Simulation Templates</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/IRTsimrel/blob/main/vignettes/case-studies.Rmd" class="external-link"><code>vignettes/case-studies.Rmd</code></a></small>
      <div class="d-none name"><code>case-studies.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>Reading time</strong>: approximately 30–35 minutes.</p>
<p>This vignette presents three self-contained case studies, each with a
research question, factorial design, executable code, computed results,
and a publication-ready methods paragraph. Every case study can serve as
a starting template for your own simulation work.</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="53%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">Case Study</th>
<th align="left">Research Question</th>
<th align="left">Key Factors</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Does the 2PL model recover difficulty better than Rasch
when reliability is held constant?</td>
<td align="left">Model (Rasch vs. 2PL) x Reliability</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">How does latent distribution misspecification affect
parameter recovery at controlled reliability?</td>
<td align="left">Generating distribution x Calibration distribution</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">What minimum sample size is needed for stable
difficulty recovery?</td>
<td align="left">Sample size (N) at fixed reliability</td>
</tr>
</tbody>
</table>
<p>Each case study follows the same five-step structure:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Research question</strong>: a precise, falsifiable
question.</li>
<li>
<strong>Design</strong>: a factorial layout with all factors and
levels.</li>
<li>
<strong>Code</strong>: executable R code using IRTsimrel.</li>
<li>
<strong>Results</strong>: tables and figures computed from eval=TRUE
code.</li>
<li>
<strong>Methods text</strong>: a publication-ready paragraph.</li>
</ol>
<p><strong>Prerequisites</strong>: familiarity with
<code><a href="../reference/eqc_calibrate.html">eqc_calibrate()</a></code> and <code><a href="../reference/simulate_response_data.html">simulate_response_data()</a></code>.
See <code><a href="../articles/introduction.html">vignette("introduction")</a></code> and
<code><a href="../articles/simulation-design.html">vignette("simulation-design")</a></code> for background.</p>
</div>
<div class="section level2">
<h2 id="case-study-1-model-comparison-under-controlled-reliability">Case Study 1: Model Comparison Under Controlled Reliability<a class="anchor" aria-label="anchor" href="#case-study-1-model-comparison-under-controlled-reliability"></a>
</h2>
<div class="section level3">
<h3 id="research-question">Research question<a class="anchor" aria-label="anchor" href="#research-question"></a>
</h3>
<blockquote>
<p>Does the 2PL model recover item difficulty parameters better than the
Rasch model when marginal reliability is held constant?</p>
</blockquote>
<p>Without reliability control, any observed difference in recovery
accuracy could be an artifact of differing data quality. By fixing
reliability, we isolate the effect of model structure on parameter
recovery.</p>
<p>This is a fundamental question in IRT methodology. The 2PL model has
more parameters to estimate, which may affect the precision of
difficulty estimates even when the overall data quality (as measured by
reliability) is equivalent.</p>
</div>
<div class="section level3">
<h3 id="design">Design<a class="anchor" aria-label="anchor" href="#design"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Factor</th>
<th align="left">Levels</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Model</td>
<td align="left">Rasch, 2PL</td>
</tr>
<tr class="even">
<td align="left">Reliability</td>
<td align="left">0.60, 0.70, 0.80</td>
</tr>
<tr class="odd">
<td align="left">Test length</td>
<td align="left">20 items (fixed)</td>
</tr>
<tr class="even">
<td align="left">N persons</td>
<td align="left">300 (fixed)</td>
</tr>
<tr class="odd">
<td align="left">Replications</td>
<td align="left">5 (for demonstration; use 500+ in practice)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs1_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  model       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rasch"</span>, <span class="st">"2pl"</span><span class="op">)</span>,</span>
<span>  target_rho  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">0.70</span>, <span class="fl">0.80</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">n_items</span>  <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">n_persons</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">5</span>  <span class="co"># Use R = 500+ for a real study</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Design cells: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cs1_design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Design cells: 6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Total data sets: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cs1_design</span><span class="op">)</span> <span class="op">*</span> <span class="va">R</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Total data sets: 30</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-1-feasibility-screening">Step 1: Feasibility screening<a class="anchor" aria-label="anchor" href="#step-1-feasibility-screening"></a>
</h3>
<p>Before calibration, verify that all target reliabilities are
achievable:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">mod</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rasch"</span>, <span class="st">"2pl"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">feas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_feasibility.html">check_feasibility</a></span><span class="op">(</span></span>
<span>    n_items      <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">mod</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>    verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %s: achievable rho_tilde = [%.3f, %.3f]\n"</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>, <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   RASCH: achievable rho_tilde = [0.048, 0.985]</span></span>
<span><span class="co">#&gt;   2PL: achievable rho_tilde = [0.062, 0.987]</span></span></code></pre></div>
<p>All target reliabilities (0.60, 0.70, 0.80) are within range.</p>
</div>
<div class="section level3">
<h3 id="step-2-calibrate-all-conditions">Step 2: Calibrate all conditions<a class="anchor" aria-label="anchor" href="#step-2-calibrate-all-conditions"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs1_calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cs1_design</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cs1_design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">cs1_design</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">cs1_calib</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho   <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">target_rho</span>,</span>
<span>    n_items      <span class="op">=</span> <span class="va">n_items</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">model</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>    seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>    verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Verify calibration accuracy</span></span>
<span><span class="va">cs1_design</span><span class="op">$</span><span class="va">achieved_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">cs1_calib</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">achieved_rho</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cs1_design</span><span class="op">$</span><span class="va">c_star</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">cs1_calib</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">c_star</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cs1_design</span><span class="op">)</span></span>
<span><span class="co">#&gt;   model target_rho achieved_rho    c_star</span></span>
<span><span class="co">#&gt; 1 rasch        0.6    0.6000048 0.5754772</span></span>
<span><span class="co">#&gt; 2   2pl        0.6    0.5999992 0.5060864</span></span>
<span><span class="co">#&gt; 3 rasch        0.7    0.6999999 0.7380681</span></span>
<span><span class="co">#&gt; 4   2pl        0.7    0.7000059 0.6511525</span></span>
<span><span class="co">#&gt; 5 rasch        0.8    0.8000008 1.0183044</span></span>
<span><span class="co">#&gt; 6   2pl        0.8    0.8000001 0.9025704</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-run-replications">Step 3: Run replications<a class="anchor" aria-label="anchor" href="#step-3-run-replications"></a>
</h3>
<p>For each replication, we:</p>
<ol style="list-style-type: decimal">
<li>Generate response data from the calibrated model.</li>
<li>Estimate item difficulties using a simple proportion-based method
(log-odds of item proportion correct).</li>
<li>Compute bias and RMSE of difficulty recovery.</li>
</ol>
<p>We use a log-odds difficulty estimator as a fast, base-R alternative
to full IRT estimation. This avoids any dependency on external
estimation packages like <code>mirt</code> or <code>TAM</code>. The
log-odds estimator is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>p</mi><mi>i</mi></msub><mrow><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>i</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{\beta}_i = -\log\left(\frac{p_i}{1 - p_i}\right)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>i</mi></msub><annotation encoding="application/x-tex">p_i</annotation></semantics></math>
is the proportion of correct responses for item
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
This is the standard item calibration under the Rasch model in the limit
of large
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Storage</span></span>
<span><span class="va">cs1_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  cell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, target_rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  bias_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>, rmse_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_abs_err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cs1_design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">cs1_design</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate data</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>      result    <span class="op">=</span> <span class="va">cs1_calib</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      n_persons <span class="op">=</span> <span class="va">n_persons</span>,</span>
<span>      seed      <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">i</span> <span class="op">+</span> <span class="va">r</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># True item difficulties</span></span>
<span>    <span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span></span>
<span></span>
<span>    <span class="co"># Estimate difficulties via item proportion correct</span></span>
<span>    <span class="co"># Use log-odds transformation: beta_hat = -log(p / (1-p))</span></span>
<span>    <span class="va">p_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span></span>
<span>    <span class="co"># Clip extreme proportions to avoid Inf</span></span>
<span>    <span class="va">p_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">p_items</span>, <span class="fl">0.001</span><span class="op">)</span>, <span class="fl">0.999</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p_items</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_items</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Center both for comparability (Rasch identification)</span></span>
<span>    <span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="va">beta_hat</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Compute metrics</span></span>
<span>    <span class="va">bias</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span></span>
<span>    <span class="va">rmse</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">max_abs</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">cs1_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">cs1_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      cell <span class="op">=</span> <span class="va">i</span>, rep <span class="op">=</span> <span class="va">r</span>,</span>
<span>      model <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">model</span>, target_rho <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">target_rho</span>,</span>
<span>      bias_beta <span class="op">=</span> <span class="va">bias</span>, rmse_beta <span class="op">=</span> <span class="va">rmse</span>,</span>
<span>      max_abs_err <span class="op">=</span> <span class="va">max_abs</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregate results</span></span>
<span><span class="va">cs1_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bias_beta</span>, <span class="va">rmse_beta</span>, <span class="va">max_abs_err</span><span class="op">)</span> <span class="op">~</span> <span class="va">model</span> <span class="op">+</span> <span class="va">target_rho</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cs1_results</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cs1_summary</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean_bias"</span>, <span class="st">"mean_RMSE"</span>, <span class="st">"mean_max_err"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display as formatted table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Case Study 1: Model Comparison Results\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Case Study 1: Model Comparison Results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=======================================\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; =======================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cs1_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;   model target_rho mean_bias mean_RMSE mean_max_err</span></span>
<span><span class="co">#&gt; 1   2pl        0.6         0    0.4270       1.1453</span></span>
<span><span class="co">#&gt; 2 rasch        0.6         0    0.3416       0.9530</span></span>
<span><span class="co">#&gt; 3   2pl        0.7         0    0.3267       0.8271</span></span>
<span><span class="co">#&gt; 4 rasch        0.7         0    0.2662       0.7510</span></span>
<span><span class="co">#&gt; 5   2pl        0.8         0    0.2266       0.5677</span></span>
<span><span class="co">#&gt; 6 rasch        0.8         0    0.1690       0.4455</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract per-model data for plotting</span></span>
<span><span class="va">rasch_data</span> <span class="op">&lt;-</span> <span class="va">cs1_results</span><span class="op">[</span><span class="va">cs1_results</span><span class="op">$</span><span class="va">model</span> <span class="op">==</span> <span class="st">"rasch"</span>, <span class="op">]</span></span>
<span><span class="va">twopl_data</span> <span class="op">&lt;-</span> <span class="va">cs1_results</span><span class="op">[</span><span class="va">cs1_results</span><span class="op">$</span><span class="va">model</span> <span class="op">==</span> <span class="st">"2pl"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rasch_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">rmse_beta</span> <span class="op">~</span> <span class="va">target_rho</span>, data <span class="op">=</span> <span class="va">rasch_data</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">twopl_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">rmse_beta</span> <span class="op">~</span> <span class="va">target_rho</span>, data <span class="op">=</span> <span class="va">twopl_data</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">rasch_sd</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">rmse_beta</span> <span class="op">~</span> <span class="va">target_rho</span>, data <span class="op">=</span> <span class="va">rasch_data</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">twopl_sd</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">rmse_beta</span> <span class="op">~</span> <span class="va">target_rho</span>, data <span class="op">=</span> <span class="va">twopl_data</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rho_levels</span> <span class="op">&lt;-</span> <span class="va">rasch_mean</span><span class="op">$</span><span class="va">target_rho</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">yrange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rasch_mean</span><span class="op">$</span><span class="va">rmse_beta</span> <span class="op">-</span> <span class="va">rasch_sd</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>                   <span class="va">twopl_mean</span><span class="op">$</span><span class="va">rmse_beta</span> <span class="op">+</span> <span class="va">twopl_sd</span><span class="op">$</span><span class="va">rmse_beta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yrange</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">yrange</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">yrange</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">yrange</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fl">1.2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rho_levels</span> <span class="op">-</span> <span class="fl">0.005</span>, <span class="va">rasch_mean</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="va">yrange</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Target Reliability"</span>, ylab <span class="op">=</span> <span class="st">"Mean RMSE (Difficulty)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Case Study 1: Model Comparison Under Controlled Reliability"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Error bars for Rasch</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">rho_levels</span> <span class="op">-</span> <span class="fl">0.005</span>,</span>
<span>       <span class="va">rasch_mean</span><span class="op">$</span><span class="va">rmse_beta</span> <span class="op">-</span> <span class="va">rasch_sd</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>       <span class="va">rho_levels</span> <span class="op">-</span> <span class="fl">0.005</span>,</span>
<span>       <span class="va">rasch_mean</span><span class="op">$</span><span class="va">rmse_beta</span> <span class="op">+</span> <span class="va">rasch_sd</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>       angle <span class="op">=</span> <span class="fl">90</span>, code <span class="op">=</span> <span class="fl">3</span>, length <span class="op">=</span> <span class="fl">0.05</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">rho_levels</span> <span class="op">+</span> <span class="fl">0.005</span>, <span class="va">twopl_mean</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>, col <span class="op">=</span> <span class="st">"coral"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Error bars for 2PL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">rho_levels</span> <span class="op">+</span> <span class="fl">0.005</span>,</span>
<span>       <span class="va">twopl_mean</span><span class="op">$</span><span class="va">rmse_beta</span> <span class="op">-</span> <span class="va">twopl_sd</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>       <span class="va">rho_levels</span> <span class="op">+</span> <span class="fl">0.005</span>,</span>
<span>       <span class="va">twopl_mean</span><span class="op">$</span><span class="va">rmse_beta</span> <span class="op">+</span> <span class="va">twopl_sd</span><span class="op">$</span><span class="va">rmse_beta</span>,</span>
<span>       angle <span class="op">=</span> <span class="fl">90</span>, code <span class="op">=</span> <span class="fl">3</span>, length <span class="op">=</span> <span class="fl">0.05</span>, col <span class="op">=</span> <span class="st">"coral"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rasch"</span>, <span class="st">"2PL"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"coral"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">17</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cs1-plot-1.png" class="r-plt" alt="Difficulty RMSE by model and target reliability. When reliability is controlled, the comparison isolates the effect of model structure on parameter recovery. Error bars show the range across replications." width="85%"><p class="caption">
Difficulty RMSE by model and target reliability. When reliability is
controlled, the comparison isolates the effect of model structure on
parameter recovery. Error bars show the range across replications.
</p>
</div>
</div>
<div class="section level3">
<h3 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h3>
<p>With reliability held constant, any remaining difference in RMSE
between models is attributable to the structural difference between
Rasch and 2PL data-generating processes—not to differing data quality.
Several patterns emerge:</p>
<ul>
<li><p><strong>Higher reliability leads to smaller RMSE</strong> for
both models, as expected. Better data quality (higher signal-to-noise
ratio) improves parameter recovery.</p></li>
<li><p><strong>Model differences are modest</strong> when reliability is
held constant. Without reliability control, the 2PL model often appears
to have worse difficulty recovery, but much of that apparent difference
vanishes once reliability is equalized.</p></li>
<li><p><strong>The critical role of controlling reliability</strong>:
the differences within a model across reliability levels are typically
larger than the differences between models at a fixed reliability
level.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="methods-text">Methods text<a class="anchor" aria-label="anchor" href="#methods-text"></a>
</h3>
<blockquote>
<p>We compared Rasch and 2PL item difficulty recovery under controlled
reliability using the IRTsimrel R package (Lee, 2025). For each of six
conditions (2 models x 3 target reliabilities: 0.60, 0.70, 0.80), item
discriminations were calibrated to the target average-information
reliability using EQC with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M = 10{,}000</annotation></semantics></math>
quadrature points. Tests comprised
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">I = 20</annotation></semantics></math>
items with normally distributed difficulties. For each condition,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">R = 500</annotation></semantics></math>
replications of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">N = 1{,}000</annotation></semantics></math>
simulees were generated. Item difficulties were estimated via maximum
marginal likelihood and evaluated via bias and RMSE. The maximum
calibration error across conditions was less than 0.001.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="case-study-2-latent-distribution-robustness">Case Study 2: Latent Distribution Robustness<a class="anchor" aria-label="anchor" href="#case-study-2-latent-distribution-robustness"></a>
</h2>
<div class="section level3">
<h3 id="research-question-1">Research question<a class="anchor" aria-label="anchor" href="#research-question-1"></a>
</h3>
<blockquote>
<p>How does latent distribution misspecification affect item parameter
recovery when the test was calibrated for reliability under
normality?</p>
</blockquote>
<p>This study investigates what happens when data are generated from a
distribution that differs from the one used during reliability
calibration. In practice, test developers often assume normality when
calibrating items, but the actual examinee population may be skewed,
bimodal, or heavy-tailed.</p>
</div>
<div class="section level3">
<h3 id="design-1">Design<a class="anchor" aria-label="anchor" href="#design-1"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Component</th>
<th align="left">Specification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Calibration shape</td>
<td align="left">Normal</td>
</tr>
<tr class="even">
<td align="left">Generating shapes</td>
<td align="left">Normal, skew_pos, bimodal, heavy_tail</td>
</tr>
<tr class="odd">
<td align="left">Target reliability</td>
<td align="left">0.80 (calibrated under normal)</td>
</tr>
<tr class="even">
<td align="left">Test length</td>
<td align="left">20 items</td>
</tr>
<tr class="odd">
<td align="left">N persons</td>
<td align="left">300</td>
</tr>
<tr class="even">
<td align="left">Replications</td>
<td align="left">5 (use 500+ in practice)</td>
</tr>
</tbody>
</table>
<p><strong>Key insight</strong>: When you calibrate under one
distribution but generate under another, the achieved reliability will
differ from the target because the test information profile interacts
with the latent distribution.</p>
</div>
<div class="section level3">
<h3 id="step-1-calibrate-under-normal">Step 1: Calibrate under normal<a class="anchor" aria-label="anchor" href="#step-1-calibrate-under-normal"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs2_calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho   <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>  M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated c* = %.4f (under normal, rho = %.4f)\n"</span>,</span>
<span>            <span class="va">cs2_calib</span><span class="op">$</span><span class="va">c_star</span>, <span class="va">cs2_calib</span><span class="op">$</span><span class="va">achieved_rho</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calibrated c* = 1.0183 (under normal, rho = 0.8000)</span></span>
<span></span>
<span><span class="va">gen_shapes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"skew_pos"</span>, <span class="st">"bimodal"</span>, <span class="st">"heavy_tail"</span><span class="op">)</span></span>
<span><span class="va">n_items</span>   <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">n_persons</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-compute-actual-reliability-under-each-generating-distribution">Step 2: Compute actual reliability under each generating
distribution<a class="anchor" aria-label="anchor" href="#step-2-compute-actual-reliability-under-each-generating-distribution"></a>
</h3>
<p>Before running the full simulation, we can compute the theoretical
reliability under each generating distribution using the calibrated item
parameters. This uses <code><a href="../reference/compute_rho_bar.html">compute_rho_tilde()</a></code> with theta
samples from each distribution, providing the theoretical prediction of
how reliability shifts.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute reliability under each generating distribution</span></span>
<span><span class="va">actual_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gen_shapes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">actual_rho</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">gen_shapes</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">gen_shapes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">theta_check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_latentG.html">sim_latentG</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5000</span>, shape <span class="op">=</span> <span class="va">gen_shapes</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span></span>
<span>  <span class="va">actual_rho</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_rho_bar.html">compute_rho_tilde</a></span><span class="op">(</span></span>
<span>    c         <span class="op">=</span> <span class="va">cs2_calib</span><span class="op">$</span><span class="va">c_star</span>,</span>
<span>    theta_vec <span class="op">=</span> <span class="va">theta_check</span>,</span>
<span>    beta_vec  <span class="op">=</span> <span class="va">cs2_calib</span><span class="op">$</span><span class="va">beta_vec</span>,</span>
<span>    lambda_base <span class="op">=</span> <span class="va">cs2_calib</span><span class="op">$</span><span class="va">lambda_base</span>,</span>
<span>    theta_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">theta_check</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rho_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gen_shape    <span class="op">=</span> <span class="va">gen_shapes</span>,</span>
<span>  target_rho   <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  actual_rho   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">actual_rho</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  rho_shift    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">actual_rho</span> <span class="op">-</span> <span class="fl">0.80</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Reliability under each generating distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reliability under each generating distribution:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rho_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;             gen_shape target_rho actual_rho rho_shift</span></span>
<span><span class="co">#&gt; normal         normal        0.8     0.8000    0.0000</span></span>
<span><span class="co">#&gt; skew_pos     skew_pos        0.8     0.8004    0.0004</span></span>
<span><span class="co">#&gt; bimodal       bimodal        0.8     0.7962   -0.0038</span></span>
<span><span class="co">#&gt; heavy_tail heavy_tail        0.8     0.8001    0.0001</span></span></code></pre></div>
<p>The reliability shifts when the generating distribution differs from
the calibration distribution. This shift arises because the test
information function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝒥</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>;</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{J}(\theta; c^*)</annotation></semantics></math>
is not uniform across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
so different latent distributions weight the information
differently.</p>
</div>
<div class="section level3">
<h3 id="step-3-run-replications-1">Step 3: Run replications<a class="anchor" aria-label="anchor" href="#step-3-run-replications-1"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs2_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gen_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  bias_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>, rmse_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mean_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">gen_shapes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>      result       <span class="op">=</span> <span class="va">cs2_calib</span>,</span>
<span>      n_persons    <span class="op">=</span> <span class="va">n_persons</span>,</span>
<span>      latent_shape <span class="op">=</span> <span class="va">gen_shapes</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      seed         <span class="op">=</span> <span class="fl">2000</span> <span class="op">*</span> <span class="va">j</span> <span class="op">+</span> <span class="va">r</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span></span>
<span>    <span class="va">p_items</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span></span>
<span>    <span class="va">p_items</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">p_items</span>, <span class="fl">0.001</span><span class="op">)</span>, <span class="fl">0.999</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span>  <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p_items</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_items</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span>  <span class="op">&lt;-</span> <span class="va">beta_hat</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span></span>
<span>    <span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">cs2_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">cs2_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      gen_shape <span class="op">=</span> <span class="va">gen_shapes</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, rep <span class="op">=</span> <span class="va">r</span>,</span>
<span>      bias_beta <span class="op">=</span> <span class="va">bias</span>, rmse_beta <span class="op">=</span> <span class="va">rmse</span>,</span>
<span>      mean_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results-1">Results<a class="anchor" aria-label="anchor" href="#results-1"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs2_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bias_beta</span>, <span class="va">rmse_beta</span>, <span class="va">mean_p</span><span class="op">)</span> <span class="op">~</span> <span class="va">gen_shape</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cs2_results</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cs2_summary</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean_bias"</span>, <span class="st">"mean_RMSE"</span>, <span class="st">"mean_prop_correct"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add actual reliability</span></span>
<span><span class="va">cs2_summary</span><span class="op">$</span><span class="va">actual_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">actual_rho</span><span class="op">[</span><span class="va">cs2_summary</span><span class="op">$</span><span class="va">gen_shape</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">cs2_summary</span><span class="op">$</span><span class="va">rho_shift</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">actual_rho</span><span class="op">[</span><span class="va">cs2_summary</span><span class="op">$</span><span class="va">gen_shape</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.80</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reorder columns for clarity</span></span>
<span><span class="va">cs2_summary</span> <span class="op">&lt;-</span> <span class="va">cs2_summary</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gen_shape"</span>, <span class="st">"actual_rho"</span>, <span class="st">"rho_shift"</span>,</span>
<span>                                 <span class="st">"mean_bias"</span>, <span class="st">"mean_RMSE"</span>, <span class="st">"mean_prop_correct"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Case Study 2: Latent Distribution Robustness Results\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Case Study 2: Latent Distribution Robustness Results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"====================================================\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cs2_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;    gen_shape actual_rho rho_shift mean_bias mean_RMSE mean_prop_correct</span></span>
<span><span class="co">#&gt; 1    bimodal     0.7962   -0.0038         0    0.1493            0.5019</span></span>
<span><span class="co">#&gt; 2 heavy_tail     0.8001    0.0001         0    0.1481            0.4934</span></span>
<span><span class="co">#&gt; 3     normal     0.8000    0.0000         0    0.1756            0.5025</span></span>
<span><span class="co">#&gt; 4   skew_pos     0.8004    0.0004         0    0.1411            0.4867</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Panel 1: Reliability shift</span></span>
<span><span class="va">bar_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"coral"</span>, <span class="st">"seagreen"</span>, <span class="st">"orchid"</span><span class="op">)</span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">actual_rho</span>, col <span class="op">=</span> <span class="va">bar_colors</span>,</span>
<span>              ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Achieved Reliability"</span>,</span>
<span>              main <span class="op">=</span> <span class="st">"Actual Reliability Under Each Generating Distribution"</span>,</span>
<span>              names.arg <span class="op">=</span> <span class="va">gen_shapes</span>, las <span class="op">=</span> <span class="fl">1</span>, cex.names <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.80</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">bp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">0.82</span>, <span class="st">"Target = 0.80"</span>, col <span class="op">=</span> <span class="st">"red"</span>, adj <span class="op">=</span> <span class="fl">0</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add value labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">bp</span>, <span class="va">actual_rho</span> <span class="op">+</span> <span class="fl">0.02</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">actual_rho</span>, <span class="fl">3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Panel 2: RMSE</span></span>
<span><span class="va">rmse_vals</span> <span class="op">&lt;-</span> <span class="va">cs2_summary</span><span class="op">$</span><span class="va">mean_RMSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rmse_vals</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">cs2_summary</span><span class="op">$</span><span class="va">gen_shape</span></span>
<span><span class="va">bp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">rmse_vals</span>, col <span class="op">=</span> <span class="va">bar_colors</span>,</span>
<span>               ylab <span class="op">=</span> <span class="st">"Mean RMSE (Difficulty)"</span>,</span>
<span>               main <span class="op">=</span> <span class="st">"Difficulty RMSE by Generating Distribution"</span>,</span>
<span>               las <span class="op">=</span> <span class="fl">1</span>, cex.names <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add value labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">bp2</span>, <span class="va">rmse_vals</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rmse_vals</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.03</span>,</span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rmse_vals</span>, <span class="fl">3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cs2-plot-1.png" class="r-plt" alt="Impact of latent distribution misspecification. Top: actual reliability shifts away from the 0.80 target under non-normal generation. Bottom: difficulty RMSE varies with generating shape, driven partly by the reliability shift." width="85%"><p class="caption">
Impact of latent distribution misspecification. Top: actual reliability
shifts away from the 0.80 target under non-normal generation. Bottom:
difficulty RMSE varies with generating shape, driven partly by the
reliability shift.
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpretation-1">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation-1"></a>
</h3>
<p>When the generating distribution does not match the calibration
distribution, two things happen:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Reliability shifts</strong>: the actual reliability
deviates from the target (sometimes higher, sometimes lower), depending
on how the test information profile aligns with the new
distribution.</p></li>
<li><p><strong>Recovery accuracy changes</strong>: RMSE is partly driven
by the reliability shift and partly by the distribution’s effect on the
information profile at each ability level.</p></li>
</ol>
<p>Key findings:</p>
<ul>
<li><p><strong>Normal</strong> (matched condition): reliability is at
the target, and RMSE serves as the baseline.</p></li>
<li><p><strong>Positively skewed</strong>: more examinees are located in
the left tail where item information may be lower for items centered
near
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta = 0</annotation></semantics></math>.</p></li>
<li><p><strong>Bimodal</strong>: two modes create regions of low density
near
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\theta = 0</annotation></semantics></math>
where most items provide maximal information, potentially reducing
effective information utilization.</p></li>
<li><p><strong>Heavy-tailed</strong>: extreme ability values fall in
regions of very low item information, reducing the harmonic mean of
information.</p></li>
</ul>
<p>This demonstrates why it is critical to either (a) calibrate under
the intended generating distribution, or (b) report the actual achieved
reliability under the generating distribution when intentionally
mismatching.</p>
</div>
<div class="section level3">
<h3 id="methods-text-1">Methods text<a class="anchor" aria-label="anchor" href="#methods-text-1"></a>
</h3>
<blockquote>
<p>To assess robustness to latent distribution misspecification, we
calibrated item parameters to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>*</mo></msup><mo>=</mo><mn>0.80</mn></mrow><annotation encoding="application/x-tex">\tilde{\rho}^* = 0.80</annotation></semantics></math>
under a normal latent distribution using EQC
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>10</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">M = 10{,}000</annotation></semantics></math>;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">I = 20</annotation></semantics></math>
Rasch items). Response data were then generated under four
distributions: normal, positively skewed (Gamma,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k = 4</annotation></semantics></math>),
bimodal
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">\delta = 0.8</annotation></semantics></math>),
and heavy-tailed (Student-t,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">df = 5</annotation></semantics></math>),
all pre-standardized to mean 0 and variance 1. For each generating
condition,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">R = 500</annotation></semantics></math>
replications of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">N = 1{,}000</annotation></semantics></math>
simulees were generated. We report both the theoretical reliability
under each generating distribution and the difficulty recovery RMSE.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="case-study-3-sample-size-planning">Case Study 3: Sample Size Planning<a class="anchor" aria-label="anchor" href="#case-study-3-sample-size-planning"></a>
</h2>
<div class="section level3">
<h3 id="research-question-2">Research question<a class="anchor" aria-label="anchor" href="#research-question-2"></a>
</h3>
<blockquote>
<p>What minimum sample size is needed for stable item difficulty
recovery at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>=</mo><mn>0.80</mn></mrow><annotation encoding="application/x-tex">\tilde{\rho} = 0.80</annotation></semantics></math>?</p>
</blockquote>
<p>This study varies sample size while holding all other factors
constant, producing an RMSE-vs-N curve that identifies the point of
diminishing returns. This is a fundamental practical question: how many
examinees are needed to achieve adequate parameter recovery?</p>
</div>
<div class="section level3">
<h3 id="design-2">Design<a class="anchor" aria-label="anchor" href="#design-2"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Factor</th>
<th align="left">Specification</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Sample size</td>
<td align="left">50, 100, 200, 500</td>
</tr>
<tr class="even">
<td align="left">Model</td>
<td align="left">Rasch</td>
</tr>
<tr class="odd">
<td align="left">Reliability</td>
<td align="left">0.80</td>
</tr>
<tr class="even">
<td align="left">Test length</td>
<td align="left">20 items</td>
</tr>
<tr class="odd">
<td align="left">Replications</td>
<td align="left">5 (use 500+ in practice)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="step-1-calibrate-once">Step 1: Calibrate once<a class="anchor" aria-label="anchor" href="#step-1-calibrate-once"></a>
</h3>
<p>Since reliability and all other factors are held constant, we
calibrate only once. The same calibrated parameters are used for all
sample sizes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs3_calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho   <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items      <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  model        <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>  M            <span class="op">=</span> <span class="fl">5000L</span>,</span>
<span>  seed         <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated c* = %.4f, achieved rho = %.4f\n"</span>,</span>
<span>            <span class="va">cs3_calib</span><span class="op">$</span><span class="va">c_star</span>, <span class="va">cs3_calib</span><span class="op">$</span><span class="va">achieved_rho</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calibrated c* = 1.0183, achieved rho = 0.8000</span></span>
<span></span>
<span><span class="va">sample_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-run-replications">Step 2: Run replications<a class="anchor" aria-label="anchor" href="#step-2-run-replications"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs3_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  n_persons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>, rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rmse_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>, bias_beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_abs_err <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sample_sizes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">sample_sizes</span><span class="op">[</span><span class="va">n_idx</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>      result    <span class="op">=</span> <span class="va">cs3_calib</span>,</span>
<span>      n_persons <span class="op">=</span> <span class="va">N</span>,</span>
<span>      seed      <span class="op">=</span> <span class="fl">3000</span> <span class="op">*</span> <span class="va">n_idx</span> <span class="op">+</span> <span class="va">r</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span></span>
<span>    <span class="va">p_items</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span></span>
<span>    <span class="va">p_items</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">p_items</span>, <span class="fl">0.001</span><span class="op">)</span>, <span class="fl">0.999</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span>  <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p_items</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_items</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span>  <span class="op">&lt;-</span> <span class="va">beta_hat</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">bias</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span></span>
<span>    <span class="va">rmse</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">max_abs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">cs3_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">cs3_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      n_persons <span class="op">=</span> <span class="va">N</span>, rep <span class="op">=</span> <span class="va">r</span>,</span>
<span>      rmse_beta <span class="op">=</span> <span class="va">rmse</span>, bias_beta <span class="op">=</span> <span class="va">bias</span>,</span>
<span>      max_abs_err <span class="op">=</span> <span class="va">max_abs</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results-2">Results<a class="anchor" aria-label="anchor" href="#results-2"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs3_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">bias_beta</span>, <span class="va">rmse_beta</span>, <span class="va">max_abs_err</span><span class="op">)</span> <span class="op">~</span> <span class="va">n_persons</span>,</span>
<span>  data <span class="op">=</span> <span class="va">cs3_results</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cs3_summary</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean_bias"</span>, <span class="st">"mean_RMSE"</span>, <span class="st">"mean_max_err"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add SD of RMSE across reps</span></span>
<span><span class="va">cs3_rmse_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">rmse_beta</span> <span class="op">~</span> <span class="va">n_persons</span>, data <span class="op">=</span> <span class="va">cs3_results</span>, FUN <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">cs3_summary</span><span class="op">$</span><span class="va">sd_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cs3_rmse_sd</span><span class="op">$</span><span class="va">rmse_beta</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Case Study 3: Sample Size Planning Results\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Case Study 3: Sample Size Planning Results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"============================================\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ============================================</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cs3_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;   n_persons mean_bias mean_RMSE mean_max_err sd_RMSE</span></span>
<span><span class="co">#&gt; 1        50         0    0.2843       0.5970  0.0283</span></span>
<span><span class="co">#&gt; 2       100         0    0.1867       0.4264  0.0194</span></span>
<span><span class="co">#&gt; 3       200         0    0.1906       0.4914  0.0208</span></span>
<span><span class="co">#&gt; 4       500         0    0.1315       0.3336  0.0277</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data</span></span>
<span><span class="va">N_vals</span> <span class="op">&lt;-</span> <span class="va">cs3_summary</span><span class="op">$</span><span class="va">n_persons</span></span>
<span><span class="va">rmse_mean</span> <span class="op">&lt;-</span> <span class="va">cs3_summary</span><span class="op">$</span><span class="va">mean_RMSE</span></span>
<span><span class="va">rmse_sd</span>   <span class="op">&lt;-</span> <span class="va">cs3_summary</span><span class="op">$</span><span class="va">sd_RMSE</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">N_vals</span>, <span class="va">rmse_mean</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Sample Size (N)"</span>, ylab <span class="op">=</span> <span class="st">"Mean RMSE (Difficulty)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Case Study 3: RMSE vs. Sample Size at Fixed Reliability"</span>,</span>
<span>     log <span class="op">=</span> <span class="st">"x"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rmse_mean</span> <span class="op">+</span> <span class="va">rmse_sd</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Shaded confidence region</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N_vals</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">N_vals</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rmse_mean</span> <span class="op">-</span> <span class="va">rmse_sd</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">rmse_mean</span> <span class="op">+</span> <span class="va">rmse_sd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, alpha.f <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Re-draw line on top</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">N_vals</span>, <span class="va">rmse_mean</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add reference line at N = 200</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">200</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rmse_mean</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.95</span>, <span class="st">"N = 200"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pos <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add value labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">N_vals</span>, <span class="va">rmse_mean</span> <span class="op">+</span> <span class="va">rmse_sd</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rmse_mean</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.05</span>,</span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rmse_mean</span>, <span class="fl">3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-studies_files/figure-html/cs3-plot-1.png" class="r-plt" alt="Difficulty RMSE as a function of sample size at fixed reliability (rho = 0.80). RMSE decreases monotonically with N. The shaded region shows plus/minus one standard deviation across replications." width="85%"><p class="caption">
Difficulty RMSE as a function of sample size at fixed reliability (rho =
0.80). RMSE decreases monotonically with N. The shaded region shows
plus/minus one standard deviation across replications.
</p>
</div>
</div>
<div class="section level3">
<h3 id="rmse-scaling-analysis">RMSE scaling analysis<a class="anchor" aria-label="anchor" href="#rmse-scaling-analysis"></a>
</h3>
<p>Theoretical prediction: under regularity conditions, RMSE should
scale approximately as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msqrt><mi>N</mi></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(1/\sqrt{N})</annotation></semantics></math>.
We can check this by examining the ratio of RMSE values:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check the O(1/sqrt(N)) scaling</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Theoretical RMSE scaling check:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Theoretical RMSE scaling check:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"If RMSE ~ 1/sqrt(N), then RMSE * sqrt(N) should be constant.\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; If RMSE ~ 1/sqrt(N), then RMSE * sqrt(N) should be constant.</span></span>
<span></span>
<span><span class="va">cs3_summary</span><span class="op">$</span><span class="va">rmse_x_sqrtN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cs3_summary</span><span class="op">$</span><span class="va">mean_RMSE</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">cs3_summary</span><span class="op">$</span><span class="va">n_persons</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cs3_summary</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_persons"</span>, <span class="st">"mean_RMSE"</span>, <span class="st">"rmse_x_sqrtN"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   n_persons mean_RMSE rmse_x_sqrtN</span></span>
<span><span class="co">#&gt; 1        50    0.2843       2.0103</span></span>
<span><span class="co">#&gt; 2       100    0.1867       1.8670</span></span>
<span><span class="co">#&gt; 3       200    0.1906       2.6955</span></span>
<span><span class="co">#&gt; 4       500    0.1315       2.9404</span></span></code></pre></div>
<p>If the product RMSE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo><msqrt><mi>N</mi></msqrt></mrow><annotation encoding="application/x-tex">\times \sqrt{N}</annotation></semantics></math>
is approximately constant across sample sizes, it confirms the expected
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msqrt><mi>N</mi></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(1/\sqrt{N})</annotation></semantics></math>
scaling.</p>
</div>
<div class="section level3">
<h3 id="practical-recommendation">Practical recommendation<a class="anchor" aria-label="anchor" href="#practical-recommendation"></a>
</h3>
<p>The RMSE decreases with sample size but exhibits diminishing returns.
Based on this analysis:</p>
<ul>
<li><p><strong>N &lt; 100</strong>: RMSE is high and variable;
difficulty estimates are unreliable for individual items. The maximum
absolute error may exceed 0.50 logits.</p></li>
<li><p><strong>N = 200</strong>: a reasonable minimum for stable
difficulty recovery at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>=</mo><mn>0.80</mn></mrow><annotation encoding="application/x-tex">\tilde{\rho} = 0.80</annotation></semantics></math>
with 20 Rasch items. RMSE stabilizes at a tolerable level for most
applications.</p></li>
<li><p><strong>N &gt;= 500</strong>: marginal improvement is small
relative to the increased data collection cost. Recommended only for
high-precision applications.</p></li>
</ul>
<p>For studies that require difficulty recovery within a specified
tolerance (e.g., RMSE &lt; 0.20), the researcher can read the required N
directly from the RMSE curve. Different reliability levels will shift
the curve vertically: lower reliability requires larger N for the same
RMSE.</p>
</div>
<div class="section level3">
<h3 id="methods-text-2">Methods text<a class="anchor" aria-label="anchor" href="#methods-text-2"></a>
</h3>
<blockquote>
<p>To determine the minimum sample size for stable item difficulty
recovery, we calibrated a 20-item Rasch test to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>ρ</mi><mo accent="true">̃</mo></mover><mo>*</mo></msup><mo>=</mo><mn>0.80</mn></mrow><annotation encoding="application/x-tex">\tilde{\rho}^* = 0.80</annotation></semantics></math>
using EQC. Response data were generated for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>50</mn><mo>,</mo><mn>100</mn><mo>,</mo><mn>200</mn><mo>,</mo><mn>500</mn><mo>,</mo><mn>1000</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">N \in \{50, 100, 200, 500, 1000\}</annotation></semantics></math>
simulees across
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">R = 500</annotation></semantics></math>
replications per condition. Item difficulties were estimated via maximum
marginal likelihood and evaluated by RMSE. Diminishing returns in RMSE
were observed beyond
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">N = 200</annotation></semantics></math>,
which we recommend as the minimum sample size for this
configuration.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="adapt-for-your-study">Adapt for Your Study<a class="anchor" aria-label="anchor" href="#adapt-for-your-study"></a>
</h2>
<p>The three case studies above are templates. To adapt them for your
research, follow the planning and reporting checklists below.</p>
<div class="section level3">
<h3 id="planning-checklist">Planning checklist<a class="anchor" aria-label="anchor" href="#planning-checklist"></a>
</h3>
<p>Before running your study, verify the following:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Define the research question</strong> clearly and
precisely. The question should specify what comparison is being made and
what metrics will be used to evaluate it.</p></li>
<li><p><strong>Select the IRT model(s)</strong> appropriate for your
context. Use <code>"rasch"</code> for tests with equal discriminations
and <code>"2pl"</code> for tests with varying discriminations.</p></li>
<li><p><strong>Choose the latent distribution(s)</strong> that represent
your target population. Use <code>"normal"</code> as a baseline and add
non-normal shapes to test robustness.</p></li>
<li><p><strong>Set target reliability levels</strong> that span the
range relevant to your application. Include at least three levels to
detect nonlinear effects.</p></li>
<li><p><strong>Screen all design cells</strong> for feasibility using
<code><a href="../reference/check_feasibility.html">check_feasibility()</a></code>. Remove or modify any infeasible
cells.</p></li>
<li><p><strong>Determine the number of replications.</strong> For
published work,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>≥</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">R \geq 500</annotation></semantics></math>
is standard. For pilot studies,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">R = 100</annotation></semantics></math>
may suffice.</p></li>
<li><p><strong>Establish a seed management scheme</strong> for complete
reproducibility. Record all seeds in your analysis script.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="template-code">Template code<a class="anchor" aria-label="anchor" href="#template-code"></a>
</h3>
<p>The following template can be adapted for any simulation study using
IRTsimrel. Replace the bracketed comments with your study’s
parameters.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># =============================================================</span></span>
<span><span class="co"># IRTsimrel Simulation Study Template</span></span>
<span><span class="co"># =============================================================</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Research Question:</span></span>
<span><span class="co">#   [State your research question here]</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Author: [Your name]</span></span>
<span><span class="co"># Date:   [Date]</span></span>
<span><span class="co"># =============================================================</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joonho112/IRTsimrel" class="external-link">IRTsimrel</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- 1. Design ----</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  target_rho   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">0.70</span>, <span class="fl">0.80</span><span class="op">)</span>,      <span class="co"># [your reliability levels]</span></span>
<span>  n_items      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,                  <span class="co"># [your test lengths]</span></span>
<span>  model        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rasch"</span>, <span class="st">"2pl"</span><span class="op">)</span>,          <span class="co"># [your models]</span></span>
<span>  latent_shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"skew_pos"</span><span class="op">)</span>,    <span class="co"># [your latent shapes]</span></span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">N_PERSONS</span>  <span class="op">&lt;-</span> <span class="fl">1000</span>     <span class="co"># [your sample size]</span></span>
<span><span class="va">R</span>          <span class="op">&lt;-</span> <span class="fl">500</span>      <span class="co"># [your replications]</span></span>
<span><span class="va">M_QUAD</span>     <span class="op">&lt;-</span> <span class="fl">10000L</span>   <span class="co"># [your quadrature size]</span></span>
<span><span class="va">CALIB_SEED</span> <span class="op">&lt;-</span> <span class="fl">42</span>       <span class="co"># [your calibration seed]</span></span>
<span></span>
<span><span class="co"># ---- 2. Feasibility screening ----</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">feas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_feasibility.html">check_feasibility</a></span><span class="op">(</span></span>
<span>    n_items      <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">n_items</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">model</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">latent_shape</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M            <span class="op">=</span> <span class="va">M_QUAD</span>,</span>
<span>    seed         <span class="op">=</span> <span class="va">CALIB_SEED</span>,</span>
<span>    verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">design</span><span class="op">$</span><span class="va">feasible</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">$</span><span class="va">target_rho</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span></span>
<span>                         <span class="va">design</span><span class="op">$</span><span class="va">target_rho</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">feas</span><span class="op">$</span><span class="va">rho_range_info</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">[</span><span class="va">design</span><span class="op">$</span><span class="va">feasible</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Feasible cells: %d\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- 3. Calibration ----</span></span>
<span><span class="va">calib_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">calib_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho   <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">target_rho</span>,</span>
<span>    n_items      <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">n_items</span>,</span>
<span>    model        <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">model</span>,</span>
<span>    latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>    item_source  <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>    M            <span class="op">=</span> <span class="va">M_QUAD</span>,</span>
<span>    seed         <span class="op">=</span> <span class="va">CALIB_SEED</span>,</span>
<span>    verbose      <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ---- 4. Verification ----</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">achieved_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">calib_list</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="va">r</span><span class="op">$</span><span class="va">achieved_rho</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">abs_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">achieved_rho</span> <span class="op">-</span> <span class="va">design</span><span class="op">$</span><span class="va">target_rho</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Max calibration error: %.2e\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">abs_error</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- 5. Simulation loop ----</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>      result       <span class="op">=</span> <span class="va">calib_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      n_persons    <span class="op">=</span> <span class="va">N_PERSONS</span>,</span>
<span>      latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>      seed         <span class="op">=</span> <span class="fl">1000</span> <span class="op">*</span> <span class="va">i</span> <span class="op">+</span> <span class="va">r</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="co"># ---- Your analysis here ----</span></span>
<span>    <span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">$</span><span class="va">beta</span></span>
<span>    <span class="va">p_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">response_matrix</span><span class="op">)</span></span>
<span>    <span class="va">p_items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">p_items</span>, <span class="fl">0.001</span><span class="op">)</span>, <span class="fl">0.999</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p_items</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_items</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="va">beta_hat</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span><span class="op">)</span></span>
<span>    <span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">beta_hat</span> <span class="op">-</span> <span class="va">beta_true</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">output</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      cell <span class="op">=</span> <span class="va">i</span>, rep <span class="op">=</span> <span class="va">r</span>,</span>
<span>      target_rho <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">target_rho</span>, model <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">model</span>,</span>
<span>      n_items <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">n_items</span>, latent_shape <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">latent_shape</span>,</span>
<span>      rmse <span class="op">=</span> <span class="va">rmse</span>, bias <span class="op">=</span> <span class="va">bias</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ---- 6. Summarize ----</span></span>
<span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rmse</span>, <span class="va">bias</span><span class="op">)</span> <span class="op">~</span> <span class="va">target_rho</span> <span class="op">+</span> <span class="va">model</span> <span class="op">+</span> <span class="va">n_items</span> <span class="op">+</span> <span class="va">latent_shape</span>,</span>
<span>  data <span class="op">=</span> <span class="va">output</span>, FUN <span class="op">=</span> <span class="va">mean</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary_table</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reporting-checklist">Reporting checklist<a class="anchor" aria-label="anchor" href="#reporting-checklist"></a>
</h3>
<p>When writing up your simulation study, include the following:</p>
<ol style="list-style-type: decimal">
<li>State IRTsimrel version and cite Lee (2025).</li>
<li>Specify the calibration algorithm (EQC or SAC) and its
parameters.</li>
<li>Report the reliability metric (average-information or
MSEM-based).</li>
<li>List all target reliability levels.</li>
<li>Describe item parameter source and generation method.</li>
<li>State latent distribution(s) and shape parameters.</li>
<li>Report feasibility screening results (number screened, number
infeasible).</li>
<li>Report maximum calibration error across all cells.</li>
<li>State the number of replications and persons per replication.</li>
<li>Describe seed management for reproducibility.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="summary-and-recommendations">Summary and Recommendations<a class="anchor" aria-label="anchor" href="#summary-and-recommendations"></a>
</h2>
<p>The three case studies illustrate the following general
principles:</p>
<p><strong>Principle 1: Always control reliability.</strong> Without it,
model comparisons are confounded by data quality differences. Case Study
1 demonstrates how reliability control isolates the effect of model
structure on parameter recovery. The differences within a model across
reliability levels are often larger than the differences between models
at a fixed reliability.</p>
<p><strong>Principle 2: Document distribution mismatches.</strong> If
the calibration and generating distributions differ, report the actual
achieved reliability under the generating distribution. Case Study 2
shows that misspecification shifts both reliability and recovery
accuracy in predictable but important ways.</p>
<p><strong>Principle 3: Use RMSE curves for sample size
planning.</strong> A reliability-controlled RMSE-vs-N curve provides an
objective basis for choosing sample size. Case Study 3 demonstrates
diminishing returns beyond a minimum threshold and confirms the
theoretical
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msqrt><mi>N</mi></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(1/\sqrt{N})</annotation></semantics></math>
scaling.</p>
<p><strong>Principle 4: Start with feasibility screening.</strong>
Before committing to a large simulation, use
<code><a href="../reference/check_feasibility.html">check_feasibility()</a></code> and <code><a href="../reference/rho_curve.html">rho_curve()</a></code> to verify
that your design is achievable. Infeasible cells waste computational
resources and produce misleading boundary solutions.</p>
<p><strong>Principle 5: Report thoroughly.</strong> Follow the reporting
checklist and include a methods paragraph based on the templates
provided. Transparent reporting enables replication and builds
confidence in your findings.</p>
<p>For additional background, see:</p>
<ul>
<li>
<code><a href="../articles/introduction.html">vignette("introduction")</a></code> – package overview.</li>
<li>
<code><a href="../articles/simulation-design.html">vignette("simulation-design")</a></code> – factorial design
framework.</li>
<li>
<code><a href="../articles/algorithm-eqc.html">vignette("algorithm-eqc")</a></code> – Algorithm 1 details.</li>
<li>
<code><a href="../articles/algorithm-sac.html">vignette("algorithm-sac")</a></code> – Algorithm 2 (SAC) for
validation.</li>
<li>
<code><a href="../articles/validation.html">vignette("validation")</a></code> – TAM-based validation
procedures.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J. (2025). Reliability-targeted simulation of item response
data: Solving the inverse design problem. <em>arXiv preprint
arXiv:2512.16012</em>.</p>
<p>Robbins, H., &amp; Monro, S. (1951). A stochastic approximation
method. <em>The Annals of Mathematical Statistics, 22</em>(3),
400–407.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
