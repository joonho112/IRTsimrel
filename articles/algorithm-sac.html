<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Algorithm 2: Stochastic Approximation Calibration (SAC) ‚Ä¢ IRTsimrel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Algorithm 2: Stochastic Approximation Calibration (SAC)">
<meta name="description" content="Detailed treatment of the SAC algorithm for reliability-targeted IRT simulation, including the Robbins-Monro framework, step-size analysis, Polyak-Ruppert averaging, initialization strategies, convergence theory, and diagnostic examples.
">
<meta property="og:description" content="Detailed treatment of the SAC algorithm for reliability-targeted IRT simulation, including the Robbins-Monro framework, step-size analysis, Polyak-Ruppert averaging, initialization strategies, convergence theory, and diagnostic examples.
">
<meta property="og:image" content="https://joonho112.github.io/IRTsimrel/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IRTsimrel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/quick-start.html">Quick Start</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Applied Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/applied-guide.html">Applied Guide</a></li>
    <li><a class="dropdown-item" href="../articles/latent-distributions.html">Latent Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/item-parameters.html">Item Parameters</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-design.html">Simulation Design</a></li>
    <li><a class="dropdown-item" href="../articles/case-studies.html">Case Studies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Methodological Researchers Track</h6></li>
    <li><a class="dropdown-item" href="../articles/theory-reliability.html">Reliability Theory</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-eqc.html">Algorithm 1: EQC</a></li>
    <li><a class="dropdown-item" href="../articles/algorithm-sac.html">Algorithm 2: SAC</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Validation</a></li>
    <li><a class="dropdown-item" href="../articles/api-reference.html">API Reference</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/IRTsimrel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Algorithm 2: Stochastic Approximation Calibration (SAC)</h1>
                        <h4 data-toc-skip class="author">JoonHo Lee</h4>
            
            <h4 data-toc-skip class="date">2026-02-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/IRTsimrel/blob/main/vignettes/algorithm-sac.Rmd" class="external-link"><code>vignettes/algorithm-sac.Rmd</code></a></small>
      <div class="d-none name"><code>algorithm-sac.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joonho112/IRTsimrel" class="external-link">IRTsimrel</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Stochastic Approximation Calibration (SAC) is the secondary algorithm
in IRTsimrel, designed to complement EQC (Algorithm 1). SAC uses the
Robbins-Monro stochastic approximation framework to find the
discrimination scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
that achieves a target reliability.</p>
<p><strong>Reading time</strong>: approximately 25 minutes.</p>
<p><strong>Positioning</strong>: SAC serves primarily as a validation
companion to EQC. When both algorithms agree on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
(typically within 5%), the calibration can be trusted with high
confidence. SAC also provides trajectory-based convergence diagnostics
that EQC lacks.</p>
<p><strong>Prerequisites</strong>: Familiarity with
<code><a href="../articles/theory-reliability.html">vignette("theory-reliability")</a></code> for the mathematical
foundations. For applied workflows, see
<code><a href="../articles/introduction.html">vignette("introduction")</a></code>.</p>
<p><strong>Key references</strong>: Lee (2025, arXiv:2512.16012),
Section 2.5; Robbins and Monro (1951); Polyak and Juditsky (1992);
Kushner and Yin (2003).</p>
<div class="section level3">
<h3 id="when-to-use-sac">When to Use SAC<a class="anchor" aria-label="anchor" href="#when-to-use-sac"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Use Case</th>
<th align="left">Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Routine simulation studies</td>
<td align="left">Use EQC (faster, no tuning)</td>
</tr>
<tr class="even">
<td align="left">Independent validation of EQC</td>
<td align="left">Use SAC with EQC warm start</td>
</tr>
<tr class="odd">
<td align="left">Convergence diagnostics</td>
<td align="left">SAC provides trajectory plots</td>
</tr>
<tr class="even">
<td align="left">Research on stochastic approximation</td>
<td align="left">Use SAC</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="the-robbins-monro-framework">The Robbins-Monro Framework<a class="anchor" aria-label="anchor" href="#the-robbins-monro-framework"></a>
</h2>
<div class="section level3">
<h3 id="the-stochastic-root-finding-problem">The Stochastic Root-Finding Problem<a class="anchor" aria-label="anchor" href="#the-stochastic-root-finding-problem"></a>
</h3>
<p>SAC targets the same root-finding problem as EQC, but uses a
fundamentally different approach. The goal is to solve:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ùîº</mi><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
g(c) = \mathbb{E}\!\left[\hat{\rho}(c)\right] - \rho^* = 0
\tag{1}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">g(c) = \rho(c) - \rho^*</annotation></semantics></math>
is the reliability gap function. The key distinction from EQC is that
SAC never constructs a deterministic approximation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>.
Instead, at each iteration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>,
it observes a noisy evaluation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>Œµ</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">
Y_n = \hat{\rho}_n(c_n) = \rho(c_n) + \varepsilon_n
\tag{2}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{\rho}_n</annotation></semantics></math>
is computed from fresh Monte Carlo samples at each step, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œµ</mi><mi>n</mi></msub><annotation encoding="application/x-tex">\varepsilon_n</annotation></semantics></math>
is zero-mean noise with bounded variance:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œµ</mi><mi>n</mi></msub><mo>‚à£</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[\varepsilon_n \mid c_n] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>Œµ</mi><mi>n</mi><mn>2</mn></msubsup><mo>‚à£</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚â§</mo><msubsup><mi>œÉ</mi><mi>Œµ</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{E}[\varepsilon_n^2 \mid c_n] \leq \sigma^2_\varepsilon</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="the-robbins-monro-update-rule">The Robbins-Monro Update Rule<a class="anchor" aria-label="anchor" href="#the-robbins-monro-update-rule"></a>
</h3>
<p>The iterative update proceeds as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>Œ†</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>c</mi><mi>L</mi></msub><mo>,</mo><msub><mi>c</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></msub><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>c</mi><mi>n</mi></msub><mo>‚àí</mo><msub><mi>a</mi><mi>n</mi></msub><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
c_{n+1} = \Pi_{[c_L, c_U]}\!\left[c_n - a_n\,(\hat{\rho}_n(c_n) - \rho^*)\right]
\tag{3}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ†</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>c</mi><mi>L</mi></msub><mo>,</mo><msub><mi>c</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">[</mo><mo>‚ãÖ</mo><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\Pi_{[c_L, c_U]}[\cdot]</annotation></semantics></math>
denotes projection onto the feasible interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>c</mi><mi>L</mi></msub><mo>,</mo><msub><mi>c</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[c_L, c_U]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>n</mi></msub><annotation encoding="application/x-tex">a_n</annotation></semantics></math>
is a decreasing step size sequence.</p>
<p><strong>Intuition</strong>: When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><msup><mi>œÅ</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">\hat{\rho}_n(c_n) &gt; \rho^*</annotation></semantics></math>
(current reliability is too high), the update decreases
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>n</mi></msub><annotation encoding="application/x-tex">c_n</annotation></semantics></math>
(reducing discrimination, hence reliability). When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><msup><mi>œÅ</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">\hat{\rho}_n(c_n) &lt; \rho^*</annotation></semantics></math>,
the update increases
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>n</mi></msub><annotation encoding="application/x-tex">c_n</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="robbins-monro-conditions">Robbins-Monro Conditions<a class="anchor" aria-label="anchor" href="#robbins-monro-conditions"></a>
</h3>
<p>The step size sequence must satisfy:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>‚àû</mi><mspace width="1.0em"></mspace><mtext mathvariant="normal">and</mtext><mspace width="1.0em"></mspace><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">
\sum_{n=1}^{\infty} a_n = \infty
\quad\text{and}\quad
\sum_{n=1}^{\infty} a_n^2 &lt; \infty
\tag{4}
</annotation></semantics></math></p>
<p><strong>First condition</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ£</mi><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\Sigma a_n = \infty</annotation></semantics></math>):
Ensures the algorithm can reach any point in the parameter space,
regardless of the initial value. Without this, the total adjustment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àë</mo><msub><mi>a</mi><mi>n</mi></msub><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">\sum a_n \cdot |\hat{\rho}_n - \rho^*|</annotation></semantics></math>
might be bounded, preventing convergence from a distant starting
point.</p>
<p><strong>Second condition</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ£</mi><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\Sigma a_n^2 &lt; \infty</annotation></semantics></math>):
Controls the accumulated noise. The total noise variance is proportional
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àë</mo><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><msubsup><mi>œÉ</mi><mi>Œµ</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sum a_n^2 \sigma^2_\varepsilon</annotation></semantics></math>,
which must be finite for convergence.</p>
</div>
</div>
<div class="section level2">
<h2 id="step-size-analysis">Step Size Analysis<a class="anchor" aria-label="anchor" href="#step-size-analysis"></a>
</h2>
<div class="section level3">
<h3 id="the-step-size-sequence">The Step Size Sequence<a class="anchor" aria-label="anchor" href="#the-step-size-sequence"></a>
</h3>
<p>SAC uses the parametric family:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mfrac><mi>a</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ≥</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">
a_n = \frac{a}{(n + A)^\gamma}
\tag{5}
</annotation></semantics></math></p>
<p>with three parameters controlling different aspects of the learning
dynamics.</p>
</div>
<div class="section level3">
<h3 id="role-of-each-parameter">Role of Each Parameter<a class="anchor" aria-label="anchor" href="#role-of-each-parameter"></a>
</h3>
<p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a &gt; 0</annotation></semantics></math>
(scale constant)</strong>: Controls the overall magnitude of updates.
Larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
means more aggressive steps, leading to faster initial progress but
potentially more oscillation.</p>
<p>In the package: <code>step_params$a</code> (default: 1).</p>
<p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A \geq 0</annotation></semantics></math>
(stabilization constant)</strong>: Dampens early iterations where step
sizes would otherwise be very large
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><mi>a</mi><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ≥</mi></msup></mrow><annotation encoding="application/x-tex">a_1 = a/(1+A)^\gamma</annotation></semantics></math>).
When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A &gt; 0</annotation></semantics></math>,
the effective step size starts smaller, providing stability during the
initial transient phase. This is particularly important when
<code>c_init</code> is far from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>.</p>
<p>The package sets
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
automatically based on the burn-in fraction.</p>
<p><strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\gamma \in (1/2, 1]</annotation></semantics></math>
(decay exponent)</strong>: Controls how quickly step sizes decrease. In
the package: <code>step_params$gamma</code> (default: 0.67).</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>0.51</mn></mrow><annotation encoding="application/x-tex">\gamma = 0.51</annotation></semantics></math>:
Slow decay, close to the boundary of the Robbins-Monro conditions.
Maintains larger steps for longer, which can be beneficial when initial
estimates are poor.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>2</mn><mi>/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">\gamma = 2/3</annotation></semantics></math>:
A common compromise between convergence speed and stability.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma = 1</annotation></semantics></math>:
Fastest allowable decay. Reduces variance quickly but may under-correct
if the initial value is far from the solution.</li>
</ul>
</div>
<div class="section level3">
<h3 id="robbins-monro-conditions-verification">Robbins-Monro Conditions Verification<a class="anchor" aria-label="anchor" href="#robbins-monro-conditions-verification"></a>
</h3>
<p>For the parametric family
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>a</mi><mi>/</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ≥</mi></msup></mrow><annotation encoding="application/x-tex">a_n = a/(n+A)^\gamma</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><mfrac><mi>a</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ≥</mi></msup></mfrac><mo>=</mo><mi>‚àû</mi><mspace width="1.0em"></mspace><mo>‚áî</mo><mspace width="1.0em"></mspace><mi>Œ≥</mi><mo>‚â§</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">
\sum_{n=1}^{\infty} \frac{a}{(n+A)^\gamma} = \infty
\quad\iff\quad \gamma \leq 1
</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><mfrac><msup><mi>a</mi><mn>2</mn></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>2</mn><mi>Œ≥</mi></mrow></msup></mfrac><mo>&lt;</mo><mi>‚àû</mi><mspace width="1.0em"></mspace><mo>‚áî</mo><mspace width="1.0em"></mspace><mn>2</mn><mi>Œ≥</mi><mo>&gt;</mo><mn>1</mn><mspace width="0.278em"></mspace><mo>‚áî</mo><mspace width="0.278em"></mspace><mi>Œ≥</mi><mo>&gt;</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">
\sum_{n=1}^{\infty} \frac{a^2}{(n+A)^{2\gamma}} &lt; \infty
\quad\iff\quad 2\gamma &gt; 1 \;\iff\; \gamma &gt; 1/2
</annotation></semantics></math></p>
<p>Therefore, any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\gamma \in (1/2, 1]</annotation></semantics></math>
satisfies both conditions.</p>
</div>
<div class="section level3">
<h3 id="step-size-sensitivity">Step Size Sensitivity<a class="anchor" aria-label="anchor" href="#step-size-sensitivity"></a>
</h3>
<p>The effect of different step size configurations can be observed
through the convergence trajectory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Common setup</span></span>
<span><span class="va">eqc_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run SAC with different step decay values</span></span>
<span><span class="va">decays</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.51</span>, <span class="fl">0.67</span>, <span class="fl">0.85</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"coral"</span>, <span class="st">"seagreen"</span>, <span class="st">"purple"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">300</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Iteration"</span>, ylab <span class="op">=</span> <span class="st">"c_n"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"SAC Trajectories: Step Decay Sensitivity"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">eqc_ref</span><span class="op">$</span><span class="va">c_star</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray40"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">decays</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sac_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    c_init <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># deliberately poor start</span></span>
<span>    n_iter <span class="op">=</span> <span class="fl">300L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    step_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gamma <span class="op">=</span> <span class="va">decays</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sac_k</span><span class="op">$</span><span class="va">trajectory</span><span class="op">)</span>, <span class="va">sac_k</span><span class="op">$</span><span class="va">trajectory</span>,</span>
<span>        col <span class="op">=</span> <span class="va">colors</span><span class="op">[</span><span class="va">k</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"gamma = %.2f"</span>, <span class="va">decays</span><span class="op">)</span>, <span class="st">"EQC c*"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">colors</span>, <span class="st">"gray40"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">1.5</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="algorithm-sac_files/figure-html/step-size-sensitivity-1.png" class="r-plt" alt="Figure 1: Effect of step decay parameter on SAC convergence trajectories." width="85%"><p class="caption">
Figure 1: Effect of step decay parameter on SAC convergence
trajectories.
</p>
</div>
<p><strong>Observations</strong>:</p>
<ul>
<li>Slower decay
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>0.51</mn></mrow><annotation encoding="application/x-tex">\gamma = 0.51</annotation></semantics></math>)
maintains larger oscillations longer but eventually converges.</li>
<li>Faster decay
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\gamma = 1.0</annotation></semantics></math>)
converges quickly when starting near the solution, but risks
under-correcting from a distant start.</li>
<li>The default
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>0.67</mn></mrow><annotation encoding="application/x-tex">\gamma = 0.67</annotation></semantics></math>
provides a good compromise between speed and stability.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="polyak-ruppert-averaging">Polyak-Ruppert Averaging<a class="anchor" aria-label="anchor" href="#polyak-ruppert-averaging"></a>
</h2>
<div class="section level3">
<h3 id="why-averaging">Why Averaging?<a class="anchor" aria-label="anchor" href="#why-averaging"></a>
</h3>
<p>The raw SAC iterates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>n</mi></msub><annotation encoding="application/x-tex">c_n</annotation></semantics></math>
converge at rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mi>Œ≥</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-\gamma})</annotation></semantics></math>,
which is suboptimal. Polyak and Juditsky (1992) showed that a simple
average of the iterates achieves the optimal rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-1/2})</annotation></semantics></math>,
regardless of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
(as long as the Robbins-Monro conditions hold).</p>
</div>
<div class="section level3">
<h3 id="the-averaging-formula">The Averaging Formula<a class="anchor" aria-label="anchor" href="#the-averaging-formula"></a>
</h3>
<p>After discarding a burn-in period of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
iterations, the Polyak-Ruppert average is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mi>N</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo>‚àí</mo><mi>B</mi></mrow></mfrac><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mi>B</mi><mo>+</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">
\bar{c}_N = \frac{1}{N - B} \sum_{n=B+1}^{N} c_n
\tag{6}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is the total number of iterations and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is the burn-in count.</p>
</div>
<div class="section level3">
<h3 id="convergence-rate-comparison">Convergence Rate Comparison<a class="anchor" aria-label="anchor" href="#convergence-rate-comparison"></a>
</h3>
<table class="table">
<colgroup>
<col width="45%">
<col width="25%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th align="left">Estimator</th>
<th align="left">Rate</th>
<th align="left">Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Final iterate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>N</mi></msub><annotation encoding="application/x-tex">c_N</annotation></semantics></math>
</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>N</mi><mrow><mo>‚àí</mo><mi>Œ≥</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(N^{-\gamma})</annotation></semantics></math></td>
<td align="left">Depends on step decay</td>
</tr>
<tr class="even">
<td align="left">Polyak-Ruppert
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mi>N</mi></msub><annotation encoding="application/x-tex">\bar{c}_N</annotation></semantics></math>
</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>N</mi><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(N^{-1/2})</annotation></semantics></math></td>
<td align="left">Optimal, independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td align="left">Truncated average</td>
<td align="left"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>N</mi><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(N^{-1/2})</annotation></semantics></math></td>
<td align="left">Requires
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>o</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">B = o(N)</annotation></semantics></math>
</td>
</tr>
</tbody>
</table>
<p>The practical benefit is substantial. With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>0.67</mn></mrow><annotation encoding="application/x-tex">\gamma = 0.67</annotation></semantics></math>
(the package default), the final iterate converges at rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mn>0.67</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-0.67})</annotation></semantics></math>,
while the Polyak-Ruppert average converges at rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mn>0.5</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-0.5})</annotation></semantics></math>
‚Äî nearly the same exponent but with considerably smaller constants due
to variance reduction.</p>
</div>
<div class="section level3">
<h3 id="burn-in-selection">Burn-In Selection<a class="anchor" aria-label="anchor" href="#burn-in-selection"></a>
</h3>
<p>The burn-in period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
should be large enough to exclude the initial transient (before the
iterates have approached the solution) but small enough to include a
sufficient number of post-burn-in samples.</p>
<p>In the package: <code>burn_in</code> parameter, specified as an
integer count (default: <code>floor(n_iter / 2)</code>, i.e., 50% of
iterations).</p>
<p><strong>Guidelines</strong>:</p>
<ul>
<li>With EQC warm start: the default
<code>burn_in = floor(n_iter / 2)</code> is sufficient (starting near
the solution, transient is short).</li>
<li>With cold start or APC: the default 50% burn-in is appropriate; for
very long runs
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>&gt;</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">N &gt; 1000</annotation></semantics></math>),
a smaller fraction (e.g., <code>burn_in = floor(n_iter / 5)</code>) can
be used to include more post-burn-in samples.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="initialization-strategies">Initialization Strategies<a class="anchor" aria-label="anchor" href="#initialization-strategies"></a>
</h2>
<p>The initial value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mn>0</mn></msub><annotation encoding="application/x-tex">c_0</annotation></semantics></math>
significantly affects SAC‚Äôs convergence speed. The package supports
three initialization methods.</p>
<div class="section level3">
<h3 id="strategy-1-eqc-warm-start-recommended">Strategy 1: EQC Warm Start (Recommended)<a class="anchor" aria-label="anchor" href="#strategy-1-eqc-warm-start-recommended"></a>
</h3>
<p>Pass an <code>eqc_result</code> object directly to
<code>c_init</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eqc_for_init</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sac_warm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_for_init</span>,  <span class="co"># EQC warm start</span></span>
<span>  n_iter <span class="op">=</span> <span class="fl">200L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"EQC c*: %.4f\n"</span>, <span class="va">eqc_for_init</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; EQC c*: 0.8995</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SAC c* (warm start): %.4f\n"</span>, <span class="va">sac_warm</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; SAC c* (warm start): 0.9113</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Init method: %s\n"</span>, <span class="va">sac_warm</span><span class="op">$</span><span class="va">init_method</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Init method: eqc_warm_start</span></span></code></pre></div>
<p><strong>Advantages</strong>: Starting near the solution means the
transient phase is short, burn-in can be minimal, and fewer iterations
are needed.</p>
</div>
<div class="section level3">
<h3 id="strategy-2-analytic-pre-calibration-apc">Strategy 2: Analytic Pre-Calibration (APC)<a class="anchor" aria-label="anchor" href="#strategy-2-analytic-pre-calibration-apc"></a>
</h3>
<p>When <code>c_init = NULL</code>, SAC uses a closed-form approximation
derived under Gaussian Rasch assumptions.</p>
<p><strong>Definition (APC Formula).</strong> Under the assumptions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta \sim N(0, 1)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mi>i</mi></msub><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>œÉ</mi><mi>Œ≤</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_i \sim N(0, \sigma^2_\beta)</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>Œª</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_i^{(0)} = 1</annotation></semantics></math>
(Rasch), the approximate initial value is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext mathvariant="normal">APC</mtext></msub><mo>=</mo><msqrt><mfrac><msup><mi>œÅ</mi><mo>*</mo></msup><mrow><mi>I</mi><mo>‚ãÖ</mo><mi>Œ∫</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">
c_{\text{APC}} = \sqrt{\frac{\rho^*}{I \cdot \kappa(\sigma^2) \cdot (1 - \rho^*)}}
\tag{7}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>œÉ</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>+</mo><msubsup><mi>œÉ</mi><mi>Œ≤</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma^2 = 1 + \sigma^2_\beta</annotation></semantics></math>
and the logistic-normal convolution constant is approximated by:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚âà</mo><mfrac><mn>0.25</mn><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mi>œÉ</mi><mn>2</mn></msup><msup><mi>œÄ</mi><mn>2</mn></msup><mi>/</mi><mn>3</mn></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">
\kappa(\sigma^2) \approx \frac{0.25}{\sqrt{1 + \sigma^2 \pi^2 / 3}}
\tag{8}
</annotation></semantics></math></p>
<p><strong>Derivation sketch</strong>: Under the Gaussian Rasch model,
the expected item information at a single item is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Œª</mi><mn>2</mn></msup><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mi>Œ∫</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbb{E}[\lambda^2 p(1-p)] = c^2 \kappa(\sigma^2)</annotation></semantics></math>.
With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
items, the average test information is approximately
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><msup><mi>c</mi><mn>2</mn></msup><mi>Œ∫</mi></mrow><annotation encoding="application/x-tex">I c^2 \kappa</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>œÅ</mi><mo accent="true">ÃÉ</mo></mover><mo>‚âà</mo><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mi>I</mi><msup><mi>c</mi><mn>2</mn></msup><mi>Œ∫</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mi>I</mi><msup><mi>c</mi><mn>2</mn></msup><mi>Œ∫</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\tilde{\rho} \approx \sigma^2_\theta I c^2 \kappa /
(\sigma^2_\theta I c^2 \kappa + 1)</annotation></semantics></math>.
Setting this equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÅ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>
and solving for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
yields Eq. (7).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># APC initialization (c_init = NULL triggers APC)</span></span>
<span><span class="va">sac_apc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># APC warm start</span></span>
<span>  n_iter <span class="op">=</span> <span class="fl">300L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SAC c* (APC start): %.4f\n"</span>, <span class="va">sac_apc</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; SAC c* (APC start): 0.9793</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Init method: %s\n"</span>, <span class="va">sac_apc</span><span class="op">$</span><span class="va">init_method</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Init method: apc_warm_start</span></span>
<span></span>
<span><span class="co"># Compare APC init quality</span></span>
<span><span class="va">c_apc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_apc_init.html">compute_apc_init</a></span><span class="op">(</span>target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"APC initial value: %.4f (vs true c* ~ %.4f)\n"</span>,</span>
<span>            <span class="va">c_apc</span>, <span class="va">eqc_for_init</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; APC initial value: 1.3274 (vs true c* ~ 0.8995)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="strategy-3-user-specified-value">Strategy 3: User-Specified Value<a class="anchor" aria-label="anchor" href="#strategy-3-user-specified-value"></a>
</h3>
<p>A numeric value can be passed directly:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sac_user</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="fl">1.0</span>,  <span class="co"># user-specified</span></span>
<span>  n_iter <span class="op">=</span> <span class="fl">300L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SAC c* (user init = 1.0): %.4f\n"</span>, <span class="va">sac_user</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; SAC c* (user init = 1.0): 0.9233</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Init method: %s\n"</span>, <span class="va">sac_user</span><span class="op">$</span><span class="va">init_method</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Init method: user_specified</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="initialization-comparison">Initialization Comparison<a class="anchor" aria-label="anchor" href="#initialization-comparison"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">300</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Iteration"</span>, ylab <span class="op">=</span> <span class="st">"c_n"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Effect of Initialization on Convergence"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">eqc_for_init</span><span class="op">$</span><span class="va">c_star</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"gray40"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sac_warm</span><span class="op">$</span><span class="va">trajectory</span><span class="op">)</span>, <span class="va">sac_warm</span><span class="op">$</span><span class="va">trajectory</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sac_apc</span><span class="op">$</span><span class="va">trajectory</span><span class="op">)</span>, <span class="va">sac_apc</span><span class="op">$</span><span class="va">trajectory</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"coral"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sac_user</span><span class="op">$</span><span class="va">trajectory</span><span class="op">)</span>, <span class="va">sac_user</span><span class="op">$</span><span class="va">trajectory</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"seagreen"</span>, lwd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQC warm start"</span>, <span class="st">"APC"</span>, <span class="st">"User (c=1.0)"</span>, <span class="st">"EQC c*"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"coral"</span>, <span class="st">"seagreen"</span>, <span class="st">"gray40"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1.5</span>, cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="algorithm-sac_files/figure-html/init-comparison-1.png" class="r-plt" alt="Figure 2: Convergence speed depends strongly on initialization quality." width="85%"><p class="caption">
Figure 2: Convergence speed depends strongly on initialization quality.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="convergence-theory">Convergence Theory<a class="anchor" aria-label="anchor" href="#convergence-theory"></a>
</h2>
<div class="section level3">
<h3 id="almost-sure-convergence-theorem-a-3">Almost Sure Convergence (Theorem A.3)<a class="anchor" aria-label="anchor" href="#almost-sure-convergence-theorem-a-3"></a>
</h3>
<p><strong>Theorem (SAC Convergence; cf.¬†Theorem A.3, Lee
2025).</strong> Suppose:</p>
<ol style="list-style-type: decimal">
<li>The step sizes satisfy Eq. (4):
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àë</mo><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\sum a_n = \infty</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àë</mo><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\sum a_n^2 &lt; \infty</annotation></semantics></math>.</li>
<li>The reliability function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho(c)</annotation></semantics></math>
is Lipschitz continuous on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>c</mi><mi>L</mi></msub><mo>,</mo><msub><mi>c</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[c_L, c_U]</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">g(c) = \rho(c) - \rho^*</annotation></semantics></math>
has a unique root
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>L</mi></msub><mo>,</mo><msub><mi>c</mi><mi>U</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(c_L, c_U)</annotation></semantics></math>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g'(c^*) &gt; 0</annotation></semantics></math>
(strict monotonicity at the root).</li>
<li>The noise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œµ</mi><mi>n</mi></msub><annotation encoding="application/x-tex">\varepsilon_n</annotation></semantics></math>
satisfies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œµ</mi><mi>n</mi></msub><mo>‚à£</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbb{E}[\varepsilon_n \mid c_n] = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>Œµ</mi><mi>n</mi><mn>2</mn></msubsup><mo>‚à£</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚â§</mo><msubsup><mi>œÉ</mi><mi>Œµ</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\mathbb{E}[\varepsilon_n^2 \mid c_n] \leq \sigma^2_\varepsilon &lt; \infty</annotation></semantics></math>.</li>
</ol>
<p>Then the projected SAC iterates converge almost surely:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>n</mi></msub><mover><mo>‚Üí</mo><mtext mathvariant="normal">a.s.</mtext></mover><msup><mi>c</mi><mo>*</mo></msup><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">as </mtext><mspace width="0.333em"></mspace></mrow><mi>n</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">
c_n \xrightarrow{\text{a.s.}} c^* \quad \text{as } n \to \infty
\tag{9}
</annotation></semantics></math></p>
<p><strong>Proof sketch.</strong> The proof follows the classical
Robbins-Monro theory, extended to the projected (constrained) setting by
Kushner and Yin (2003, Chapter 5). The key steps are:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Lyapunov function</strong>: Define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">V(c) = (c - c^*)^2</annotation></semantics></math>.
Compute the conditional expectation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">V(c_{n+1})</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>n</mi></msub><annotation encoding="application/x-tex">c_n</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚à£</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mn>2</mn><msub><mi>a</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>‚à£</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
\mathbb{E}[V(c_{n+1}) \mid c_n]
&amp;= V(c_n) - 2a_n(c_n - c^*) g(c_n) + a_n^2 \mathbb{E}[(\hat{\rho}_n - \rho^*)^2 \mid c_n]
\end{aligned}
</annotation></semantics></math></p></li>
<li><p><strong>Drift condition</strong>: Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g(c)(c - c^*) &gt; 0</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>‚â†</mo><msup><mi>c</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">c \neq c^*</annotation></semantics></math>
(the reliability function is increasing, so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
has the same sign as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">c - c^*</annotation></semantics></math>),
the drift term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mn>2</mn><msub><mi>a</mi><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">-2a_n(c_n - c^*)g(c_n) &lt; 0</annotation></semantics></math>
provides contraction toward
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>.</p></li>
<li><p><strong>Noise control</strong>: The accumulated noise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àë</mo><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><msubsup><mi>œÉ</mi><mi>Œµ</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\sum a_n^2 \sigma^2_\varepsilon &lt;
\infty</annotation></semantics></math> (by the step size conditions), so
the noise does not prevent convergence.</p></li>
<li><p><strong>Almost sure convergence</strong>: By the Robbins-Siegmund
theorem (a supermartingale convergence result),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚Üí</mo><msup><mi>V</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">V(c_n) \to V^*</annotation></semantics></math>
a.s. for some random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>V</mi><mo>*</mo></msup><annotation encoding="application/x-tex">V^*</annotation></semantics></math>.
The drift condition then forces
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mo>*</mo></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">V^* = 0</annotation></semantics></math>,
giving
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>n</mi></msub><mo>‚Üí</mo><msup><mi>c</mi><mo>*</mo></msup></mrow><annotation encoding="application/x-tex">c_n \to c^*</annotation></semantics></math>
a.s.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="asymptotic-normality-of-polyak-ruppert-average">Asymptotic Normality of Polyak-Ruppert Average<a class="anchor" aria-label="anchor" href="#asymptotic-normality-of-polyak-ruppert-average"></a>
</h3>
<p><strong>Theorem (Polyak-Ruppert CLT).</strong> Under the conditions
of Theorem A.3 and additional smoothness assumptions, the Polyak-Ruppert
average satisfies:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mrow><mi>N</mi><mo>‚àí</mo><mi>B</mi></mrow></msqrt><mspace width="0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mi>N</mi></msub><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mover><mo>‚Üí</mo><mi>d</mi></mover><mi>N</mi><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mspace width="0.167em"></mspace><mfrac><msubsup><mi>œÉ</mi><mi>Œµ</mi><mn>2</mn></msubsup><mrow><mi>g</mi><mi>‚Ä≤</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\sqrt{N - B}\,(\bar{c}_N - c^*)
\xrightarrow{d}
N\!\left(0,\, \frac{\sigma^2_\varepsilon}{g'(c^*)^2}\right)
\tag{10}
</annotation></semantics></math></p>
<p>This achieves the Cramer-Rao lower bound for the stochastic
root-finding problem, meaning Polyak-Ruppert averaging is
<em>asymptotically efficient</em>.</p>
<p><strong>Rate comparison</strong>: For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>=</mo><mn>0.67</mn></mrow><annotation encoding="application/x-tex">\gamma = 0.67</annotation></semantics></math>
(the package default):</p>
<ul>
<li>Final iterate: MSE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àº</mo><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mn>1.34</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sim O(n^{-1.34})</annotation></semantics></math>
</li>
<li>Polyak-Ruppert average: MSE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àº</mo><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sim O(n^{-1})</annotation></semantics></math>
</li>
</ul>
<p>The final iterate converges faster in rate than the PR average in
this case, but the PR average achieves smaller constants and optimal
asymptotic efficiency. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ≥</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
closer to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">1/2</annotation></semantics></math>,
the rate improvement from averaging is more dramatic.</p>
</div>
<div class="section level3">
<h3 id="convergence-diagnostics">Convergence Diagnostics<a class="anchor" aria-label="anchor" href="#convergence-diagnostics"></a>
</h3>
<p>SAC provides automatic convergence assessment through several
statistics.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run SAC with enough iterations</span></span>
<span><span class="va">sac_diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_for_init</span>, n_iter <span class="op">=</span> <span class="fl">300L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">conv</span> <span class="op">&lt;-</span> <span class="va">sac_diag</span><span class="op">$</span><span class="va">convergence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Convergence diagnostics:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Convergence diagnostics:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Converged:          %s\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Converged:          TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Mean (first half):  %.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">mean_first_half</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean (first half):  0.9117</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Mean (second half): %.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">mean_second_half</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean (second half): 0.9126</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  SD (post-burn-in):  %.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">sd_post_burn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD (post-burn-in):  0.0007</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Hit lower bound:    %s\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">hit_lower_bound</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Hit lower bound:    FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Hit upper bound:    %s\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">hit_upper_bound</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Hit upper bound:    FALSE</span></span></code></pre></div>
<p><strong>Convergence criterion</strong>: The algorithm is considered
converged when:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mtext mathvariant="normal">first half</mtext></msub><mo>‚àí</mo><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mtext mathvariant="normal">second half</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>&lt;</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">
|\bar{c}_{\text{first half}} - \bar{c}_{\text{second half}}| &lt; 0.05
</annotation></semantics></math></p>
<p>This mean-split diagnostic detects systematic drift, which would
indicate that the iterates have not yet settled around the solution.</p>
<p><strong>Post-burn-in SD</strong>: Should be small relative to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>.
Values above 0.1 suggest more iterations or better initialization.</p>
</div>
</div>
<div class="section level2">
<h2 id="comparative-analysis-eqc-vs-sac">Comparative Analysis: EQC vs SAC<a class="anchor" aria-label="anchor" href="#comparative-analysis-eqc-vs-sac"></a>
</h2>
<div class="section level3">
<h3 id="when-they-agree">When They Agree<a class="anchor" aria-label="anchor" href="#when-they-agree"></a>
</h3>
<p>When both algorithms use the same reliability metric and the SAC run
has converged, agreement within 5% is typical and expected.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Both targeting rho* = 0.80 with info metric</span></span>
<span><span class="va">eqc_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sac_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_comp</span>, n_iter <span class="op">=</span> <span class="fl">300L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_eqc_sac.html">compare_eqc_sac</a></span><span class="op">(</span><span class="va">eqc_comp</span>, <span class="va">sac_comp</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"EQC c*:   %.4f\n"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">c_eqc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; EQC c*:   0.8995</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SAC c*:   %.4f\n"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">c_sac</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; SAC c*:   0.9122</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Diff:     %.4f (%.2f%%)\n"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">diff_abs</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">diff_pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Diff:     0.0127 (1.41%)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Agree:    %s\n"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">agreement</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Agree:    TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sources-of-disagreement">Sources of Disagreement<a class="anchor" aria-label="anchor" href="#sources-of-disagreement"></a>
</h3>
<p>When EQC and SAC disagree by more than 5%, investigate the
following:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Different reliability metrics</strong>: Ensure both use
<code>"info"</code> or both use <code>"msem"</code>. Different metrics
target different quantities, so disagreement is expected.</p></li>
<li><p><strong>SAC non-convergence</strong>: Check
<code>sac_result$convergence$converged</code>. If <code>FALSE</code>,
increase <code>n_iter</code> or use EQC warm start.</p></li>
<li><p><strong>Small M in EQC</strong>: Low quadrature size introduces
Monte Carlo error. Increase <code>M</code> in EQC.</p></li>
<li><p><strong>Extreme target</strong>: Very high
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0.95</mn></mrow><annotation encoding="application/x-tex">&gt; 0.95</annotation></semantics></math>)
or very low
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">&lt; 0.50</annotation></semantics></math>)
targets have flatter reliability curves, making both algorithms less
precise.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="what-to-do-when-they-disagree">What to Do When They Disagree<a class="anchor" aria-label="anchor" href="#what-to-do-when-they-disagree"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Strategy 1: Increase SAC iterations</span></span>
<span><span class="va">sac_longer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  <span class="va">...</span>, n_iter <span class="op">=</span> <span class="fl">500L</span>, seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Strategy 2: Increase EQC quadrature</span></span>
<span><span class="va">eqc_precise</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  <span class="va">...</span>, M <span class="op">=</span> <span class="fl">50000L</span>, seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Strategy 3: Verify same metric</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">eqc_result</span><span class="op">$</span><span class="va">metric</span> <span class="op">==</span> <span class="va">sac_result</span><span class="op">$</span><span class="va">metric</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Strategy 4: Run multiple SAC replications</span></span>
<span><span class="va">sac_reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">5</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>    <span class="va">...</span>, seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">1</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">c_star</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SAC c* across 5 reps: mean = %.4f, sd = %.4f\n"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-examples">Diagnostic Examples<a class="anchor" aria-label="anchor" href="#diagnostic-examples"></a>
</h2>
<div class="section level3">
<h3 id="trajectory-analysis">Trajectory Analysis<a class="anchor" aria-label="anchor" href="#trajectory-analysis"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method provides visual diagnostics for SAC
convergence.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run SAC from APC start for a more interesting trajectory</span></span>
<span><span class="va">sac_traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># APC start</span></span>
<span>  n_iter <span class="op">=</span> <span class="fl">300L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sac_traj</span>, type <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="algorithm-sac_files/figure-html/trajectory-plot-1.png" class="r-plt" alt="Figure 3: SAC convergence trajectory showing the scaling factor iterations." width="85%"><p class="caption">
Figure 3: SAC convergence trajectory showing the scaling factor
iterations.
</p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sac_traj</span>, type <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="algorithm-sac_files/figure-html/rho-trajectory-plot-1.png" class="r-plt" alt="Figure 4: SAC reliability trajectory showing convergence to the target." width="85%"><p class="caption">
Figure 4: SAC reliability trajectory showing convergence to the target.
</p>
</div>
</div>
<div class="section level3">
<h3 id="replication-variability">Replication Variability<a class="anchor" aria-label="anchor" href="#replication-variability"></a>
</h3>
<p>SAC is inherently stochastic. Running multiple replications reveals
the variability of the estimate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_reps</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">sac_reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n_reps</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_reps</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sac_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    c_init <span class="op">=</span> <span class="va">eqc_for_init</span>,</span>
<span>    n_iter <span class="op">=</span> <span class="fl">200L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    seed <span class="op">=</span> <span class="va">r</span> <span class="op">*</span> <span class="fl">100</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">sac_reps</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sac_r</span><span class="op">$</span><span class="va">c_star</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SAC replication study (8 runs with EQC warm start):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; SAC replication study (8 runs with EQC warm start):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Mean c*:  %.4f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean c*:  0.9160</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  SD c*:    %.4f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD c*:    0.0075</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Range:    [%.4f, %.4f]\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Range:    [0.9056, 0.9247]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  EQC c*:   %.4f\n"</span>, <span class="va">eqc_for_init</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   EQC c*:   0.8995</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  |Mean - EQC|: %.4f\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sac_reps</span><span class="op">)</span> <span class="op">-</span> <span class="va">eqc_for_init</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |Mean - EQC|: 0.0165</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparison-across-different-conditions">Comparison Across Different Conditions<a class="anchor" aria-label="anchor" href="#comparison-across-different-conditions"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test across different target reliabilities</span></span>
<span><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">0.70</span>, <span class="fl">0.80</span>, <span class="fl">0.90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EQC vs SAC across target reliabilities (25 Rasch items):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; EQC vs SAC across target reliabilities (25 Rasch items):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %-8s %-10s %-10s %-10s %-8s\n"</span>,</span>
<span>            <span class="st">"Target"</span>, <span class="st">"EQC c*"</span>, <span class="st">"SAC c*"</span>, <span class="st">"|Diff|"</span>, <span class="st">"Agree"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Target   EQC c*     SAC c*     |Diff|     Agree</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">rho_t</span> <span class="kw">in</span> <span class="va">targets</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">eqc_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho <span class="op">=</span> <span class="va">rho_t</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    M <span class="op">=</span> <span class="fl">5000L</span>, seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">sac_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho <span class="op">=</span> <span class="va">rho_t</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    c_init <span class="op">=</span> <span class="va">eqc_t</span>, n_iter <span class="op">=</span> <span class="fl">200L</span>, M_per_iter <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">diff_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">eqc_t</span><span class="op">$</span><span class="va">c_star</span> <span class="op">-</span> <span class="va">sac_t</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span></span>
<span>  <span class="va">diff_pct</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">diff_abs</span> <span class="op">/</span> <span class="va">eqc_t</span><span class="op">$</span><span class="va">c_star</span></span>
<span>  <span class="va">agree</span> <span class="op">&lt;-</span> <span class="va">diff_pct</span> <span class="op">&lt;</span> <span class="fl">5</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %-8.2f %-10.4f %-10.4f %-10.4f %-8s\n"</span>,</span>
<span>              <span class="va">rho_t</span>, <span class="va">eqc_t</span><span class="op">$</span><span class="va">c_star</span>, <span class="va">sac_t</span><span class="op">$</span><span class="va">c_star</span>, <span class="va">diff_abs</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">agree</span>, <span class="st">"YES"</span>, <span class="st">"NO"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   0.60     0.5118     0.5145     0.0026     YES     </span></span>
<span><span class="co">#&gt;   0.70     0.6548     0.6603     0.0055     YES     </span></span>
<span><span class="co">#&gt;   0.80     0.8995     0.9113     0.0118     YES     </span></span>
<span><span class="co">#&gt;   0.90     1.5328     1.5537     0.0209     YES</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="effect-of-m_per_iter">Effect of M_per_iter<a class="anchor" aria-label="anchor" href="#effect-of-m_per_iter"></a>
</h3>
<p>The per-iteration Monte Carlo sample size controls the noise level in
each SAC step.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">500</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SAC sensitivity to M_per_iter (target = 0.80, 300 iter):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; SAC sensitivity to M_per_iter (target = 0.80, 300 iter):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %-12s %-10s %-12s %-10s\n"</span>,</span>
<span>            <span class="st">"M_per_iter"</span>, <span class="st">"c*"</span>, <span class="st">"Post-burn SD"</span>, <span class="st">"Converged"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   M_per_iter   c*         Post-burn SD Converged</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">m_val</span> <span class="kw">in</span> <span class="va">m_values</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sac_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sac_calibrate.html">sac_calibrate</a></span><span class="op">(</span></span>
<span>    target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>    item_source <span class="op">=</span> <span class="st">"parametric"</span>, reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>    c_init <span class="op">=</span> <span class="va">eqc_for_init</span>, n_iter <span class="op">=</span> <span class="fl">300L</span>,</span>
<span>    M_per_iter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">m_val</span><span class="op">)</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">42</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  %-12d %-10.4f %-12.4f %-10s\n"</span>,</span>
<span>              <span class="va">m_val</span>, <span class="va">sac_m</span><span class="op">$</span><span class="va">c_star</span>,</span>
<span>              <span class="va">sac_m</span><span class="op">$</span><span class="va">convergence</span><span class="op">$</span><span class="va">sd_post_burn</span>,</span>
<span>              <span class="va">sac_m</span><span class="op">$</span><span class="va">convergence</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   200          0.9115     0.0005       TRUE      </span></span>
<span><span class="co">#&gt;   500          0.9115     0.0004       TRUE      </span></span>
<span><span class="co">#&gt;   1000         0.9122     0.0007       TRUE      </span></span>
<span><span class="co">#&gt;   2000         0.9127     0.0005       TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="deprecated-alias">Deprecated Alias<a class="anchor" aria-label="anchor" href="#deprecated-alias"></a>
</h2>
<p>The function was previously named <code><a href="../reference/sac_calibrate.html">spc_calibrate()</a></code>. For
backward compatibility, <code><a href="../reference/sac_calibrate.html">spc_calibrate()</a></code> still works but is
deprecated and will emit a warning. Use <code><a href="../reference/sac_calibrate.html">sac_calibrate()</a></code> in
all new code.</p>
<p>Similarly, <code><a href="../reference/compare_eqc_sac.html">compare_eqc_spc()</a></code> is deprecated in favor of
<code><a href="../reference/compare_eqc_sac.html">compare_eqc_sac()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>SAC is a theoretically grounded validation companion to EQC:</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th align="left">Aspect</th>
<th align="left">Summary</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Method</strong></td>
<td align="left">Robbins-Monro stochastic approximation</td>
</tr>
<tr class="even">
<td align="left"><strong>Convergence</strong></td>
<td align="left">Almost sure (Theorem A.3)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Optimal rate</strong></td>
<td align="left">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-1/2})</annotation></semantics></math>
via Polyak-Ruppert averaging</td>
</tr>
<tr class="even">
<td align="left"><strong>Key advantage</strong></td>
<td align="left">Independent validation of EQC</td>
</tr>
<tr class="odd">
<td align="left"><strong>Key disadvantage</strong></td>
<td align="left">Requires tuning (step size, iterations, burn-in)</td>
</tr>
<tr class="even">
<td align="left"><strong>Default metric</strong></td>
<td align="left">Average-information (<code>"info"</code>)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Best practice</strong></td>
<td align="left">Use EQC warm start,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mtext mathvariant="normal">iter</mtext></msub><mo>‚â•</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">n_{\text{iter}} \geq 200</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td align="left"><strong>Convergence check</strong></td>
<td align="left"><code>sac_result$convergence$converged</code></td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Lee, J. (2025). Reliability-targeted simulation of item response
data: Solving the inverse design problem. <em>arXiv preprint
arXiv:2512.16012</em>.</p>
<p>Robbins, H., &amp; Monro, S. (1951). A stochastic approximation
method. <em>The Annals of Mathematical Statistics, 22</em>(3),
400‚Äì407.</p>
<p>Polyak, B. T., &amp; Juditsky, A. B. (1992). Acceleration of
stochastic approximation by averaging. <em>SIAM Journal on Control and
Optimization, 30</em>(4), 838‚Äì855.</p>
<p>Kushner, H. J., &amp; Yin, G. G. (2003). <em>Stochastic Approximation
and Recursive Algorithms and Applications</em> (2nd ed.). Springer.</p>
<p>Spall, J. C. (2003). <em>Introduction to Stochastic Search and
Optimization</em>. Wiley.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
