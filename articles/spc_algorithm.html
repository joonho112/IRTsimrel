<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Algorithm 2: Stochastic Approximation Calibration (SPC) ‚Ä¢ IRTsimrel</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Algorithm 2: Stochastic Approximation Calibration (SPC)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IRTsimrel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/introduction_to_irtsimrel.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/introduction_to_irtsimrel.html">Introduction to IRTsimrel</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core Functions</h6></li>
    <li><a class="dropdown-item" href="../articles/latent_distributions.html">Working with Latent Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/item_parameters.html">Generating Realistic Item Parameters</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Calibration Algorithms</h6></li>
    <li><a class="dropdown-item" href="../articles/eqc_algorithm.html">Algorithm 1: EQC</a></li>
    <li><a class="dropdown-item" href="../articles/spc_algorithm.html">Algorithm 2: SPC</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Validation</h6></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Validating Calibration Results</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joonho112/IRTsimrel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Algorithm 2: Stochastic Approximation Calibration (SPC)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joonho112/IRTsimrel/blob/HEAD/vignettes/spc_algorithm.Rmd" class="external-link"><code>vignettes/spc_algorithm.Rmd</code></a></small>
      <div class="d-none name"><code>spc_algorithm.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joonho112/IRTsimrel" class="external-link">IRTsimrel</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Stochastic Approximation Calibration (SPC) is the <strong>secondary
algorithm</strong> in IRTsimrel, designed to complement EQC (Algorithm
1). SPC uses the Robbins-Monro stochastic approximation framework to
find the discrimination scaling factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>c</mi><mo>*</mo></msup><annotation encoding="application/x-tex">c^*</annotation></semantics></math>
that achieves a target reliability.</p>
<div class="section level3">
<h3 id="when-to-use-spc">When to Use SPC<a class="anchor" aria-label="anchor" href="#when-to-use-spc"></a>
</h3>
<table class="table">
<colgroup>
<col width="38%">
<col width="61%">
</colgroup>
<thead><tr class="header">
<th>Use Case</th>
<th>Recommendation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Routine simulation studies</td>
<td>Use EQC (faster, deterministic)</td>
</tr>
<tr class="even">
<td>Independent validation of EQC</td>
<td>Use SPC with EQC warm start</td>
</tr>
<tr class="odd">
<td>Complex data-generating processes</td>
<td>Use SPC</td>
</tr>
<tr class="even">
<td>Exact MSEM-based reliability targeting</td>
<td>Use SPC with <code>metric = "msem"</code>
</td>
</tr>
<tr class="odd">
<td>Research on stochastic approximation</td>
<td>Use SPC</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="spc-vs-eqc-key-differences">SPC vs EQC: Key Differences<a class="anchor" aria-label="anchor" href="#spc-vs-eqc-key-differences"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Feature</th>
<th>EQC</th>
<th>SPC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Method</td>
<td>Deterministic root-finding</td>
<td>Stochastic approximation</td>
</tr>
<tr class="even">
<td>Speed</td>
<td>Fast (&lt; 1 second)</td>
<td>Slower (depends on <code>n_iter</code>)</td>
</tr>
<tr class="odd">
<td>Default metric</td>
<td>MSEM or Info</td>
<td>MSEM or Info</td>
</tr>
<tr class="even">
<td>Samples</td>
<td>Fixed quadrature</td>
<td>Fresh samples each iteration</td>
</tr>
<tr class="odd">
<td>Output</td>
<td>Point estimate</td>
<td>Trajectory + averaged estimate</td>
</tr>
<tr class="even">
<td>Tuning</td>
<td>Minimal</td>
<td>Step size parameters</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="mathematical-foundation">Mathematical Foundation<a class="anchor" aria-label="anchor" href="#mathematical-foundation"></a>
</h2>
<div class="section level3">
<h3 id="the-robbins-monro-algorithm">The Robbins-Monro Algorithm<a class="anchor" aria-label="anchor" href="#the-robbins-monro-algorithm"></a>
</h3>
<p>SPC implements the classic Robbins-Monro (1951) stochastic
approximation for solving the equation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g(c) = \mathbb{E}[\hat{\rho}(c)] - \rho^* = 0</annotation></semantics></math></p>
<p>The iterative update rule is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>c</mi><mi>n</mi></msub><mo>‚àí</mo><msub><mi>a</mi><mi>n</mi></msub><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c_{n+1} = c_n - a_n \cdot (\hat{\rho}_n - \rho^*)</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>n</mi></msub><annotation encoding="application/x-tex">c_n</annotation></semantics></math>
is the current scaling factor estimate</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{\rho}_n</annotation></semantics></math>
is a noisy reliability estimate at iteration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÅ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>
is the target reliability</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>n</mi></msub><annotation encoding="application/x-tex">a_n</annotation></semantics></math>
is a decreasing step size sequence</li>
</ul>
</div>
<div class="section level3">
<h3 id="step-size-sequence">Step Size Sequence<a class="anchor" aria-label="anchor" href="#step-size-sequence"></a>
</h3>
<p>The step sizes follow:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mfrac><mi>a</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Œ≥</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">a_n = \frac{a}{(n + A)^\gamma}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a &gt; 0</annotation></semantics></math>
is the base step size</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>‚â•</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A \geq 0</annotation></semantics></math>
is the stabilization constant</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">(</mo><mn>0.5</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">\gamma \in (0.5, 1]</annotation></semantics></math>
is the decay exponent</li>
</ul>
<p>The sequence satisfies the Robbins-Monro conditions:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>‚àû</mi><mspace width="1.0em"></mspace><mtext mathvariant="normal">and</mtext><mspace width="1.0em"></mspace><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mo accent="false">‚àû</mo></munderover><msubsup><mi>a</mi><mi>n</mi><mn>2</mn></msubsup><mo>&lt;</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">\sum_{n=1}^{\infty} a_n = \infty \quad \text{and} \quad \sum_{n=1}^{\infty} a_n^2 &lt; \infty</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="polyak-ruppert-averaging">Polyak-Ruppert Averaging<a class="anchor" aria-label="anchor" href="#polyak-ruppert-averaging"></a>
</h3>
<p>Instead of using the final iterate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>N</mi></msub><annotation encoding="application/x-tex">c_N</annotation></semantics></math>,
SPC computes the <strong>Polyak-Ruppert average</strong> over
post-burn-in iterates:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mo>*</mo></msup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo>‚àí</mo><mi>B</mi></mrow></mfrac><munderover><mo>‚àë</mo><mrow><mi>n</mi><mo>=</mo><mi>B</mi><mo>+</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">c^* = \frac{1}{N - B} \sum_{n=B+1}^{N} c_n</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
is the burn-in period. This averaging accelerates convergence and
reduces variance.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="simple-spc-calibration">Simple SPC Calibration<a class="anchor" aria-label="anchor" href="#simple-spc-calibration"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic SPC calibration</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in regularize.values(x, y, ties, missing(ties), na.rm = na.rm):</span></span>
<span><span class="co">#&gt; collapsing to unique 'x' values</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">spc_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =======================================================</span></span>
<span><span class="co">#&gt;   Stochastic Approximation Calibration (SPC) Results</span></span>
<span><span class="co">#&gt; =======================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calibration Summary:</span></span>
<span><span class="co">#&gt;   Model                        : RASCH</span></span>
<span><span class="co">#&gt;   Target reliability (rho*)    : 0.7500</span></span>
<span><span class="co">#&gt;   Achieved reliability         : 0.7352</span></span>
<span><span class="co">#&gt;   Absolute error               : 1.48e-02</span></span>
<span><span class="co">#&gt;   Scaling factor (c*)          : 1.0441</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm Settings:</span></span>
<span><span class="co">#&gt;   Number of items (I)          : 20</span></span>
<span><span class="co">#&gt;   M per iteration              : 500</span></span>
<span><span class="co">#&gt;   M for variance pre-calc      : 10000</span></span>
<span><span class="co">#&gt;   Total iterations             : 200</span></span>
<span><span class="co">#&gt;   Burn-in                      : 100</span></span>
<span><span class="co">#&gt;   Reliability metric           : MSEM-based (bar/w)</span></span>
<span><span class="co">#&gt;   Step params: a=1.00, A=50, gamma=0.67</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence Diagnostics:</span></span>
<span><span class="co">#&gt;   Initialization method        : apc_warm_start</span></span>
<span><span class="co">#&gt;   Initial c_0                  : 1.2853</span></span>
<span><span class="co">#&gt;   Final iterate c_n            : 1.0198</span></span>
<span><span class="co">#&gt;   Polyak-Ruppert c*            : 1.0441</span></span>
<span><span class="co">#&gt;   Pre-calculated theta_var     : 1.0123</span></span>
<span><span class="co">#&gt;   Converged                    : Yes</span></span>
<span><span class="co">#&gt;   Post-burn-in SD              : 0.0158</span></span>
<span><span class="co">#&gt;   Final gradient (rho - rho*)  : +0.0397</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recommended-warm-start-from-eqc">Recommended: Warm Start from EQC<a class="anchor" aria-label="anchor" href="#recommended-warm-start-from-eqc"></a>
</h3>
<p>For best results, use EQC to initialize SPC:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Run EQC</span></span>
<span><span class="va">eqc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: Target rho* = 0.800 is near the achievable maximum (0.824) for this configuration.</span></span>
<span></span>
<span><span class="co"># Step 2: Validate with SPC (warm start)</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_result</span>,  <span class="co"># Pass EQC result directly!</span></span>
<span>  n_iter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare results</span></span>
<span><span class="fu"><a href="../reference/compare_eqc_spc.html">compare_eqc_spc</a></span><span class="op">(</span><span class="va">eqc_result</span>, <span class="va">spc_result</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =======================================================</span></span>
<span><span class="co">#&gt;   EQC vs SPC Comparison</span></span>
<span><span class="co">#&gt; =======================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Target reliability  : 0.8000</span></span>
<span><span class="co">#&gt;   EQC c*              : 0.908219</span></span>
<span><span class="co">#&gt;   SPC c*              : 0.987060</span></span>
<span><span class="co">#&gt;   Absolute difference : 0.078841</span></span>
<span><span class="co">#&gt;   Percent difference  : 8.68%</span></span>
<span><span class="co">#&gt;   Agreement (&lt; 5%)    : NO</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="understanding-the-output">Understanding the Output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h2>
<p>The <code>spc_result</code> object contains:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">spc_result</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "c_star"         "c_final"        "target_rho"     "achieved_rho"  </span></span>
<span><span class="co">#&gt;  [5] "theta_var"      "trajectory"     "rho_trajectory" "metric"        </span></span>
<span><span class="co">#&gt;  [9] "model"          "n_items"        "n_iter"         "burn_in"       </span></span>
<span><span class="co">#&gt; [13] "M_per_iter"     "M_pre"          "step_params"    "c_bounds"      </span></span>
<span><span class="co">#&gt; [17] "c_init"         "init_method"    "convergence"    "call"</span></span></code></pre></div>
<div class="section level3">
<h3 id="key-components">Key Components<a class="anchor" aria-label="anchor" href="#key-components"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Component</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>c_star</code></td>
<td>Polyak-Ruppert averaged scaling factor</td>
</tr>
<tr class="even">
<td><code>c_final</code></td>
<td>Final iterate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>N</mi></msub><annotation encoding="application/x-tex">c_N</annotation></semantics></math>
</td>
</tr>
<tr class="odd">
<td><code>target_rho</code></td>
<td>Target reliability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÅ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>
</td>
</tr>
<tr class="even">
<td><code>achieved_rho</code></td>
<td>Post-calibration reliability estimate</td>
</tr>
<tr class="odd">
<td><code>theta_var</code></td>
<td>Pre-calculated latent variance</td>
</tr>
<tr class="even">
<td><code>trajectory</code></td>
<td>Vector of all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>n</mi></msub><annotation encoding="application/x-tex">c_n</annotation></semantics></math>
iterates</td>
</tr>
<tr class="odd">
<td><code>rho_trajectory</code></td>
<td>Vector of all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{\rho}_n</annotation></semantics></math>
estimates</td>
</tr>
<tr class="even">
<td><code>init_method</code></td>
<td>Initialization method used</td>
</tr>
<tr class="odd">
<td><code>convergence</code></td>
<td>Convergence diagnostics</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="accessing-results">Accessing Results<a class="anchor" aria-label="anchor" href="#accessing-results"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calibrated scaling factor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Polyak-Ruppert c*: %.4f\n"</span>, <span class="va">spc_result</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Polyak-Ruppert c*: 0.9871</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Final iterate c_N: %.4f\n"</span>, <span class="va">spc_result</span><span class="op">$</span><span class="va">c_final</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Final iterate c_N: 0.9881</span></span>
<span></span>
<span><span class="co"># Convergence status</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Converged: %s\n"</span>, <span class="va">spc_result</span><span class="op">$</span><span class="va">convergence</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Converged: TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Post-burn-in SD: %.4f\n"</span>, <span class="va">spc_result</span><span class="op">$</span><span class="va">convergence</span><span class="op">$</span><span class="va">sd_post_burn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Post-burn-in SD: 0.0037</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-convergence">Visualizing Convergence<a class="anchor" aria-label="anchor" href="#visualizing-convergence"></a>
</h2>
<p>SPC provides a <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for visualizing the
iteration trajectory:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot convergence trajectory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spc_result</span>, type <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="spc_algorithm_files/figure-html/plot-trajectory-1.png" class="r-plt" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot reliability estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spc_result</span>, type <span class="op">=</span> <span class="st">"rho"</span><span class="op">)</span></span></code></pre></div>
<p><img src="spc_algorithm_files/figure-html/plot-rho-1.png" class="r-plt" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Both plots combined (requires patchwork)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spc_result</span>, type <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-parameters">Key Parameters<a class="anchor" aria-label="anchor" href="#key-parameters"></a>
</h2>
<div class="section level3">
<h3 id="iteration-control">Iteration Control<a class="anchor" aria-label="anchor" href="#iteration-control"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">300</span>,       <span class="co"># Total iterations (default: 300)</span></span>
<span>  burn_in <span class="op">=</span> <span class="fl">150</span>,      <span class="co"># Discard first 150 for averaging (default: n_iter/2)</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Recommendations</strong>:</p>
<ul>
<li>
<code>n_iter = 200-300</code> is usually sufficient with warm
start</li>
<li>
<code>n_iter = 500+</code> for cold start or difficult problems</li>
<li>
<code>burn_in</code> should be at least 50% of
<code>n_iter</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="monte-carlo-sample-sizes">Monte Carlo Sample Sizes<a class="anchor" aria-label="anchor" href="#monte-carlo-sample-sizes"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  M_per_iter <span class="op">=</span> <span class="fl">500</span>,   <span class="co"># Samples per iteration (default: 500)</span></span>
<span>  M_pre <span class="op">=</span> <span class="fl">10000</span>,      <span class="co"># Samples for variance pre-calculation (default: 10000)</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Critical</strong>: <code>M_pre</code> controls the stability
of the latent variance estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma^2_\theta</annotation></semantics></math>,
which is fixed throughout all iterations. Use
<code>M_pre &gt;= 10000</code> for numerical stability.</p>
</div>
<div class="section level3">
<h3 id="step-size-parameters">Step Size Parameters<a class="anchor" aria-label="anchor" href="#step-size-parameters"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  step_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    a <span class="op">=</span> <span class="fl">1.0</span>,      <span class="co"># Base step size (default: 1.0)</span></span>
<span>    A <span class="op">=</span> <span class="fl">50</span>,       <span class="co"># Stabilization constant (default: 50)</span></span>
<span>    gamma <span class="op">=</span> <span class="fl">0.67</span>  <span class="co"># Decay exponent (default: 0.67 = 2/3)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Guidance</strong>:</p>
<table class="table">
<thead><tr class="header">
<th>Situation</th>
<th>Adjustment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Slow convergence</td>
<td>Increase <code>a</code>
</td>
</tr>
<tr class="even">
<td>Oscillating trajectory</td>
<td>Decrease <code>a</code> or increase <code>A</code>
</td>
</tr>
<tr class="odd">
<td>Too aggressive early steps</td>
<td>Increase <code>A</code>
</td>
</tr>
<tr class="even">
<td>Need faster decay</td>
<td>Increase <code>gamma</code> (max 1.0)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="item-resampling">Item Resampling<a class="anchor" aria-label="anchor" href="#item-resampling"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Resample item parameters each iteration (default)</span></span>
<span><span class="va">spc_resample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  resample_items <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fix item parameters across iterations</span></span>
<span><span class="va">spc_fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  resample_items <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>resample_items = TRUE</code>: More robust, accounts for item
parameter uncertainty</li>
<li>
<code>resample_items = FALSE</code>: Lower variance, faster
convergence</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="initialization-methods">Initialization Methods<a class="anchor" aria-label="anchor" href="#initialization-methods"></a>
</h2>
<p>SPC supports three initialization strategies:</p>
<div class="section level3">
<h3 id="eqc-warm-start-recommended">1. EQC Warm Start (Recommended)<a class="anchor" aria-label="anchor" href="#eqc-warm-start-recommended"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eqc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span>target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_result</span>,  <span class="co"># Pass eqc_result object</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># init_method = "eqc_warm_start"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analytic-pre-calibration-apc">2. Analytic Pre-Calibration (APC)<a class="anchor" aria-label="anchor" href="#analytic-pre-calibration-apc"></a>
</h3>
<p>When <code>c_init = NULL</code>, SPC uses a closed-form
approximation:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  c_init <span class="op">=</span> <span class="cn">NULL</span>,  <span class="co"># Uses APC warm start</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># init_method = "apc_warm_start"</span></span></code></pre></div>
<p>The APC formula (under Gaussian Rasch assumptions):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mtext mathvariant="normal">init</mtext></msub><mo>=</mo><msqrt><mfrac><msup><mi>œÅ</mi><mo>*</mo></msup><mrow><mi>I</mi><mo>‚ãÖ</mo><mi>Œ∫</mi><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><msup><mi>œÅ</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">c_{\text{init}} = \sqrt{\frac{\rho^*}{I \cdot \kappa \cdot (1 - \rho^*)}}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∫</mi><mo>‚âà</mo><mn>0.25</mn><mi>/</mi><msqrt><mrow><mn>1</mn><mo>+</mo><msup><mi>œÉ</mi><mn>2</mn></msup><msup><mi>œÄ</mi><mn>2</mn></msup><mi>/</mi><mn>3</mn></mrow></msqrt></mrow><annotation encoding="application/x-tex">\kappa \approx 0.25 / \sqrt{1 + \sigma^2 \pi^2/3}</annotation></semantics></math>
is the logistic-normal convolution.</p>
</div>
<div class="section level3">
<h3 id="user-specified-value">3. User-Specified Value<a class="anchor" aria-label="anchor" href="#user-specified-value"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  c_init <span class="op">=</span> <span class="fl">1.0</span>,  <span class="co"># User-specified starting value</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># init_method = "user_specified"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="convergence-diagnostics">Convergence Diagnostics<a class="anchor" aria-label="anchor" href="#convergence-diagnostics"></a>
</h2>
<p>SPC provides automatic convergence assessment:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access convergence information</span></span>
<span><span class="va">conv</span> <span class="op">&lt;-</span> <span class="va">spc_result</span><span class="op">$</span><span class="va">convergence</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Convergence Diagnostics:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Convergence Diagnostics:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Converged: %s\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Converged: TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Mean (first half):  %.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">mean_first_half</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean (first half):  0.9842</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Mean (second half): %.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">mean_second_half</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Mean (second half): 0.9900</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  SD (post-burn-in):  %.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">sd_post_burn</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   SD (post-burn-in):  0.0037</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Final gradient:     %+.4f\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">final_gradient</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Final gradient:     +0.0167</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Hit lower bound:    %s\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">hit_lower_bound</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Hit lower bound:    FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Hit upper bound:    %s\n"</span>, <span class="va">conv</span><span class="op">$</span><span class="va">hit_upper_bound</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Hit upper bound:    FALSE</span></span></code></pre></div>
<div class="section level3">
<h3 id="convergence-criteria">Convergence Criteria<a class="anchor" aria-label="anchor" href="#convergence-criteria"></a>
</h3>
<p>The algorithm is considered converged if:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mtext mathvariant="normal">first half</mtext></msub><mo>‚àí</mo><msub><mover><mi>c</mi><mo accent="true">‚Äæ</mo></mover><mtext mathvariant="normal">second half</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>&lt;</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">|\bar{c}_{\text{first half}} - \bar{c}_{\text{second half}}| &lt; 0.05</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="handling-non-convergence">Handling Non-Convergence<a class="anchor" aria-label="anchor" href="#handling-non-convergence"></a>
</h3>
<p>If SPC doesn‚Äôt converge:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Increase iterations</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">500</span>,     <span class="co"># More iterations</span></span>
<span>  burn_in <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust step sizes</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  step_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0.5</span>, A <span class="op">=</span> <span class="fl">100</span>, gamma <span class="op">=</span> <span class="fl">0.67</span><span class="op">)</span>,  <span class="co"># Smaller, more stable steps</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use EQC warm start</span></span>
<span><span class="va">eqc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span>target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_result</span>,  <span class="co"># Start near solution</span></span>
<span>  n_iter <span class="op">=</span> <span class="fl">150</span>,         <span class="co"># Fewer iterations needed</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="understanding-eqc-vs-spc-differences">Understanding EQC vs SPC Differences<a class="anchor" aria-label="anchor" href="#understanding-eqc-vs-spc-differences"></a>
</h2>
<div class="section level3">
<h3 id="why-do-they-differ">Why Do They Differ?<a class="anchor" aria-label="anchor" href="#why-do-they-differ"></a>
</h3>
<p>When comparing EQC and SPC results, you may notice systematic
differences. This is <strong>expected</strong> and reflects theoretical
distinctions:</p>
<p><strong>EQC targets</strong> average-information reliability:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>œÅ</mi><mo accent="true">ÃÉ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mover><mi>ùí•</mi><mo accent="true">‚Äæ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mover><mi>ùí•</mi><mo accent="true">‚Äæ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\tilde{\rho}(c) = \frac{\sigma^2_\theta \bar{\mathcal{J}}(c)}{\sigma^2_\theta \bar{\mathcal{J}}(c) + 1}</annotation></semantics></math></p>
<p><strong>SPC targets</strong> MSEM-based reliability (by default):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>œÅ</mi><mo accent="true">‚Äæ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mrow><msubsup><mi>œÉ</mi><mi>Œ∏</mi><mn>2</mn></msubsup><mo>+</mo><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mi>/</mi><mi>ùí•</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Œ∏</mi><mo>;</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\bar{\rho}(c) = \frac{\sigma^2_\theta}{\sigma^2_\theta + \mathbb{E}[1/\mathcal{J}(\theta; c)]}</annotation></semantics></math></p>
<p><strong>Jensen‚Äôs inequality</strong> guarantees:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>œÅ</mi><mo accent="true">ÃÉ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚â•</mo><mover><mi>œÅ</mi><mo accent="true">‚Äæ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for all </mtext><mspace width="0.333em"></mspace></mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">\tilde{\rho}(c) \geq \bar{\rho}(c) \quad \text{for all } c</annotation></semantics></math></p>
<p>Therefore, to achieve the same target
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÅ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\rho^*</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>c</mi><mtext mathvariant="normal">SPC</mtext><mo>*</mo></msubsup><mo>&gt;</mo><msubsup><mi>c</mi><mtext mathvariant="normal">EQC</mtext><mo>*</mo></msubsup></mrow><annotation encoding="application/x-tex">c^*_{\text{SPC}} &gt; c^*_{\text{EQC}}</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="empirical-example">Empirical Example<a class="anchor" aria-label="anchor" href="#empirical-example"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Both targeting rho* = 0.80</span></span>
<span><span class="va">eqc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  reliability_metric <span class="op">=</span> <span class="st">"msem"</span>,  <span class="co"># Same metric</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  reliability_metric <span class="op">=</span> <span class="st">"msem"</span>,  <span class="co"># Same metric</span></span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_result</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SPC's c* will be slightly higher</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"EQC c*: %.4f\n"</span>, <span class="va">eqc_result</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"SPC c*: %.4f\n"</span>, <span class="va">spc_result</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="making-them-comparable">Making Them Comparable<a class="anchor" aria-label="anchor" href="#making-them-comparable"></a>
</h3>
<p>To maximize agreement, use the same reliability metric:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Both use "info" metric</span></span>
<span><span class="va">eqc_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">spc_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  reliability_metric <span class="op">=</span> <span class="st">"info"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_info</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/compare_eqc_spc.html">compare_eqc_spc</a></span><span class="op">(</span><span class="va">eqc_info</span>, <span class="va">spc_info</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="verbose-mode">Verbose Mode<a class="anchor" aria-label="anchor" href="#verbose-mode"></a>
</h2>
<p>Enable detailed output to monitor progress:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Level 1: Progress updates</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,   <span class="co"># or verbose = 1</span></span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Level 2: Iteration-by-iteration details</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-different-models">Working with Different Models<a class="anchor" aria-label="anchor" href="#working-with-different-models"></a>
</h2>
<div class="section level3">
<h3 id="rasch-model">Rasch Model<a class="anchor" aria-label="anchor" href="#rasch-model"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_rasch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pl-model">2PL Model<a class="anchor" aria-label="anchor" href="#pl-model"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spc_2pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"2pl"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"irw"</span>,</span>
<span>  item_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    discrimination_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      mu_log <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      sigma_log <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>      rho <span class="op">=</span> <span class="op">-</span><span class="fl">0.3</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="alias-sac_calibrate">Alias: sac_calibrate()<a class="anchor" aria-label="anchor" href="#alias-sac_calibrate"></a>
</h2>
<p>For nomenclature consistency with the manuscript,
<code><a href="../reference/spc_calibrate.html">sac_calibrate()</a></code> is provided as an alias:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These are identical</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span>target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">sac_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">sac_calibrate</a></span><span class="op">(</span>target_rho <span class="op">=</span> <span class="fl">0.80</span>, n_items <span class="op">=</span> <span class="fl">25</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="complete-validation-workflow">Complete Validation Workflow<a class="anchor" aria-label="anchor" href="#complete-validation-workflow"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ==== 1. Run EQC (primary calibration) ====</span></span>
<span><span class="va">eqc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eqc_calibrate.html">eqc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"irw"</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ==== 2. Validate with SPC ====</span></span>
<span><span class="va">spc_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/spc_calibrate.html">spc_calibrate</a></span><span class="op">(</span></span>
<span>  target_rho <span class="op">=</span> <span class="fl">0.80</span>,</span>
<span>  n_items <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"rasch"</span>,</span>
<span>  latent_shape <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  item_source <span class="op">=</span> <span class="st">"irw"</span>,</span>
<span>  c_init <span class="op">=</span> <span class="va">eqc_result</span>,</span>
<span>  n_iter <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ==== 3. Compare results ====</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_eqc_spc.html">compare_eqc_spc</a></span><span class="op">(</span><span class="va">eqc_result</span>, <span class="va">spc_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ==== 4. Check convergence ====</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">spc_result</span><span class="op">$</span><span class="va">convergence</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"SPC did not converge. Consider increasing n_iter."</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ==== 5. Visualize ====</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spc_result</span>, type <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ==== 6. Final validation with TAM ====</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_response_data.html">simulate_response_data</a></span><span class="op">(</span></span>
<span>  eqc_result <span class="op">=</span> <span class="va">eqc_result</span>,</span>
<span>  n_persons <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tam_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_reliability_tam.html">compute_reliability_tam</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">response_matrix</span>, model <span class="op">=</span> <span class="st">"rasch"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFinal Validation Summary:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Target reliability:  %.3f\n"</span>, <span class="va">eqc_result</span><span class="op">$</span><span class="va">target_rho</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  EQC c*:              %.4f\n"</span>, <span class="va">eqc_result</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  SPC c*:              %.4f\n"</span>, <span class="va">spc_result</span><span class="op">$</span><span class="va">c_star</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  Agreement:           %.2f%%\n"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">diff_pct</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  TAM WLE reliability: %.3f\n"</span>, <span class="va">tam_rel</span><span class="op">$</span><span class="va">rel_wle</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"  TAM EAP reliability: %.3f\n"</span>, <span class="va">tam_rel</span><span class="op">$</span><span class="va">rel_eap</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="troubleshooting-guide">Troubleshooting Guide<a class="anchor" aria-label="anchor" href="#troubleshooting-guide"></a>
</h2>
<table class="table">
<colgroup>
<col width="34%">
<col width="26%">
<col width="38%">
</colgroup>
<thead><tr class="header">
<th>Problem</th>
<th>Cause</th>
<th>Solution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Slow convergence</td>
<td>Poor initialization</td>
<td>Use EQC warm start</td>
</tr>
<tr class="even">
<td>Oscillating trajectory</td>
<td>Step size too large</td>
<td>Decrease <code>a</code>, increase <code>A</code>
</td>
</tr>
<tr class="odd">
<td>Hitting bounds</td>
<td>Target outside feasible range</td>
<td>Extend <code>c_bounds</code>
</td>
</tr>
<tr class="even">
<td>High post-burn-in SD</td>
<td>Insufficient averaging</td>
<td>Increase <code>n_iter</code>
</td>
</tr>
<tr class="odd">
<td>Divergence</td>
<td>Step size too aggressive</td>
<td>Use <code>gamma = 0.75</code> or higher</td>
</tr>
<tr class="even">
<td>Memory issues</td>
<td>Large <code>M_per_iter</code>
</td>
<td>Reduce to 300-500</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="theoretical-properties">Theoretical Properties<a class="anchor" aria-label="anchor" href="#theoretical-properties"></a>
</h2>
<div class="section level3">
<h3 id="convergence-guarantee">Convergence Guarantee<a class="anchor" aria-label="anchor" href="#convergence-guarantee"></a>
</h3>
<p>Under standard Robbins-Monro conditions, the SPC iterate converges
almost surely:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>n</mi></msub><mover><mo>‚Üí</mo><mtext mathvariant="normal">a.s.</mtext></mover><msup><mi>c</mi><mo>*</mo></msup><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">as </mtext><mspace width="0.333em"></mspace></mrow><mi>n</mi><mo>‚Üí</mo><mi>‚àû</mi></mrow><annotation encoding="application/x-tex">c_n \xrightarrow{\text{a.s.}} c^* \quad \text{as } n \to \infty</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="asymptotic-normality">Asymptotic Normality<a class="anchor" aria-label="anchor" href="#asymptotic-normality"></a>
</h3>
<p>With Polyak-Ruppert averaging:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mi>n</mi></msqrt><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>c</mi><mi>n</mi><mo>*</mo></msubsup><mo>‚àí</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mover><mo>‚Üí</mo><mi>d</mi></mover><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>œÉ</mi><mn>2</mn></msup><mi>/</mi><mi>g</mi><mi>‚Ä≤</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sqrt{n}(c^*_n - c^*) \xrightarrow{d} N(0, \sigma^2 / g'(c^*)^2)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>œÉ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
is the variance of the gradient noise and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>‚Ä≤</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>c</mi><mo>*</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g'(c^*)</annotation></semantics></math>
is the derivative of the reliability function at the solution.</p>
</div>
<div class="section level3">
<h3 id="rate-of-convergence">Rate of Convergence<a class="anchor" aria-label="anchor" href="#rate-of-convergence"></a>
</h3>
<ul>
<li>Final iterate:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mi>‚àí</mi><mi>Œ≥</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-\gamma})</annotation></semantics></math>
convergence</li>
<li>Polyak-Ruppert average:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mrow><mi>‚àí</mi><mn>1</mn><mi>/</mi><mn>2</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^{-1/2})</annotation></semantics></math>
convergence (optimal rate)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>SPC is a flexible, theoretically-grounded algorithm for
reliability-targeted calibration:</p>
<ul>
<li>
<strong>Best practice</strong>: Use EQC for primary calibration, SPC
for validation</li>
<li>
<strong>Warm start</strong>: Always use EQC result when
available</li>
<li>
<strong>Convergence</strong>: Check
<code>spc_result$convergence$converged</code>
</li>
<li>
<strong>Visualization</strong>: Use <code>plot(spc_result)</code> to
inspect trajectory</li>
<li>
<strong>Differences from EQC</strong>: Expected due to reliability
metric definitions</li>
</ul>
<p>For routine simulation work, EQC alone is typically sufficient. Use
SPC when you need independent validation or are working with complex
scenarios where EQC‚Äôs assumptions may not hold.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Robbins, H., &amp; Monro, S. (1951). A stochastic approximation
method. <em>The Annals of Mathematical Statistics, 22</em>(3),
400‚Äì407.</p>
<p>Polyak, B. T., &amp; Juditsky, A. B. (1992). Acceleration of
stochastic approximation by averaging. <em>SIAM Journal on Control and
Optimization, 30</em>(4), 838‚Äì855.</p>
<p>Kushner, H. J., &amp; Yin, G. G. (2003). <em>Stochastic Approximation
and Recursive Algorithms and Applications</em> (2nd ed.). Springer.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/joonho112" class="external-link">JoonHo Lee</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
