% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reliability_utils.R
\name{compute_rho_bar}
\alias{compute_rho_bar}
\alias{compute_rho_tilde}
\title{Compute Marginal Reliability from Simulated Test Information}
\usage{
compute_rho_bar(c, theta_vec, beta_vec, lambda_base, theta_var = NULL)

compute_rho_tilde(c, theta_vec, beta_vec, lambda_base, theta_var = NULL)
}
\arguments{
\item{c}{Numeric scalar. Global discrimination scaling factor.}

\item{theta_vec}{Numeric vector of abilities \eqn{\theta_m}.}

\item{beta_vec}{Numeric vector of item difficulties \eqn{\beta_i}.}

\item{lambda_base}{Numeric vector of baseline discriminations
\eqn{\lambda_{i,0}} (before scaling by \code{c}).}

\item{theta_var}{Optional numeric. Pre-calculated variance of theta.
If NULL, computed from \code{theta_vec}.}
}
\value{
Numeric scalar reliability value.
}
\description{
Low-level utilities for mapping a discrimination scale \eqn{c} and
simulated person/item parameters to marginal reliability.

These functions implement the same reliability definitions used
inside both \code{eqc_calibrate()} and \code{sac_calibrate()}:

\itemize{
\item \code{compute_rho_bar()}: MSEM-based marginal reliability
\eqn{\bar{w}(c) = \sigma_\theta^2 / (\sigma_\theta^2 + E[1/\mathcal{J}(\theta;c)])}
\item \code{compute_rho_tilde()}: Average-information reliability
\eqn{\tilde{\rho}(c) = \sigma_\theta^2 \bar{\mathcal{J}}(c) /
      (\sigma_\theta^2 \bar{\mathcal{J}}(c) + 1)}
}
}
\details{
The computation proceeds as:
\enumerate{
\item Form scaled discriminations \eqn{\lambda_i(c) = c \cdot \lambda_{i,0}}.
\item Compute item response probabilities
\eqn{p_{mi} = \text{logit}^{-1}\{\lambda_i(c)(\theta_m - \beta_i)\}}.
\item Item information:
\eqn{\mathcal{J}_{mi} = \lambda_i(c)^2 p_{mi}(1-p_{mi})}.
\item Test information at each \eqn{\theta_m}:
\eqn{\mathcal{J}_m = \sum_i \mathcal{J}_{mi}}.
\item Reliability:
\itemize{
\item \code{compute_rho_bar()}: harmonic-mean-based MSEM
\eqn{\text{MSEM} = E[1/\mathcal{J}_m]},
\eqn{\bar{w}(c) = \sigma_\theta^2 / (\sigma_\theta^2 + \text{MSEM})}.
\item \code{compute_rho_tilde()}: arithmetic-mean-based information
\eqn{\bar{\mathcal{J}} = E[\mathcal{J}_m]},
\eqn{\tilde{\rho}(c) = \sigma_\theta^2 \bar{\mathcal{J}} /
          (\sigma_\theta^2 \bar{\mathcal{J}} + 1)}.
}
}

A small floor (\code{1e-10}) is applied to test information to avoid
numerical problems when taking reciprocals.
}
\examples{
# Simple toy example
set.seed(1)
theta <- rnorm(1000)
beta  <- rnorm(20)
lambda0 <- rep(1, 20)

compute_rho_bar(1, theta, beta, lambda0)
compute_rho_tilde(1, theta, beta, lambda0)

# With pre-calculated theta variance (recommended for SAC)
theta_var_fixed <- var(rnorm(10000))  # Pre-calculate from large sample
compute_rho_bar(1, theta, beta, lambda0, theta_var = theta_var_fixed)

}
