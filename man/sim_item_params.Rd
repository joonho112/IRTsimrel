% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_item_params.R
\name{sim_item_params}
\alias{sim_item_params}
\alias{print.item_params}
\alias{summary.item_params}
\title{Simulate Item Parameters for IRT Studies}
\usage{
sim_item_params(
  n_items,
  model = c("rasch", "2pl"),
  source = c("irw", "parametric", "hierarchical", "custom"),
  method = c("copula", "conditional", "independent"),
  n_forms = 1L,
  difficulty_params = list(),
  discrimination_params = list(),
  hierarchical_params = list(),
  custom_params = list(),
  scale = 1,
  center_difficulties = TRUE,
  seed = NULL
)

\method{print}{item_params}(x, ...)

\method{summary}{item_params}(object, ...)
}
\arguments{
\item{n_items}{Integer. Number of items to generate per form.}

\item{model}{Character. The data-generating model: "rasch" or "2pl".}

\item{source}{Character. Source for generating difficulties:
\describe{
\item{\code{"irw"}}{Use IRW difficulty pool (realistic, empirical)}
\item{\code{"parametric"}}{Generate from parametric distribution}
\item{\code{"hierarchical"}}{Joint MVN for both parameters (Glas & van der Linden)}
\item{\code{"custom"}}{User-supplied parameters or function}
}}

\item{method}{Character. Method for generating discriminations (when model = "2pl"):
\describe{
\item{\code{"copula"}}{Gaussian copula - preserves marginals exactly (RECOMMENDED)}
\item{\code{"conditional"}}{Conditional normal regression on difficulty}
\item{\code{"independent"}}{Independent generation (no correlation)}
}}

\item{n_forms}{Integer. Number of test forms to generate. Default is 1.
When > 1, returns a data frame with form_id column.}

\item{difficulty_params}{List. Parameters for difficulty generation:
\describe{
\item{For \code{source = "irw"}:}{\code{pool} - difficulty pool data frame}
\item{For \code{source = "parametric"}:}{\code{mu}, \code{sigma}, \code{distribution}}
}}

\item{discrimination_params}{List. Parameters for discrimination generation:
\describe{
\item{\code{mu_log}}{Mean of log-discrimination (default: 0)}
\item{\code{sigma_log}}{SD of log-discrimination (default: 0.3)}
\item{\code{rho}}{Target correlation between \eqn{\beta} and \eqn{\log(\lambda)} (default: -0.3)}
}}

\item{hierarchical_params}{List. For source = "hierarchical":
\describe{
\item{\code{mu}}{2-vector: means of \eqn{(\log\lambda, \beta)}}
\item{\code{tau}}{2-vector: SDs}
\item{\code{rho}}{Correlation}
}}

\item{custom_params}{List. For source = "custom":
\describe{
\item{\code{beta}}{Vector or function returning difficulties}
\item{\code{lambda}}{Vector or function returning discriminations}
}}

\item{scale}{Numeric. Global discrimination scaling factor for reliability targeting.
Final discriminations are \eqn{\lambda_i^* = c \cdot \lambda_i}. Default is 1.}

\item{center_difficulties}{Logical. If TRUE, center difficulties to sum to zero
for identification. Default is TRUE.}

\item{seed}{Integer. Random seed for reproducibility.}

\item{x}{An object of class \code{"item_params"}.}

\item{...}{Additional arguments passed to or from other methods.}

\item{object}{An object of class \code{"item_params"}.}
}
\value{
An object of class \code{"item_params"} containing:
\describe{
\item{\code{data}}{Data frame with columns: form_id, item_id, beta, lambda, lambda_unscaled}
\item{\code{model}}{Model type used}
\item{\code{source}}{Source used for generation}
\item{\code{method}}{Method used for discrimination generation}
\item{\code{n_items}}{Number of items per form}
\item{\code{n_forms}}{Number of forms generated}
\item{\code{scale}}{Scale factor applied}
\item{\code{centered}}{Whether difficulties were centered}
\item{\code{params}}{Parameters used for generation}
\item{\code{achieved}}{Achieved statistics (correlations, moments)}
}

The input object, invisibly.

An object of class \code{"summary.item_params"} containing key
parameter summaries.
}
\description{
\code{sim_item_params()} generates item parameters (difficulty \eqn{\beta} and
discrimination \eqn{\lambda}) for Item Response Theory (IRT) simulation studies.
It wraps the IRW \code{irw_simu_diff()} function for realistic difficulty distributions
and provides multiple methods for generating correlated discriminations.

The function is designed with four key principles:
\enumerate{
\item \strong{Realistic difficulties:} Integration with Item Response Warehouse (IRW)
for empirically-grounded difficulty distributions.
\item \strong{Correlated parameters:} Support for the empirically observed negative
correlation between difficulty and discrimination (Sweeney et al., 2022).
\item \strong{Marginal preservation:} Copula method preserves exact marginal
distributions while achieving target correlation.
\item \strong{Reliability targeting:} Scale factor for subsequent calibration.
}
}
\details{
\subsection{Why Copula Method is Recommended}{

When difficulties come from the IRW pool (which has realistic, often non-normal
marginal distributions), the conditional normal method can distort the achieved
correlation because it assumes linearity. The Gaussian copula method:

\enumerate{
\item Transforms difficulties to uniform scale via empirical CDF
\item Generates correlated uniforms through Gaussian copula
\item Transforms back to desired marginals (log-normal for discrimination)
}

This guarantees:
\itemize{
\item Exact preservation of difficulty marginal (whatever IRW provides)
\item Exact log-normal marginal for discriminations
\item Spearman correlation \eqn{\approx \rho} (rank-based, robust to non-normality
}
}

\subsection{Connection to Reliability-Targeted Framework}{

The \code{scale} parameter implements "separation of structure and scale":
\itemize{
\item \strong{Structure}: Realistic item characteristics from IRW + correlation
\item \strong{Scale}: Global factor \eqn{c} calibrated for target reliability
}
}
}
\examples{
# Example 1: Rasch with parametric difficulties
items1 <- sim_item_params(n_items = 25, model = "rasch",
                          source = "parametric", seed = 42)

# Example 2: 2PL with copula method (recommended)
items2 <- sim_item_params(
  n_items = 30, model = "2pl", source = "parametric",
  method = "copula",
  discrimination_params = list(rho = -0.3),
  seed = 42
)

# Example 3: Hierarchical 2PL
items3 <- sim_item_params(
  n_items = 25, model = "2pl", source = "hierarchical",
  hierarchical_params = list(mu = c(0, 0), tau = c(0.25, 1), rho = -0.3),
  seed = 42
)

\dontrun{
# Example 4: Using IRW difficulty pool (requires irw package)
items4 <- sim_item_params(n_items = 25, model = "rasch", source = "irw")

# Example 5: Multiple forms with IRW
items5 <- sim_item_params(
  n_items = 20, model = "2pl", n_forms = 5,
  source = "irw", method = "copula"
)
}

}
\references{
Glas, C. A. W., & van der Linden, W. J. (2003). Computerized adaptive testing
with item cloning. \emph{Applied Psychological Measurement, 27}(4), 247-261.

Sweeney, S. M., et al. (2022). An investigation of the nature and consequence
of the relationship between IRT difficulty and discrimination.
\emph{EM:IP, 41}(4), 50-67.

Zhang, L., et al. (2025). Realistic simulation of item difficulties. \emph{PsyArXiv}.
}
