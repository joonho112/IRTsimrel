% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim_latentG.R
\name{sim_latentG}
\alias{sim_latentG}
\title{Simulate Latent Ability Distribution for IRT Studies (G-family)}
\usage{
sim_latentG(
  n,
  shape = c("normal", "bimodal", "trimodal", "multimodal", "skew_pos", "skew_neg",
    "heavy_tail", "light_tail", "uniform", "floor", "ceiling", "custom"),
  sigma = 1,
  mu = 0,
  xcov = NULL,
  beta = NULL,
  shape_params = list(),
  mixture_spec = NULL,
  standardize_custom = TRUE,
  seed = NULL,
  return_z = TRUE
)
}
\arguments{
\item{n}{Integer. Number of persons (latent abilities) to generate.}

\item{shape}{Character. The distributional shape of the standardized
component. One of:
\describe{
\item{\code{"normal"}}{Standard normal \eqn{N(0,1)}}
\item{\code{"bimodal"}}{Symmetric two-component Gaussian mixture with
analytically standardized parameters}
\item{\code{"trimodal"}}{Symmetric three-component Gaussian mixture}
\item{\code{"multimodal"}}{Four-component Gaussian mixture}
\item{\code{"skew_pos"}}{Right-skewed distribution via standardized Gamma}
\item{\code{"skew_neg"}}{Left-skewed distribution (negated Gamma)}
\item{\code{"heavy_tail"}}{Heavy-tailed distribution via standardized Student-t}
\item{\code{"light_tail"}}{Light-tailed (platykurtic) mixture distribution}
\item{\code{"uniform"}}{Uniform distribution on \eqn{[-\sqrt{3}, \sqrt{3}]}}
\item{\code{"floor"}}{Distribution with floor effect (left-truncated feel)}
\item{\code{"ceiling"}}{Distribution with ceiling effect (right-truncated feel)}
\item{\code{"custom"}}{User-specified mixture distribution}
}}

\item{sigma}{Numeric. Scale (standard deviation) of the residual latent trait.
Since the standardized component has variance 1, \code{sigma} directly equals
the marginal SD of the residual term. Default is 1.}

\item{mu}{Numeric. Grand mean of the latent ability distribution. In Rasch
models this is often fixed to 0 for identification. Default is 0.}

\item{xcov}{Matrix or data.frame. Optional covariate matrix with \code{n} rows.
If supplied, person-specific covariate effects are added as \eqn{\eta = X\beta}.}

\item{beta}{Numeric vector. Regression coefficients for \code{xcov}. Must have
length equal to \code{ncol(xcov)}. Ignored if \code{xcov} is NULL.}

\item{shape_params}{List. Additional parameters controlling the shape.
See Details for shape-specific parameters.}

\item{mixture_spec}{List. For \code{shape = "custom"}, specifies the mixture:
\describe{
\item{\code{weights}}{Numeric vector of mixing proportions (must sum to 1)}
\item{\code{means}}{Numeric vector of component means}
\item{\code{sds}}{Numeric vector of component standard deviations}
}
The custom mixture is automatically standardized to have mean 0 and variance 1.}

\item{standardize_custom}{Logical. If TRUE (default), custom mixtures are
post-standardized to ensure mean 0 and variance 1. If FALSE, the raw
mixture is used (user must ensure proper standardization).}

\item{seed}{Integer. Random seed for reproducibility. If NULL (default),
the current RNG state is used.}

\item{return_z}{Logical. If TRUE, include the standardized draws \code{z} in
the output. Default is TRUE.}
}
\value{
An object of class \code{"latent_G"} (a list) containing:
\describe{
\item{\code{theta}}{Numeric vector of length \code{n}, the simulated latent abilities}
\item{\code{z}}{Standardized draws (if \code{return_z = TRUE})}
\item{\code{eta_cov}}{Covariate linear predictor (0 if no covariates)}
\item{\code{mu}}{Grand mean used}
\item{\code{sigma}}{Scale parameter used}
\item{\code{shape}}{Shape label}
\item{\code{shape_params}}{Shape parameters used}
\item{\code{n}}{Sample size}
\item{\code{sample_moments}}{List with sample mean, sd, skewness, kurtosis}
}
}
\description{
\code{sim_latentG()} generates latent abilities (person parameters \eqn{\theta}) for
Item Response Theory (IRT) simulation studies. It implements the population
model \eqn{\theta_p \sim G} where \eqn{G} is a flexible distribution family.

The function is designed with two key principles:
\enumerate{
\item \strong{Pre-standardization:} Each distribution shape is mathematically
constructed to have mean 0 and variance 1, ensuring that changing the
shape does not inadvertently change the scale.
\item \strong{Separation of Structure and Scale:} The \code{sigma} parameter
directly controls the standard deviation of the latent trait, independent
of the distributional shape.
}

The generated abilities follow:
\deqn{\theta_p = \mu + X_p^\top \beta + \sigma \cdot z_p}
where \eqn{z_p \sim G_0} with \eqn{E[z]=0} and \eqn{Var[z]=1}.
}
\details{
\subsection{Pre-standardization Mathematics}{

Each built-in shape is constructed to have exactly mean 0 and variance 1:

\strong{Bimodal:} Two-component mixture with modes at \eqn{\pm\delta}:
\deqn{z = s \cdot \delta + \epsilon, \quad s \sim \text{Rademacher}, \quad \epsilon \sim N(0, 1-\delta^2)}
where the component variance \eqn{1-\delta^2} ensures \eqn{Var[z] = \delta^2 + (1-\delta^2) = 1}.

\strong{Trimodal:} Three-component mixture with weights \eqn{(w_L, w_0, w_R)}
and means \eqn{(-m, 0, m)}. Component variance is \eqn{\sigma_c^2 = 1 - (1-w_0)m^2}
to ensure unit total variance.

\strong{Skewed:} Standardized Gamma distribution:
\deqn{z = \frac{\Gamma(k, 1) - k}{\sqrt{k}}}
which has \eqn{E[z]=0} and \eqn{Var[z]=1} for any \eqn{k > 0}.

\strong{Heavy-tailed:} Standardized Student-t:
\deqn{z = \frac{t_\nu}{\sqrt{\nu/(\nu-2)}}}
which has \eqn{Var[z]=1} for \eqn{\nu > 2}.
}

\subsection{Shape-Specific Parameters}{

\describe{
\item{\code{delta}}{For "bimodal": mode separation, must satisfy
\eqn{0 < \delta < 1}. Default: 0.8}
\item{\code{w0}}{For "trimodal": weight of central component,
must satisfy \eqn{0 < w_0 < 1}. Default: 1/3}
\item{\code{m}}{For "trimodal": magnitude of side component means.
Must satisfy \eqn{(1-w_0)m^2 < 1}. Default: 1.2}
\item{\code{k}}{For "skew_pos"/"skew_neg": Gamma shape parameter,
controls skewness magnitude. Default: 4}
\item{\code{df}}{For "heavy_tail": degrees of freedom, must be > 2.
Default: 5}
}
}

\subsection{Connection to IRT Framework}{

In the Rasch/2PL model, the latent distribution \eqn{G} affects:
\itemize{
\item Marginal reliability: \eqn{\bar{w} = \sigma_\theta^2 / (\sigma_\theta^2 + \text{MSEM})}
\item Expected test information: \eqn{\bar{\mathcal{J}} = E_G[\mathcal{J}(\theta)]}
\item Identifiability (see Appendix F of the manuscript)
}

This function serves as the generator for \eqn{G} in reliability-targeted
simulation studies, allowing researchers to examine how distributional
shape affects model performance while holding scale constant.
}
}
\examples{
# Basic usage: standard normal abilities
sim1 <- sim_latentG(n = 1000, shape = "normal")
mean(sim1$theta)  # approximately 0
sd(sim1$theta)    # approximately 1

# Bimodal distribution for heterogeneous population
sim2 <- sim_latentG(n = 1000, shape = "bimodal",
                    shape_params = list(delta = 0.9))

# Skewed distribution with larger scale
sim3 <- sim_latentG(n = 1000, shape = "skew_pos", sigma = 1.5)

# With covariate effects (e.g., group differences)
group <- rbinom(1000, 1, 0.5)
sim4 <- sim_latentG(n = 1000, shape = "normal",
                    xcov = data.frame(group = group),
                    beta = 0.5)

# Custom mixture distribution
sim5 <- sim_latentG(n = 1000, shape = "custom",
                    mixture_spec = list(
                      weights = c(0.3, 0.5, 0.2),
                      means = c(-1.5, 0, 2),
                      sds = c(0.5, 0.7, 0.5)
                    ))

}
\references{
Baker, F. B., & Kim, S.-H. (2004). \emph{Item Response Theory: Parameter
Estimation Techniques} (2nd ed.). Marcel Dekker.

Paganin, S., et al. (2022). Computational strategies and estimation
performance with Bayesian semiparametric item response theory models.
\emph{Journal of Educational and Behavioral Statistics, 48}(2), 147-188.
}
\seealso{
\code{\link{summary.latent_G}} for summary statistics,
\code{\link{plot.latent_G}} for visualization,
\code{\link{compare_shapes}} for comparing multiple shapes.
}
